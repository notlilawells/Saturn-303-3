<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>project_code_saturn</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Project_Code_Saturn_files/libs/clipboard/clipboard.min.js"></script>
<script src="Project_Code_Saturn_files/libs/quarto-html/quarto.js"></script>
<script src="Project_Code_Saturn_files/libs/quarto-html/popper.min.js"></script>
<script src="Project_Code_Saturn_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Project_Code_Saturn_files/libs/quarto-html/anchor.min.js"></script>
<link href="Project_Code_Saturn_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Project_Code_Saturn_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Project_Code_Saturn_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Project_Code_Saturn_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Project_Code_Saturn_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression, Lasso, LassoCV, LogisticRegression, Ridge, RidgeCV</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor, export_graphviz </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> KFold, cross_val_score,train_test_split, GridSearchCV, ParameterGrid, StratifiedKFold, RandomizedSearchCV</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> VotingRegressor, GradientBoostingRegressor, BaggingRegressor, RandomForestRegressor, AdaBoostRegressor</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bayes_opt <span class="im">import</span> BayesianOptimization</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools <span class="im">as</span> it</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBRegressor</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lightgbm <span class="im">import</span> LGBMRegressor</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> catboost <span class="im">import</span> CatBoostRegressor</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyearth <span class="im">import</span> Earth</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> six <span class="im">import</span> StringIO</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image  </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pydotplus</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time <span class="im">as</span> time</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="table">
<colgroup>
<col style="width: 5%">
</colgroup>
<tbody>
<tr class="odd">
<td>itle: “Project Code” ubtitle: Saturn uthor: Kaitlyn Hung, Anastasia Wei, Amy Wang, and Lila Wells ate: 05/23/2023 umber-sections: true bstract: <em>This file contains the code for the project on predicting wine quality, as part of the STAT303-3 course in Spring 2023</em>. ormat: html: toc: true toc-title: Contents self-contained: true font-size: 100% toc-depth: 4 mainfont: serif xecute: warning: false upyter: python3</td>
</tr>
</tbody>
</table>
<section id="data-quality-check-cleaning-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-quality-check-cleaning-preparation">Data quality check / cleaning / preparation</h2>
<p>Put code with comments. The comments should explain the code such that it can be easily understood. You may put text <em>(in a markdown cell)</em> before a large chunk of code to explain the overall purpose of the code, if it is not intuitive. <strong>Put the name of the person / persons who contributed to each code chunk / set of code chunks.</strong> An example is given below.</p>
<section id="data-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning">Data cleaning</h3>
<p><em>By Anastasia Wei</em></p>
<div class="cell" data-outputid="105d1e4a-c565-4bfd-cf35-c3ffbc738eac" data-execution_count="17">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in the red and white wine files</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>red <span class="op">=</span> pd.read_csv(<span class="st">'Data/winequality-red.csv'</span>, delimiter <span class="op">=</span> <span class="st">";"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>white <span class="op">=</span> pd.read_csv(<span class="st">'Data/winequality-white.csv'</span>, delimiter <span class="op">=</span> <span class="st">";"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>red[<span class="st">'type'</span>] <span class="op">=</span> <span class="st">'red'</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>white[<span class="st">'type'</span>] <span class="op">=</span> <span class="st">'white'</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the red and white wine data</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>all_df <span class="op">=</span> pd.concat([red, white], ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>all_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>quality</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.4</td>
      <td>0.70</td>
      <td>0.00</td>
      <td>1.9</td>
      <td>0.076</td>
      <td>11.0</td>
      <td>34.0</td>
      <td>0.9978</td>
      <td>3.51</td>
      <td>0.56</td>
      <td>9.4</td>
      <td>5</td>
      <td>red</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.8</td>
      <td>0.88</td>
      <td>0.00</td>
      <td>2.6</td>
      <td>0.098</td>
      <td>25.0</td>
      <td>67.0</td>
      <td>0.9968</td>
      <td>3.20</td>
      <td>0.68</td>
      <td>9.8</td>
      <td>5</td>
      <td>red</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.8</td>
      <td>0.76</td>
      <td>0.04</td>
      <td>2.3</td>
      <td>0.092</td>
      <td>15.0</td>
      <td>54.0</td>
      <td>0.9970</td>
      <td>3.26</td>
      <td>0.65</td>
      <td>9.8</td>
      <td>5</td>
      <td>red</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11.2</td>
      <td>0.28</td>
      <td>0.56</td>
      <td>1.9</td>
      <td>0.075</td>
      <td>17.0</td>
      <td>60.0</td>
      <td>0.9980</td>
      <td>3.16</td>
      <td>0.58</td>
      <td>9.8</td>
      <td>6</td>
      <td>red</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.4</td>
      <td>0.70</td>
      <td>0.00</td>
      <td>1.9</td>
      <td>0.076</td>
      <td>11.0</td>
      <td>34.0</td>
      <td>0.9978</td>
      <td>3.51</td>
      <td>0.56</td>
      <td>9.4</td>
      <td>5</td>
      <td>red</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="distribution-of-response" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-response">Distribution of response</h3>
<p><em>By Anastasia Wei</em></p>
<div class="cell" data-outputid="a9b20c53-cc1e-4e0f-aa3e-31228dae47be" data-execution_count="18">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean and standard deviation of response</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Response mean ='</span>, np.average(all_df.quality))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Response standard deviation ='</span>, np.std(all_df.quality))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response mean = 5.818377712790519
Response standard deviation = 0.8731880644450432</code></pre>
</div>
</div>
<div class="cell" data-outputid="02e10f57-0adf-4033-e60a-96a4b238b55d">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># response distribution</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plt.hist(red.quality.values, bins <span class="op">=</span> np.arange(<span class="dv">1</span>,<span class="dv">10</span>), color <span class="op">=</span> <span class="st">'r'</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, zorder <span class="op">=</span> <span class="dv">5</span>,  label <span class="op">=</span> <span class="st">'red'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Wine Quality Distribution'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>plt.hist(white.quality.values, bins <span class="op">=</span> np.arange(<span class="dv">1</span>,<span class="dv">10</span>), color <span class="op">=</span> <span class="st">'grey'</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, label <span class="op">=</span> <span class="st">'white'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Wine Quality'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Count'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
/* Put everything inside the global mpl namespace */
/* global mpl */
window.mpl = {};

mpl.get_websocket_type = function () {
    if (typeof WebSocket !== 'undefined') {
        return WebSocket;
    } else if (typeof MozWebSocket !== 'undefined') {
        return MozWebSocket;
    } else {
        alert(
            'Your browser does not have WebSocket support. ' +
                'Please try Chrome, Safari or Firefox ≥ 6. ' +
                'Firefox 4 and 5 are also supported but you ' +
                'have to enable WebSockets in about:config.'
        );
    }
};

mpl.figure = function (figure_id, websocket, ondownload, parent_element) {
    this.id = figure_id;

    this.ws = websocket;

    this.supports_binary = this.ws.binaryType !== undefined;

    if (!this.supports_binary) {
        var warnings = document.getElementById('mpl-warnings');
        if (warnings) {
            warnings.style.display = 'block';
            warnings.textContent =
                'This browser does not support binary websocket messages. ' +
                'Performance may be slow.';
        }
    }

    this.imageObj = new Image();

    this.context = undefined;
    this.message = undefined;
    this.canvas = undefined;
    this.rubberband_canvas = undefined;
    this.rubberband_context = undefined;
    this.format_dropdown = undefined;

    this.image_mode = 'full';

    this.root = document.createElement('div');
    this.root.setAttribute('style', 'display: inline-block');
    this._root_extra_style(this.root);

    parent_element.appendChild(this.root);

    this._init_header(this);
    this._init_canvas(this);
    this._init_toolbar(this);

    var fig = this;

    this.waiting = false;

    this.ws.onopen = function () {
        fig.send_message('supports_binary', { value: fig.supports_binary });
        fig.send_message('send_image_mode', {});
        if (fig.ratio !== 1) {
            fig.send_message('set_dpi_ratio', { dpi_ratio: fig.ratio });
        }
        fig.send_message('refresh', {});
    };

    this.imageObj.onload = function () {
        if (fig.image_mode === 'full') {
            // Full images could contain transparency (where diff images
            // almost always do), so we need to clear the canvas so that
            // there is no ghosting.
            fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height);
        }
        fig.context.drawImage(fig.imageObj, 0, 0);
    };

    this.imageObj.onunload = function () {
        fig.ws.close();
    };

    this.ws.onmessage = this._make_on_message_function(this);

    this.ondownload = ondownload;
};

mpl.figure.prototype._init_header = function () {
    var titlebar = document.createElement('div');
    titlebar.classList =
        'ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix';
    var titletext = document.createElement('div');
    titletext.classList = 'ui-dialog-title';
    titletext.setAttribute(
        'style',
        'width: 100%; text-align: center; padding: 3px;'
    );
    titlebar.appendChild(titletext);
    this.root.appendChild(titlebar);
    this.header = titletext;
};

mpl.figure.prototype._canvas_extra_style = function (_canvas_div) {};

mpl.figure.prototype._root_extra_style = function (_canvas_div) {};

mpl.figure.prototype._init_canvas = function () {
    var fig = this;

    var canvas_div = (this.canvas_div = document.createElement('div'));
    canvas_div.setAttribute(
        'style',
        'border: 1px solid #ddd;' +
            'box-sizing: content-box;' +
            'clear: both;' +
            'min-height: 1px;' +
            'min-width: 1px;' +
            'outline: 0;' +
            'overflow: hidden;' +
            'position: relative;' +
            'resize: both;'
    );

    function on_keyboard_event_closure(name) {
        return function (event) {
            return fig.key_event(event, name);
        };
    }

    canvas_div.addEventListener(
        'keydown',
        on_keyboard_event_closure('key_press')
    );
    canvas_div.addEventListener(
        'keyup',
        on_keyboard_event_closure('key_release')
    );

    this._canvas_extra_style(canvas_div);
    this.root.appendChild(canvas_div);

    var canvas = (this.canvas = document.createElement('canvas'));
    canvas.classList.add('mpl-canvas');
    canvas.setAttribute('style', 'box-sizing: content-box;');

    this.context = canvas.getContext('2d');

    var backingStore =
        this.context.backingStorePixelRatio ||
        this.context.webkitBackingStorePixelRatio ||
        this.context.mozBackingStorePixelRatio ||
        this.context.msBackingStorePixelRatio ||
        this.context.oBackingStorePixelRatio ||
        this.context.backingStorePixelRatio ||
        1;

    this.ratio = (window.devicePixelRatio || 1) / backingStore;

    var rubberband_canvas = (this.rubberband_canvas = document.createElement(
        'canvas'
    ));
    rubberband_canvas.setAttribute(
        'style',
        'box-sizing: content-box; position: absolute; left: 0; top: 0; z-index: 1;'
    );

    // Apply a ponyfill if ResizeObserver is not implemented by browser.
    if (this.ResizeObserver === undefined) {
        if (window.ResizeObserver !== undefined) {
            this.ResizeObserver = window.ResizeObserver;
        } else {
            var obs = _JSXTOOLS_RESIZE_OBSERVER({});
            this.ResizeObserver = obs.ResizeObserver;
        }
    }

    this.resizeObserverInstance = new this.ResizeObserver(function (entries) {
        var nentries = entries.length;
        for (var i = 0; i < nentries; i++) {
            var entry = entries[i];
            var width, height;
            if (entry.contentBoxSize) {
                if (entry.contentBoxSize instanceof Array) {
                    // Chrome 84 implements new version of spec.
                    width = entry.contentBoxSize[0].inlineSize;
                    height = entry.contentBoxSize[0].blockSize;
                } else {
                    // Firefox implements old version of spec.
                    width = entry.contentBoxSize.inlineSize;
                    height = entry.contentBoxSize.blockSize;
                }
            } else {
                // Chrome <84 implements even older version of spec.
                width = entry.contentRect.width;
                height = entry.contentRect.height;
            }

            // Keep the size of the canvas and rubber band canvas in sync with
            // the canvas container.
            if (entry.devicePixelContentBoxSize) {
                // Chrome 84 implements new version of spec.
                canvas.setAttribute(
                    'width',
                    entry.devicePixelContentBoxSize[0].inlineSize
                );
                canvas.setAttribute(
                    'height',
                    entry.devicePixelContentBoxSize[0].blockSize
                );
            } else {
                canvas.setAttribute('width', width * fig.ratio);
                canvas.setAttribute('height', height * fig.ratio);
            }
            canvas.setAttribute(
                'style',
                'width: ' + width + 'px; height: ' + height + 'px;'
            );

            rubberband_canvas.setAttribute('width', width);
            rubberband_canvas.setAttribute('height', height);

            // And update the size in Python. We ignore the initial 0/0 size
            // that occurs as the element is placed into the DOM, which should
            // otherwise not happen due to the minimum size styling.
            if (fig.ws.readyState == 1 && width != 0 && height != 0) {
                fig.request_resize(width, height);
            }
        }
    });
    this.resizeObserverInstance.observe(canvas_div);

    function on_mouse_event_closure(name) {
        return function (event) {
            return fig.mouse_event(event, name);
        };
    }

    rubberband_canvas.addEventListener(
        'mousedown',
        on_mouse_event_closure('button_press')
    );
    rubberband_canvas.addEventListener(
        'mouseup',
        on_mouse_event_closure('button_release')
    );
    // Throttle sequential mouse events to 1 every 20ms.
    rubberband_canvas.addEventListener(
        'mousemove',
        on_mouse_event_closure('motion_notify')
    );

    rubberband_canvas.addEventListener(
        'mouseenter',
        on_mouse_event_closure('figure_enter')
    );
    rubberband_canvas.addEventListener(
        'mouseleave',
        on_mouse_event_closure('figure_leave')
    );

    canvas_div.addEventListener('wheel', function (event) {
        if (event.deltaY < 0) {
            event.step = 1;
        } else {
            event.step = -1;
        }
        on_mouse_event_closure('scroll')(event);
    });

    canvas_div.appendChild(canvas);
    canvas_div.appendChild(rubberband_canvas);

    this.rubberband_context = rubberband_canvas.getContext('2d');
    this.rubberband_context.strokeStyle = '#000000';

    this._resize_canvas = function (width, height, forward) {
        if (forward) {
            canvas_div.style.width = width + 'px';
            canvas_div.style.height = height + 'px';
        }
    };

    // Disable right mouse context menu.
    this.rubberband_canvas.addEventListener('contextmenu', function (_e) {
        event.preventDefault();
        return false;
    });

    function set_focus() {
        canvas.focus();
        canvas_div.focus();
    }

    window.setTimeout(set_focus, 100);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'mpl-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'mpl-button-group';
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'mpl-button-group';
            continue;
        }

        var button = (fig.buttons[name] = document.createElement('button'));
        button.classList = 'mpl-widget';
        button.setAttribute('role', 'button');
        button.setAttribute('aria-disabled', 'false');
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));

        var icon_img = document.createElement('img');
        icon_img.src = '_images/' + image + '.png';
        icon_img.srcset = '_images/' + image + '_large.png 2x';
        icon_img.alt = tooltip;
        button.appendChild(icon_img);

        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    var fmt_picker = document.createElement('select');
    fmt_picker.classList = 'mpl-widget';
    toolbar.appendChild(fmt_picker);
    this.format_dropdown = fmt_picker;

    for (var ind in mpl.extensions) {
        var fmt = mpl.extensions[ind];
        var option = document.createElement('option');
        option.selected = fmt === mpl.default_extension;
        option.innerHTML = fmt;
        fmt_picker.appendChild(option);
    }

    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message';
    toolbar.appendChild(status_bar);
    this.message = status_bar;
};

mpl.figure.prototype.request_resize = function (x_pixels, y_pixels) {
    // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client,
    // which will in turn request a refresh of the image.
    this.send_message('resize', { width: x_pixels, height: y_pixels });
};

mpl.figure.prototype.send_message = function (type, properties) {
    properties['type'] = type;
    properties['figure_id'] = this.id;
    this.ws.send(JSON.stringify(properties));
};

mpl.figure.prototype.send_draw_message = function () {
    if (!this.waiting) {
        this.waiting = true;
        this.ws.send(JSON.stringify({ type: 'draw', figure_id: this.id }));
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    var format_dropdown = fig.format_dropdown;
    var format = format_dropdown.options[format_dropdown.selectedIndex].value;
    fig.ondownload(fig, format);
};

mpl.figure.prototype.handle_resize = function (fig, msg) {
    var size = msg['size'];
    if (size[0] !== fig.canvas.width || size[1] !== fig.canvas.height) {
        fig._resize_canvas(size[0], size[1], msg['forward']);
        fig.send_message('refresh', {});
    }
};

mpl.figure.prototype.handle_rubberband = function (fig, msg) {
    var x0 = msg['x0'] / fig.ratio;
    var y0 = (fig.canvas.height - msg['y0']) / fig.ratio;
    var x1 = msg['x1'] / fig.ratio;
    var y1 = (fig.canvas.height - msg['y1']) / fig.ratio;
    x0 = Math.floor(x0) + 0.5;
    y0 = Math.floor(y0) + 0.5;
    x1 = Math.floor(x1) + 0.5;
    y1 = Math.floor(y1) + 0.5;
    var min_x = Math.min(x0, x1);
    var min_y = Math.min(y0, y1);
    var width = Math.abs(x1 - x0);
    var height = Math.abs(y1 - y0);

    fig.rubberband_context.clearRect(
        0,
        0,
        fig.canvas.width / fig.ratio,
        fig.canvas.height / fig.ratio
    );

    fig.rubberband_context.strokeRect(min_x, min_y, width, height);
};

mpl.figure.prototype.handle_figure_label = function (fig, msg) {
    // Updates the figure title.
    fig.header.textContent = msg['label'];
};

mpl.figure.prototype.handle_cursor = function (fig, msg) {
    var cursor = msg['cursor'];
    switch (cursor) {
        case 0:
            cursor = 'pointer';
            break;
        case 1:
            cursor = 'default';
            break;
        case 2:
            cursor = 'crosshair';
            break;
        case 3:
            cursor = 'move';
            break;
    }
    fig.rubberband_canvas.style.cursor = cursor;
};

mpl.figure.prototype.handle_message = function (fig, msg) {
    fig.message.textContent = msg['message'];
};

mpl.figure.prototype.handle_draw = function (fig, _msg) {
    // Request the server to send over a new figure.
    fig.send_draw_message();
};

mpl.figure.prototype.handle_image_mode = function (fig, msg) {
    fig.image_mode = msg['mode'];
};

mpl.figure.prototype.handle_history_buttons = function (fig, msg) {
    for (var key in msg) {
        if (!(key in fig.buttons)) {
            continue;
        }
        fig.buttons[key].disabled = !msg[key];
        fig.buttons[key].setAttribute('aria-disabled', !msg[key]);
    }
};

mpl.figure.prototype.handle_navigate_mode = function (fig, msg) {
    if (msg['mode'] === 'PAN') {
        fig.buttons['Pan'].classList.add('active');
        fig.buttons['Zoom'].classList.remove('active');
    } else if (msg['mode'] === 'ZOOM') {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.add('active');
    } else {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.remove('active');
    }
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Called whenever the canvas gets updated.
    this.send_message('ack', {});
};

// A function to construct a web socket function for onmessage handling.
// Called in the figure constructor.
mpl.figure.prototype._make_on_message_function = function (fig) {
    return function socket_on_message(evt) {
        if (evt.data instanceof Blob) {
            /* FIXME: We get "Resource interpreted as Image but
             * transferred with MIME type text/plain:" errors on
             * Chrome.  But how to set the MIME type?  It doesn't seem
             * to be part of the websocket stream */
            evt.data.type = 'image/png';

            /* Free the memory for the previous frames */
            if (fig.imageObj.src) {
                (window.URL || window.webkitURL).revokeObjectURL(
                    fig.imageObj.src
                );
            }

            fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL(
                evt.data
            );
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        } else if (
            typeof evt.data === 'string' &&
            evt.data.slice(0, 21) === 'data:image/png;base64'
        ) {
            fig.imageObj.src = evt.data;
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }

        var msg = JSON.parse(evt.data);
        var msg_type = msg['type'];

        // Call the  "handle_{type}" callback, which takes
        // the figure and JSON message as its only arguments.
        try {
            var callback = fig['handle_' + msg_type];
        } catch (e) {
            console.log(
                "No handler for the '" + msg_type + "' message type: ",
                msg
            );
            return;
        }

        if (callback) {
            try {
                // console.log("Handling '" + msg_type + "' message: ", msg);
                callback(fig, msg);
            } catch (e) {
                console.log(
                    "Exception inside the 'handler_" + msg_type + "' callback:",
                    e,
                    e.stack,
                    msg
                );
            }
        }
    };
};

// from http://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas
mpl.findpos = function (e) {
    //this section is from http://www.quirksmode.org/js/events_properties.html
    var targ;
    if (!e) {
        e = window.event;
    }
    if (e.target) {
        targ = e.target;
    } else if (e.srcElement) {
        targ = e.srcElement;
    }
    if (targ.nodeType === 3) {
        // defeat Safari bug
        targ = targ.parentNode;
    }

    // pageX,Y are the mouse positions relative to the document
    var boundingRect = targ.getBoundingClientRect();
    var x = e.pageX - (boundingRect.left + document.body.scrollLeft);
    var y = e.pageY - (boundingRect.top + document.body.scrollTop);

    return { x: x, y: y };
};

/*
 * return a copy of an object with only non-object keys
 * we need this to avoid circular references
 * http://stackoverflow.com/a/24161582/3208463
 */
function simpleKeys(original) {
    return Object.keys(original).reduce(function (obj, key) {
        if (typeof original[key] !== 'object') {
            obj[key] = original[key];
        }
        return obj;
    }, {});
}

mpl.figure.prototype.mouse_event = function (event, name) {
    var canvas_pos = mpl.findpos(event);

    if (name === 'button_press') {
        this.canvas.focus();
        this.canvas_div.focus();
    }

    var x = canvas_pos.x * this.ratio;
    var y = canvas_pos.y * this.ratio;

    this.send_message(name, {
        x: x,
        y: y,
        button: event.button,
        step: event.step,
        guiEvent: simpleKeys(event),
    });

    /* This prevents the web browser from automatically changing to
     * the text insertion cursor when the button is pressed.  We want
     * to control all of the cursor setting manually through the
     * 'cursor' event from matplotlib */
    event.preventDefault();
    return false;
};

mpl.figure.prototype._key_event_extra = function (_event, _name) {
    // Handle any extra behaviour associated with a key event
};

mpl.figure.prototype.key_event = function (event, name) {
    // Prevent repeat events
    if (name === 'key_press') {
        if (event.which === this._key) {
            return;
        } else {
            this._key = event.which;
        }
    }
    if (name === 'key_release') {
        this._key = null;
    }

    var value = '';
    if (event.ctrlKey && event.which !== 17) {
        value += 'ctrl+';
    }
    if (event.altKey && event.which !== 18) {
        value += 'alt+';
    }
    if (event.shiftKey && event.which !== 16) {
        value += 'shift+';
    }

    value += 'k';
    value += event.which.toString();

    this._key_event_extra(event, name);

    this.send_message(name, { key: value, guiEvent: simpleKeys(event) });
    return false;
};

mpl.figure.prototype.toolbar_button_onclick = function (name) {
    if (name === 'download') {
        this.handle_save(this, null);
    } else {
        this.send_message('toolbar_button', { name: name });
    }
};

mpl.figure.prototype.toolbar_button_onmouseover = function (tooltip) {
    this.message.textContent = tooltip;
};

///////////////// REMAINING CONTENT GENERATED BY embed_js.py /////////////////
// prettier-ignore
var _JSXTOOLS_RESIZE_OBSERVER=function(A){var t,i=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakMap,o=new Set;function s(e){if(!(this instanceof s))throw new TypeError("Constructor requires 'new' operator");i.set(this,e)}function h(){throw new TypeError("Function is not a constructor")}function c(e,t,i,n){e=0 in arguments?Number(arguments[0]):0,t=1 in arguments?Number(arguments[1]):0,i=2 in arguments?Number(arguments[2]):0,n=3 in arguments?Number(arguments[3]):0,this.right=(this.x=this.left=e)+(this.width=i),this.bottom=(this.y=this.top=t)+(this.height=n),Object.freeze(this)}function d(){t=requestAnimationFrame(d);var s=new WeakMap,p=new Set;o.forEach((function(t){r.get(t).forEach((function(i){var r=t instanceof window.SVGElement,o=a.get(t),d=r?0:parseFloat(o.paddingTop),f=r?0:parseFloat(o.paddingRight),l=r?0:parseFloat(o.paddingBottom),u=r?0:parseFloat(o.paddingLeft),g=r?0:parseFloat(o.borderTopWidth),m=r?0:parseFloat(o.borderRightWidth),w=r?0:parseFloat(o.borderBottomWidth),b=u+f,F=d+l,v=(r?0:parseFloat(o.borderLeftWidth))+m,W=g+w,y=r?0:t.offsetHeight-W-t.clientHeight,E=r?0:t.offsetWidth-v-t.clientWidth,R=b+v,z=F+W,M=r?t.width:parseFloat(o.width)-R-E,O=r?t.height:parseFloat(o.height)-z-y;if(n.has(t)){var k=n.get(t);if(k[0]===M&&k[1]===O)return}n.set(t,[M,O]);var S=Object.create(h.prototype);S.target=t,S.contentRect=new c(u,d,M,O),s.has(i)||(s.set(i,[]),p.add(i)),s.get(i).push(S)}))})),p.forEach((function(e){i.get(e).call(e,s.get(e),e)}))}return s.prototype.observe=function(i){if(i instanceof window.Element){r.has(i)||(r.set(i,new Set),o.add(i),a.set(i,window.getComputedStyle(i)));var n=r.get(i);n.has(this)||n.add(this),cancelAnimationFrame(t),t=requestAnimationFrame(d)}},s.prototype.unobserve=function(i){if(i instanceof window.Element&&r.has(i)){var n=r.get(i);n.has(this)&&(n.delete(this),n.size||(r.delete(i),o.delete(i))),n.size||r.delete(i),o.size||cancelAnimationFrame(t)}},A.DOMRectReadOnly=c,A.ResizeObserver=s,A.ResizeObserverEntry=h,A}; // eslint-disable-line
mpl.toolbar_items = [["Home", "Reset original view", "fa fa-home icon-home", "home"], ["Back", "Back to previous view", "fa fa-arrow-left icon-arrow-left", "back"], ["Forward", "Forward to next view", "fa fa-arrow-right icon-arrow-right", "forward"], ["", "", "", ""], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "fa fa-arrows icon-move", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis, CTRL fixes aspect", "fa fa-square-o icon-check-empty", "zoom"], ["", "", "", ""], ["Download", "Download plot", "fa fa-floppy-o icon-save", "download"]];

mpl.extensions = ["eps", "jpeg", "pdf", "png", "ps", "raw", "svg", "tif"];

mpl.default_extension = "png";/* global mpl */

var comm_websocket_adapter = function (comm) {
    // Create a "websocket"-like object which calls the given IPython comm
    // object with the appropriate methods. Currently this is a non binary
    // socket, so there is still some room for performance tuning.
    var ws = {};

    ws.close = function () {
        comm.close();
    };
    ws.send = function (m) {
        //console.log('sending', m);
        comm.send(m);
    };
    // Register the callback with on_msg.
    comm.on_msg(function (msg) {
        //console.log('receiving', msg['content']['data'], msg);
        // Pass the mpl event to the overridden (by mpl) onmessage function.
        ws.onmessage(msg['content']['data']);
    });
    return ws;
};

mpl.mpl_figure_comm = function (comm, msg) {
    // This is the function which gets called when the mpl process
    // starts-up an IPython Comm through the "matplotlib" channel.

    var id = msg.content.data.id;
    // Get hold of the div created by the display call when the Comm
    // socket was opened in Python.
    var element = document.getElementById(id);
    var ws_proxy = comm_websocket_adapter(comm);

    function ondownload(figure, _format) {
        window.open(figure.canvas.toDataURL());
    }

    var fig = new mpl.figure(id, ws_proxy, ondownload, element);

    // Call onopen now - mpl needs it, as it is assuming we've passed it a real
    // web socket which is closed, not our websocket->open comm proxy.
    ws_proxy.onopen();

    fig.parent_element = element;
    fig.cell_info = mpl.find_output_cell("<div id='" + id + "'></div>");
    if (!fig.cell_info) {
        console.error('Failed to find cell for figure', id, fig);
        return;
    }
    fig.cell_info[0].output_area.element.on(
        'cleared',
        { fig: fig },
        fig._remove_fig_handler
    );
};

mpl.figure.prototype.handle_close = function (fig, msg) {
    var width = fig.canvas.width / fig.ratio;
    fig.cell_info[0].output_area.element.off(
        'cleared',
        fig._remove_fig_handler
    );
    fig.resizeObserverInstance.unobserve(fig.canvas_div);

    // Update the output cell to use the data from the current canvas.
    fig.push_to_output();
    var dataURL = fig.canvas.toDataURL();
    // Re-enable the keyboard manager in IPython - without this line, in FF,
    // the notebook keyboard shortcuts fail.
    IPython.keyboard_manager.enable();
    fig.parent_element.innerHTML =
        '<img src="' + dataURL + '" width="' + width + '">';
    fig.close_ws(fig, msg);
};

mpl.figure.prototype.close_ws = function (fig, msg) {
    fig.send_message('closing', msg);
    // fig.ws.close()
};

mpl.figure.prototype.push_to_output = function (_remove_interactive) {
    // Turn the data on the canvas into data in the output cell.
    var width = this.canvas.width / this.ratio;
    var dataURL = this.canvas.toDataURL();
    this.cell_info[1]['text/html'] =
        '<img src="' + dataURL + '" width="' + width + '">';
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Tell IPython that the notebook contents must change.
    IPython.notebook.set_dirty(true);
    this.send_message('ack', {});
    var fig = this;
    // Wait a second, then push the new image to the DOM so
    // that it is saved nicely (might be nice to debounce this).
    setTimeout(function () {
        fig.push_to_output();
    }, 1000);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'btn-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'btn-group';
    var button;
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'btn-group';
            continue;
        }

        button = fig.buttons[name] = document.createElement('button');
        button.classList = 'btn btn-default';
        button.href = '#';
        button.title = name;
        button.innerHTML = '<i class="fa ' + image + ' fa-lg"></i>';
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));
        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    // Add the status bar.
    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message pull-right';
    toolbar.appendChild(status_bar);
    this.message = status_bar;

    // Add the close button to the window.
    var buttongrp = document.createElement('div');
    buttongrp.classList = 'btn-group inline pull-right';
    button = document.createElement('button');
    button.classList = 'btn btn-mini btn-primary';
    button.href = '#';
    button.title = 'Stop Interaction';
    button.innerHTML = '<i class="fa fa-power-off icon-remove icon-large"></i>';
    button.addEventListener('click', function (_evt) {
        fig.handle_close(fig, {});
    });
    button.addEventListener(
        'mouseover',
        on_mouseover_closure('Stop Interaction')
    );
    buttongrp.appendChild(button);
    var titlebar = this.root.querySelector('.ui-dialog-titlebar');
    titlebar.insertBefore(buttongrp, titlebar.firstChild);
};

mpl.figure.prototype._remove_fig_handler = function (event) {
    var fig = event.data.fig;
    if (event.target !== this) {
        // Ignore bubbled events from children.
        return;
    }
    fig.close_ws(fig, {});
};

mpl.figure.prototype._root_extra_style = function (el) {
    el.style.boxSizing = 'content-box'; // override notebook setting of border-box.
};

mpl.figure.prototype._canvas_extra_style = function (el) {
    // this is important to make the div 'focusable
    el.setAttribute('tabindex', 0);
    // reach out to IPython and tell the keyboard manager to turn it's self
    // off when our div gets focus

    // location in version 3
    if (IPython.notebook.keyboard_manager) {
        IPython.notebook.keyboard_manager.register_events(el);
    } else {
        // location in version 2
        IPython.keyboard_manager.register_events(el);
    }
};

mpl.figure.prototype._key_event_extra = function (event, _name) {
    var manager = IPython.notebook.keyboard_manager;
    if (!manager) {
        manager = IPython.keyboard_manager;
    }

    // Check for shift+enter
    if (event.shiftKey && event.which === 13) {
        this.canvas_div.blur();
        // select the cell after this one
        var index = IPython.notebook.find_cell_index(this.cell_info[0]);
        IPython.notebook.select(index + 1);
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    fig.ondownload(fig, null);
};

mpl.find_output_cell = function (html_output) {
    // Return the cell and output element which can be found *uniquely* in the notebook.
    // Note - this is a bit hacky, but it is done because the "notebook_saving.Notebook"
    // IPython event is triggered only after the cells have been serialised, which for
    // our purposes (turning an active figure into a static one), is too late.
    var cells = IPython.notebook.get_cells();
    var ncells = cells.length;
    for (var i = 0; i < ncells; i++) {
        var cell = cells[i];
        if (cell.cell_type === 'code') {
            for (var j = 0; j < cell.output_area.outputs.length; j++) {
                var data = cell.output_area.outputs[j];
                if (data.data) {
                    // IPython >= 3 moved mimebundle to data attribute of output
                    data = data.data;
                }
                if (data['text/html'] === html_output) {
                    return [cell, data, j];
                }
            }
        }
    }
};

// Register the function which deals with the matplotlib target/channel.
// The kernel may be null if the page has been refreshed.
if (IPython.notebook.kernel !== null) {
    IPython.notebook.kernel.comm_manager.register_target(
        'matplotlib',
        mpl.mpl_figure_comm
    );
}

</script>
</div>
<div class="cell-output cell-output-display">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABQAAAAPACAYAAABq3NR5AAAAAXNSR0IArs4c6QAAIABJREFUeF7s3QfUFcXh/vFBLAiJYgHFHo1osMVoImKMBVs0lthFbLFEosRYfrHEXrGLNSYqsTeUKEZjjWLBXsAGUaOxJaioIASw8D/P5L83+15u2bsz75a53znHE+XdnZn9zL6bsw8zO11mz54921AQQAABBBBAAAEEEEAAAQQQQAABBBBAIEiBLgSAQY4rF4UAAggggAACCCCAAAIIIIAAAggggIAVIADkRkAAAQQQQAABBBBAAAEEEEAAAQQQQCBgAQLAgAeXS0MAAQQQQAABBBBAAAEEEEAAAQQQQIAAkHsAAQQQQAABBBBAAAEEEEAAAQQQQACBgAUIAAMeXC4NAQQQQAABBBBAAAEEEEAAAQQQQAABAkDuAQQQQAABBBBAAAEEEEAAAQQQQAABBAIWIAAMeHC5NAQQQAABBBBAAAEEEEAAAQQQQAABBAgAuQcQQAABBBBAAAEEEEAAAQQQQAABBBAIWIAAMODB5dIQQAABBBBAAAEEEEAAAQQQQAABBBAgAOQeQAABBBBAAAEEEEAAAQQQQAABBBBAIGABAsCAB5dLQwABBBBAAAEEEEAAAQQQQAABBBBAgACQewABBBBAAAEEEEAAAQQQQAABBBBAAIGABQgAAx5cLg0BBBBAAAEEEEAAAQQQQAABBBBAAAECQO4BBBBAAAEEEEAAAQQQQAABBBBAAAEEAhYgAAx4cLk0BBBAAAEEEEAAAQQQQAABBBBAAAEECAC5BxBAAAEEEEAAAQQQQAABBBBAAAEEEAhYgAAw4MHl0hBAAAEEEEAAAQQQQAABBBBAAAEEECAA5B5AAAEEEEAAAQQQQAABBBBAAAEEEEAgYAECwIAHl0tDAAEEEEAAAQQQQAABBBBAAAEEEECAAJB7AAEEEEAAAQQQQAABBBBAAAEEEEAAgYAFCAADHlwuDQEEEEAAAQQQQAABBBBAAAEEEEAAAQJA7gEEEEAAAQQQQAABBBBAAAEEEEAAAQQCFiAADHhwuTQEEEAAAQQQQAABBBBAAAEEEEAAAQQIALkHEEAAAQQQQAABBBBAAAEEEEAAAQQQCFiAADDgweXSEEAAAQQQQAABBBBAAAEEEEAAAQQQIADkHkAAAQQQQAABBBBAAAEEEEAAAQQQQCBgAQLAgAeXS0MAAQQQQAABBBBAAAEEEEAAAQQQQIAAkHsAAQQQQAABBBBAAAEEEEAAAQQQQACBgAUIAAMeXC4NAQQQQAABBBBAAAEEEEAAAQQQQAABAkDuAQQQQAABBBBAAAEEEEAAAQQQQAABBAIWIAAMeHC5NAQQQAABBBBAAAEEEEAAAQQQQAABBAgAuQcQQAABBBBAAAEEEEAAAQQQQAABBBAIWIAAMODB5dIQQAABBBBAAAEEEEAAAQQQQAABBBAgAOQeQAABBBBAAAEEEEAAAQQQQAABBBBAIGABAsCAB5dLQwABBBBAAAEEEEAAAQQQQAABBBBAgACQewABBBBAAAEEEEAAAQQQQAABBBBAAIGABQgAAx5cLg0BBBBAAAEEEEAAAQQQQAABBBBAAAECQO4BBBBAAAEEEEAAAQQQQAABBBBAAAEEAhYgAAx4cLk0BBBAAAEEEEAAAQQQQAABBBBAAAEECAC5BxBAAAEEEEAAAQQQQAABBBBAAAEEEAhYgAAw4MHl0hBAAAEEEEAAAQQQQAABBBBAAAEEECAA5B5AAAEEEEAAAQQQQAABBBBAAAEEEEAgYAECwIAHl0tDAAEEEEAAAQQQQAABBBBAAAEEEECAAJB7AAEEEEAAAQQQQAABBBBAAAEEEEAAgYAFCAADHlwuDQEEEEAAAQQQQAABBBBAAAEEEEAAAQJA7gEEEEAAAQQQQAABBBBAAAEEEEAAAQQCFiAADHhwuTQEEEAAAQQQQAABBBBAAAEEEEAAAQQIALkHEEAAAQQQQAABBBBAAAEEEEAAAQQQCFiAADDgweXSEEAAAQQQQAABBBBAAAEEEEAAAQQQIADkHkAAAQQQQAABBBBAAAEEEEAAAQQQQCBgAQLAgAeXS0MAAQQQQAABBBBAAAEEEEAAAQQQQIAAkHsAAQQQQAABBBBAAAEEEEAAAQQQQACBgAUIAAMeXC4NAQQQQAABBBBAAAEEEEAAAQQQQAABAkDuAQQQQAABBBBAAAEEEEAAAQQQQAABBAIWIAAMeHC5NAQQQAABBBBAAAEEEEAAAQQQQAABBAgAuQcQQAABBBBAAAEEEEAAAQQQQAABBBAIWIAAMODB5dIQQAABBBBAAAEEEEAAAQQQQAABBBAgAOQeQAABBBBAAAEEEEAAAQQQQAABBBBAIGABAsCAB5dLQwABBBBAAAEEEEAAAQQQQAABBBBAgACQewABBBBAAAEEEEAAAQQQQAABBBBAAIGABQgAAx5cLg0BBBBAAAEEEEAAAQQQQAABBBBAAAECQO4BBBBAAAEEEEAAAQQQQAABBBBAAAEEAhYgAAx4cLk0BBBAAAEEEEAAAQQQQAABBBBAAAEECAC5BxBAAAEEEEAAAQQQQAABBBBAAAEEEAhYgAAw4MHl0hBAAAEEEEAAAQQQQAABBBBAAAEEECAA5B5AAAEEEEAAAQQQQAABBBBAAAEEEEAgYAECwIAHl0tDAAEEEEAAAQQQQAABBBBAAAEEEECAAJB7AAEEEEAAAQQQQAABBBBAAAEEEEAAgYAFCAADHlwuDQEEEEAAAQQQQAABBBBAAAEEEEAAAQJA7gEEEEAAAQQQQKCNBGbNmmXmnXfeNrri4l0qY5B8TGbPnm2+/vprM/fccyc/iSMRQAABBBBAYA4BAkBuCgQQQACB4AVuuukmc8IJJ1Su88wzzzTbbbddouvWy+eAAQPM5MmTK8evuuqq5rbbbkt0vg467bTTzDXXXFM5/sEHHzRLLbWU/e+jjjrKjBo1yv77j370I3PttdcmrjfUA2X+wgsvmIceesi8/PLL5q233jJTp041X375pfnWt75l+vTpY1ZeeWWz/vrrmw033NB07949VAqzxx57mKefftpe389//nMzbNiwOa51pZVWqvzZGWecYbbffvuaHtOmTTMXXnihWXDBBc2vfvWrwpnFr6NR5xQEKcDUdSy++OKmX79+ZrPNNrO/P3PNNVei63rqqafMnnvuWfN3MlEFKQ9S8HfVVVeZf/3rX+bEE09MWcucpzV7jrz33ntm4MCBlRP1PFpnnXW8td9ZFb3++uv22X3uuedWnpnVbSW9/zurj9SLAAIIIIBAWQQIAMsyUvQTAQQQQCC1wD//+U+z6aabVs7fZZddzMknn5yovvHjx5sdd9yxw7FdunQxTzzxhFl44YUT1aHg5tVXX7XHLrvssua+++6rnNfsxT1RA4EcpODvjjvuMH/4wx/Mm2++meiqevToYQYPHmz23XdfGwiFVnwFgA888IA55ZRTbPB08MEHm6FDhxaOKmkAWK/jCgOPPvpos8UWWzS9tjwCwGeeecYcf/zxNtCuF+Y27XidA5o9R8oWAP7nP/8xF1xwgf0LEc3+i/+lSTUBAWDau4bzEEAAAQTaTYAAsN1GnOtFAAEE2lRg4403Nu+//769+r59+5rRo0cnkrj00kvN8OHD5zj27LPPNttss03TOr744gs7M0kvsSqDBg3qMBux2Yt70wYCOeDDDz80v/3tbyuz3eKXpcBV4d78889vPv/8czN9+vQ5rrpXr152puUGG2wQiMh/L8NXABi//8sQACrYXWSRRWqOpWbR6R6YMmVKzZ//7Gc/M5oJ2WiZcx4BYJKxTHvzNnuOlC0AbGV8CADT3jWchwACCCDQbgIEgO024lwvAggg0KYCv/vd78zIkSPt1StQ0rLKBRZYoKmGArvnnnvOHrfooouajz/+2P67wj+FgM3KI488Yg444IDKYZdcconZZJNNKv/d7MW9Wf0h/Pzvf/+7ncH373//u3I5Cvt23nlnu2zxBz/4gZlnnnkqP9OMTi0PvvHGG83bb79d+XMt/zzuuONsyBpKSRIaJQlAyhYAJpkhp1lir732mrn77rvNzTffbBQMRkX3jX7X9Lteq7QSMPm6l5KMZdq2mj1HCADTynIeAggggAAC4QgQAIYzllwJAggggEADgb/85S/msMMOqxyhZabNZovpu3P9+/c3X331lT3vyCOPNPp+oIpmJz3++ON1A4aooXPOOcf88Y9/tP+pb5cpeNB37Cj/FVCgqiXWmgEYFS3X1lLJ3r17N2TSuPzpT3+ySwX1fcConHfeeWarrbYKgthXaBRiABgfYH0rbsiQIeaDDz6o/PFvfvMb+2dFKb7GMs31hBwApvHgHAQQQAABBNpRgACwHUeda0YAAQTaUOCTTz4x6623ntF35lQOPPBAc+ihhzaUuPfee82vf/1re8yKK65orrzySvOTn/ykco42AtGGII3Krrvuaje0UNFMNs1ao/xPQDP/Hnvsscof/OIXv7BLgevN3Kplp/O1qcXMmTPtjzV78M477zTLLLNM6al9hUahB4AaaH1bT7NGFdyraAmwZgcuvfTShbgPfI1lmoshAEyjxjkIIIAAAgiEJUAAGNZ4cjUIIIAAAg0EtGx3woQJ9ogkO+4ee+yx5tZbb7XH6+Vd/7311lubiRMn2j9rNsNoxowZZu21167MTtPGC/r+GuW/Avfff38Hj4022shcdtllLYV/kaWWd2uZd1RU1+9///vSU/sKjdohANRgK5Q/5phjKuOuAP6kk04qxH3g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gEEOa/EvigdQ8ceIHiKAAAIIIIAAAggg0O4CacKWdjcr+/U/9dRTZs8997SX8eCDD5qlllqqUJeU5p7k/btQQ5hbZwgAc6Nv74Z5ALX3+HP1CCCAAAIIIIAAAgiUQaDlsGXaNGOmTy/DpaXrY/fuxvToke7ckpxFAFiSgaKbLQsQALZMxgk+BAgAfShSBwIIIIAAAggggAACCHSmQMsB4EcfGTNpkjGffdaZ3cqn7p49jend25hevfJpP6NWCQAzgqaZzAUIADMnp0EJEAByHyCAAAIIIIAAAggggEDRBVIFgBMnGnPIIUW/tNb7N3y4MX37EgC2Luf1jJbvSd6/vfqXuTICwDKPXon7TgBY4sGj6wgggAACCCCAAAIItIlAy2GLZgASAJb67mAGYKmHj843ECAA5PbIRYAAMBd2GkUAAQQQQAABBBBAAIEWBAgAY1gZzACMh2/jx483l19+ubn55pvNlClTTJ8+fcxBBx1kttlmG9upDz74wPzpT38yjz76qPnwww9Nly5dzNJLL2022mgjs/fee5uFFlqo7khPnjzZXHPNNXaTj/fee8/MP//8Zp111jEHHnig+eyzz9gEpIXfEQ4tjwABYHnGKqieEgAGNZxcDAIIIIAAAggggAACQQoQAOYXAA4aNMjccMMNHe6rm266yay55prmL3/5izn66KPNzJkza953PXv2NJdccolZe+215/j5yy+/bA444ADzySefzPGzeeaZx+y+++42WFRhF+Agf63b9qIIANt26PO9cALAfP1pHQEEEEAAAQQQQAABBJoLEADmFwCq5c0228wcdthhZt555zVjxowxu+22m3niiSfMvvvua7755huz8sorm6FDh9pQ8OuvvzbPPvusGT58uHn77bdNjx49zO23326WW265ykV8+umnZosttrCz/BQSHnHEEWaDDTawdSnsO//8883UqVMrxxMANv8d4YjyCBAAlmesguopAWBQw8nFIIAAAggggAACCCAQpAABYH4B4FJLLWXuvfdeM/fcc1c6oZBPoaCW7a6++urmuuuuM/PNN1+He+/zzz8322+/vT1m4403Npdddlnl56eeeqq59tprjWb63XLLLaZfv34dzh03bpzRzMMvv/zS/jkBYJC/1m17UQSAbTv0+V44AWC+/rSOAAIIIIAAAggggAACzQUIAPMLAPfaay9z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vUcA2PG3j/fvEJ5G7tdAAOhuSA0pBHgApUDjFAQQQAABBBBAwJMAAaAnyByqKVMIkwOP9yYJALMJAHfZZRfz4osvmv79+5urr756jnG8++67zaGHHmr//Pjjjze77777HMfoe3xatqsZer/73e86bAKy4YYb2o07Hn74Yfs9vG9/+9tmlVVWMXvssYf5yU9+MkddtTYB0bFPP/30HMcuueSS5qGHHurw51oGruv429/+Zt599127JLxPnz5m/fXXN7/4xS/sv6ctrd6Taof377TaYZ1HABjWeJbmangAlWao6CgCCCCAAAIIBChAAFjeQSUAzHbsWg1bQv7d6sx777LLLjMXXHCB3Vn32WefNfPNN1+HgVbod/PNN9s/22KLLczw4cM7/Pyrr76y4eHUqVPtrr/rrrtuJQDccccdzQMPPGA/fVCrHH744XPs5usSAD755JPm17/+tfn8889rtqdNVM466yyz+eabp7qZW70nCQBTMQd5EgFgkMNa/IsiACz+GNFDBBBAAAEEEAhXIOSQItxR+++VdWYIE7pdmutrNWwJ+XerM++91157zWy33XZ2iEaMGGEGDBjQYbg222wz884779g/W2SRRcwTTzzR4efPPPOMGTx4sOnSpYsZM2aMmTVrViUA1IEK3X71q1/Z8FDhokK6M844w4aCc889t9EMw2WXXbZSZ60AULs7aybfz372M/PBBx+YX/7yl/afueaay8w///z23IkTJ5qddtrJ7gQtLwWBCibVxssvv2wuuugiM378ePvf11xzjVlrrbVavi1bvScJAFsmDvYEAsBgh7bYF0YAWOzxoXcIIIAAAgggELZAyCFF2CNHAJj1+LYatoT8u9WZAaDGVUtx//3vf9vZeJqVFxWFbRtttJFdtjtt2jTzzTff2MBuhRVWqBxz7rnn2iW+q622mhk5cqTdhGXgwIH25woFFbb96Ec/6nD7aNnukCFD7J8dffTRZu+9924YAEY/bLQJiEJIhZGyUj+0a3K8KJjUMS+99JJZaaWVzJ133tnyLd3qPUkA2DJxsCcQAAY7tMW+MALAYo8PvUMAAQQQQACBsAVCDinCHjkCwKzHt9WwJeTfrc4OAI877jhzyy23mFVXXdXcdtttlaHWvx9zzDE20NP39DTL7oQTTjCDBg2qHLPtttua119/3c64O+iggzoEgAoW//jHP85x62g235prrmlmzpxpvymoZcZRqTUDsFkA+MYbb5itttrKHnb66aebHXbYoebtOnbs2ErYqOtdY401WrqtW70nCQBb4g36YALAoIe3uBdHAFjcsaFnCCCAAAIIIBC+QMghReij19khTOh+rV5fq2FLyL9bnX3v6Tt9Cu+0pFZLdBdccEE7XEcccYQZPXq0DQHffPNN+y3ALbfc0px//vn255o1GG3kMWrUKNOvX78OAWAUCtYa+w022MBukKHlx2eeeaZTAHj99debk08+2dah2X/LL798zdtNgeOPf/xju5z4yCOPtJuCtFJavScJAFvRDftYAsCwx7ewV0cAWNihoWMIIIAAAggg0AYCIYcUoQ9fZ4cwofu1en2thi0h/2519r03ffp0s84669jv9+lbefrun4rCso8++sjccccddpafQrNevXqZxx57rBK2adffxRdf3DzyyCP2z+JLgOvtGqzjouW8W2+9tTnnnHOcAsBhw4bZ7xe2Uvbcc0+7Y3ErpdV7kgCwFd2wjyUADHt8C3t1BICFHRo6hgACCCCAAAJtIBBySBH68HV2CBO6X6vX12rYEvLvVhb33r777muDPS3v1TLfaFltz5497axAzfbTrD2Ve+65x86y0wy/e++91+y6667mpJNOmiMA1K7A2pijVvEZAB577LHm1ltvbekW23777e1mJK2UVu9JAsBWdMM+lgAw7PEt7NURABZ2aOgYAggggAACCLSBQMghRejDl0UIE7phK9fXatgS8u9WFvfetddeaxTYLbfccjbUi/570003NRdffLEdumhHYIV9O+64o1l33XXNlClT7CYgUTgYnwGYVQCodtRflXHjxtndhjujtHpPEgB2xiiUs04CwHKOW+l7TQBY+iHkAhBAAAEEEECgxAIhhxQlHpZEXc8ihEnUkTY5qNWwJeTfrSzuPW3ysckmm9i76+GHH7abadx33312mayWy6pEm4Voww3NFNQGHvPPP7956qmnKqFbHgHgVVddVfmOYPUuxdW/LrNnz7a7E6cprd6TBIBplMM8hwAwzHEt/FURABZ+iOggAggggAACCAQsEHJIEfCw2UvLIoQJ3bCV62s1bAn5dyure++nP/2peeutt8xpp51mzjvvPPPJJ5+YO++806y00kp26O666y5z+OGH2+8Aagnt5Zdfbr/ld9lll1WGNo8AULP+oqXG6t8BBxxQ81Z7/vnn7S7Affr0Mb/5zW+MrreV0uo9SQDYim7YxxIAhj2+hb06AsDCDg0dQwABBBBAAIE2EAg5pAh9+LIKYUJ3THp9rYYtIf9uZXXvaTdezaZbZZVVzCuvvGIWWmghM3bs2MqMOW0Ioo1BVBZeeGEzefJku2w4/p2/zgwAoyXIv/zlL81hhx3W4Vbadttt7UYlCyywgP0eoJYyx8uMGTPMXnvtZV588UUzzzzz2GXOSy65ZNLb0R7X6j1JANgSb9AHEwAGPbzFvTgCwOKODT1DAAEEEEAAgfAFQg4pQh+9rEKY0B2TXl+rYUvIv1tZ3Xtayhst99U4bb755ubCCy/sMGTRLEH9oZbSjhkzxvTu3btyTGcGgDvvvLN56aWXTL9+/Wy/evToYYNIFc3u22OPPcxXX31ltHHJ0KFDzYYbbmiXKL/22mv2O4YvvPCCPfbAAw80hx56aNJbsXJcq/ckAWDLxMGeQAAY7NAW+8IIAIs9PvQOAQQQQAABBMIWCDmkCHvkWAKc9fi2GraE/LuVVQCo8Kx///5m6tSpdrj1zb/Bgwd3GPoTTzzR3HjjjfbPVlttNTNy5MgOP+/MAPDcc8+1G45ERTP5FOrpf1UefPBBc8QRR5jp06fXvV01W1GbmHTt2rXlW7rVe5IAsGXiYE8gAAx2aIt9YQSAxR4feocAAggggAACYQuEHFKEPXIEgFmPb6thi363Pv30U/P1119n3dVOb09hlZbjamZbZ5dDDjnE/PWvf7XNjB492vTt27dDk/fcc4/9fp6KZtkdfPDBmQWAM2fONGeffbbtn8Zbs/+uv/56s/TSS1f68PHHH9sdgR955BGjjU10juzWXHNNs8suu5j11lsvNWGr9yQBYGrq4E4kAAxuSMtxQQSA5RgneokAAggggAACYQoQAJZ3XLOahVVeIb89bzVs0Tfe9E+opVu3bkb/UPITaPWeJADMb6yK1jIBYNFGpE36QwDYJgPNZSKAAAIIIIBAIQUIAAs5LIk6RQCYiMnbQWnCFm+NUxECNQTS3JO8f3MrSYAAkPsgFwEeQLmw0ygCCCCAAAIIIGAFCADLeyMQAGY7dmnClmx7SGvtJpDmnuT9u93uktrXSwDIfZCLAA+gXNhpFAEEEEAAAQQQIAAs+T1AAJjtAKYJW7LtIa21m0Cae5L373a7SwgAO33E9YHP2267zbz44otm8uTJZt555zXLLrus2WCDDew25tHW4NUd+fLLL+0ORnfeead58803zezZs82SSy5pNtlkE7PPPvs0/cjqhAkTzBVXXGG0Xbra1UdZV111VTNo0CDzk5/8pOF1u7adFpUHUFo5zkMAAQQQQAABBNwFmAHobphXDQSA2cqnCVuy7SGttZtAmnuS9+92u0sIADttxLVN+VFHHWV3J6pXFllkEXPJJZfYXX/iRbsB7bvvvuaZZ56peWrv3r3NlVdeOceuR9HBDzzwgN39SEFerbLHHnuYY489tubPXNt2AeUB5KLHuQgggAACCCCAgJsAAaCbX55nEwBmq58mbMm2h7TWbgJp7knev9vtLiEA7LQRP/PMM81VV11l6x84cKDZb7/9zHe+8x0zadIku+33pZdeav7zn//YmXma5bfYYotV+qLwTluYzzPPPHbr8p/97Gd25uDDDz9stxafMmWKnQ141113me7du3e4hldeecXstttudkvx1VZbzfz2t781K664onnvvffMZZddZh588EF7/PHHH2923333Oa7fpW1XTB5AroKcjwACCCCAAAIIpBcgAExvl/eZBIDZjkCasCXbHtJauwmkuSd5/263u4QAsFNG/N///rfZeOONjWYBbr311uacc86Zo51x48bZoE7HKIhTIKeiP99pp53sv5944on2mHgZP368/TPN7lNYN2TIkA4/33///c2YMWPMMsssY/785z+bHj16VH6uZcRDhw41999/vw0eFQZ+61vfqvzctW1XTB5AroKcjwACCCCAAAIIpBcgAExvl/eZBIDZjkCasCXbHtJauwmkuSd5/263u4QAsFNG/Prrrzcnn3yyrfuhhx6ys/VqFc3uUxinn+s4lWgGnv5MP+vatescpx599NHm9ttv73CeDtK3Arfcckt7/KmnnloJEuMVaCagviOoMPD00083O+ywQ+XHLm37gOQB5EOROhBAAAEEEEAAgXQCBIDp3IpwFgFgtqOQJmzJtoe01m4Cae5J3r/b7S4hAOyUET///PPNn/70Jzu77vHHH6/bxllnnWW/5aelvi+//LIN5X74wx+aqVOn2s06TjjhhJrn6ht/Bx10kP2ZZvl973vfs/8+YsQIM2zYMNOlSxfbrr4xWKtsu+225vXXX7dLk7UUWcW1bR+QPIB8KFIH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1c6/dfZJCMCjjjpKlixZ4gRgr1695KabbpL99tsvV0L6NOB5550nH3/8sZOAe+65Z5sUzFWYi70QYAHygpEiEIAABCAAgSgEEIBRsHsbFAHoDWWUQgjAKNgZFAKmCbD/Nh2ft+ajC8A///nPMmLECDchffJv0qRJMnDgQC8T/N3vfidjx451tVQu/v73v5f+/ft7qU2RfARYgPLx42oIQAACEIBATAIIwJj084+NAMzPMGYFBGBM+owNAZsE2H/bzM1319EF4DXXXCO33367E3RDhw4V/e8+j5EjR8qCBQtcff1QyH/913/5LE+tjARYgDKC4zIIQAACEIBAAgQQgAmEkKMFBGAOeAlcigBMIARagIAxAuy/jQUWqN3oAnDUqFEyf/58J+gmT54s++yzj9ep3n///e5VYK2/7777ym9+8xuv9SmWjQALUDZuXAUBCEAAAhBIgQACMIUUsveAAMzOLoUrEYAppEAPELBFgP23rbxCdRtdAB500EHy5ptvSpcuXdyTevqfPo9ly5bJ/vvv70puvfXW8vjjj/ssT62MBFiAMoLjMghAAAIQgEACBBCACYSQowUEYA54CVyKAEwgBFqAgDEC7L+NBRao3egCcI899pCVK1fKVlttJXPmzAkyTRWA+j9UN954Y9HfHOSIT4AFKH4GdAABCEAAAhDISgABmJVcGtchANPIIWsXCMCs5LgOAtUlwP67utm3n3l0AThgwABZtWqVbLvttjJr1qwgqQwePFhee+0193ThokWLgoxRq+gVV1zhXmvW/xw+fPh6x1UG06ZNkz/+8Y+ydOlS9+Xivn37ypAhQ2TMmDGy2Wabrff6F154QW677TZ55pln5J133nHn6/+4099APPjgg4OOnQUoC1AWalwDAQhAAAIQSIMAAjCNHLJ2gQDMSi6N6xCAaeRAFxCwRID9t6W0wvUaXQAeeOCB8vbbb0v37t3dK8AhDv2q8Hvvveek2NNPPx1iiHVqPvroo3L22WfLmjVr6grAFStWyKmnnirz5s2r2Zu+ujxx4kTZZZddav79kUcekXPPPdeJ1FrH6NGj5dJLL635t7xjZ4XJApSVHNdBAAIQgAAE4hNAAMbPIE8HCMA89OJfiwCMnwEdQMAaAfbf1hIL0290AThixAj3Wq5+pGPmzJmi/w/N5/H666/Lf/zHf7j6O+64o9x7770+y9es9dhjj8l3vvMd92qzHvWeAFR598ADD7gnFFUaHnHEEdK1a1eZPXu2jB8/3slLfRpQe1dR2v5YvHixKEMVebvvvrtceOGFsvPOO8s///lPufXWW0VFpB4/+MEPRD+48skjz9h5QLIA5aHHtRCAAAQgAIG4BBCAcfnnHR0BmJdg3OsRgHH5MzoELBJg/20xNf89RxeAP/rRj2TKlClO0F122WVy/PHHe53lHXfc4epq/cMOO0x++tOfeq3fvpg+7XfzzTfLLbfc4p78az3WJwAXLlzY9nqw9qkyr/2hryzrv9On+1TWnXHGGWv9/bTTTnO/nbjDDjvIH/7wB+nRo0fb3/U14nPOOceJVX36UWVgz5492/6ed+w8IFmA8tDjWghAAAIQgEBcAgjAuPzzjo4AzEsw7vUIwLj8GR0CFgmw/7aYmv+eowtAlVff+ta3nKDTV1zvueceb7NUATZ06FD5+9//7upfcsklctJJJ3mr377Qk08+Kddee63ob/Hp8fnPf1706Tw91icAW5/A0yf8VNR17tx5nf607+nTp7unANv/TqL+VuDXvva19Y6hTwLq7wgqi6uuukqOPfbYtvp5xs4LkQUoL0GuhwAEIAABCMQjgACMx97HyAhAHxTj1UAAxmPPyBCwSoD9t9Xk/PYdXQDqk236kY4333zTu6T77W9/6+SbHp06dXJPwOnHRkIcn/vc51xZfY339NNPd+Lx0EMPXa+cUym37777yvvvv+8+1jFu3Liarelv/J111lnub/qU36677ur++fbbb5err77acXvqqaekd+/eNa8/8sgjZcmSJfLlL3/ZPZ2oR96x8zJkAcpLkOshAAEIQAAC8QggAOOx9zEyAtAHxXg1EIDx2DMyBKwSYP9tNTm/fUcXgDqdX/7yl3L99de7mW244YZy0003ySGHHJJrpvpkof6eXuuHMb7yla/Iz372s1w113dxv379nGA777zz3G8N6pN3+t/16OgJwFdeecU9nafHlVdeKcOGDas5xKuvvuok6Sdr6e/96ROTKjX19wI7OlqfIOzTp488/vjj7rS8Y+cFyQKUlyDXQwACEIAABOIRQADGY+9jZASgD4rxaiAA47FnZAhYJcD+22pyfvtOQgDqxzK+/vWvyz/+8Q/3ZJpKwDPPPNO9Gqz/3MyhtfSLufqk28cff+zqbbzxxu7JuU996lPNlGrq3Jdeekk+85nPtF3TiADULxKffPLJ7ppJkybJoEGDao6p8xgwYICsXr3a/Qagvrqrx4knnui+HLzPPvu431Hs6FChOmHCBPekoP6moD6lmHfspuDUOJkFKC9BrocABCAAAQjEI4AAjMfex8gIQB8U49VAAMZjz8gQsEqA/bfV5Pz2nYQA1Cn99a9/dTJMv2ar0k5l1dZbb+1+s+6AAw6QPfbYw4mrWod+cENfcdVXZe+66y73OnFrDT1fX5PV12CLPBoRgPrl31aZd/fdd0v//v07bHHvvfeWDz74wH3JV7/oq8fhhx8uL774ons6UL/429GhcvHHP/6x+/PcuXNliy22cF8dzjN2PZa6wKzveOONN9o+fqJPJerTiRwQgAAEIAABCNgggAC0kVNHXSIAbeeHALSdH91DIAYBBGAM6umNmYwAVDT6G336Cq0+xacCTw8VgXp069bNPWGn8mrzzTd3f//oo49Eb2R9+m758uXuvFbxp/+pv/unsuyEE04onHwjAlCfSrzoootcb/fff797dbij48ADD5S33nrLCVH9mIce+vqwvsqrHwK54YYbOrx22rRp7kvIeuirwvrKcN6x6wFt/U3Eeufp3xGAjVDiHAhAAAIQgEA6BBCA6WSRpRMEYBZq6VyDAEwnCzqBgBUCCEArSYXtMykBqFNduHChk4Aq0FrlX6sM1L+3/rtWLLX+pv9uu+22k2uuucZ9ZCPG0YgAnDFjhlxwwQWuPX0i77Of/WyHrepTkG+//bZ7aq71wyaHHXaYvPzyy+5JwNbfUKxVYOrUqfLDH/7Q/Ul/G3GbbbaRvGPXY4oArEeIv0MAAhCAAATsEkAA2s1OO0cA2s4PAWg7P7qHQAwCCMAY1NMbMzkBqIj0NeDbbrvN/a7dO++846h9Uvy1R9leAu6www4yevRoOf7446Vr167RiDciAPWJR/2tQz3af923VtOtrwDr7/6NHTvWnXL00UfLc889t9bXfWtd2/4VYP3tP32CMu/Y9cDyCnA9QvwdAhCAAAQgYJcAAtBudghA29lp9whA+xkyAwgUTQABWDTxNMdLUgC2otJXgfX1UP0/fTJQn3bTf9f+UJm10047iQqygw46yP1nCkcjAvDZZ591slKPyZMny8CBA2u23v4jIOecc477urEeeq3W0Ov0+o6OG2+8UW6++Wb3SvTixYvdf+YdOy9jFqC8BLkeAhCAAAQgEI8AAjAeex8j8wSgD4rxaiAA47FnZAhYJcD+22pyfvtOWgB+cqr6pJ9+CEN/+69z587Ss2dP99uAKR6NCED9EIZKSz30deWjjjqq5lReffVV96EPPfRjHsccc4z7Z/19wzvvvFO233579wGUjo5LLrlEpk+fLn379pVZs2a50/KOnZc5C1BeglwPAQhAAAIQiEcAARiPvY+REYA+KMargQCMx56RIWCVAPtvq8n57duUAPQ79bDVGhGA2sH+++8v7777rpxyyimioq7WMXPmzLan/tq/KqyvSF9++eXuib5nnnlGNtlkk5rXDx06VF544YV1XhXOM3ZeeixAeQlyPQQgAAEIQCAeAQRgPPY+RkYA+qAYrwYCMB57RoaAVQLsv60m57dvBKBfnm3VGhWA+hVglXqf/vSn3YdAVOZ98rj44ovl7rvvlq222kqeeOKJtt9D1C8A65eA9Rg/fryo6Pvkoecceuih7uvI+iXgESNGtJ2SZ+y82FiA8hLkeghAAAIQgEA8AgjAeOx9jIwA9EExXg0EYDz2jAwBqwTYf1tNzm/fCEC/PJsWgHPnznVP/+mhr/SOGjVqrY70tw9V2unvAOoXg0877bS1/j5y5EiZP3++E4h33XWX9OrVq+3vKv309wL19WD9rUR9/bd79+5tf887dh50LEB56HEtBCAAAQhAIC4BBGBc/nlHRwDmJRj3egRgXP6MDgGLBNh/W0zNf88IQP9MXcVGnwDUc8844wwn5/R3DVXwDRs2zP224ezZs92TfcuWLXNf+7rnnnvc7x62PxYtWiTHHXecrFmzRnbZZRfRp/r69+8v//rXv9yHP/Rrvx3Jxbxj50HHApSHHtdCAAIQgAAE4hJAAMbln3d0BGBegnGvRwDG5c/oELBIgP23xdT894wA9M+0aQGogu/UU08VlXm1ji233FL09/70Kb9ah37gY+zYse4pwVrHmDFjRF8jrnXkHTsrPhagrOS4DgIQgAAEIBCfAAIwfgZ5OkAA5qEX/1oEYPwM6AAC1giw/7aWWJh+EYBhuDb1BKC2sGrVKpk2bZrMmDFDli5dKitXrnRf7T3kkEPcU4G9e/deb6f6kY+JEye6j4G8/fbb7lVf/R93+opw6+8EdlQg79hZELIAZaHGNRCAAAQgAIE0CCAA08ghaxcIwKzk0rgOAZhGDnQBAUsE2H9bSitcrwjAcGypvB4CLEDcHhCAAAQgAAG7BBCAdrPTzhGAtvNDANrOj+4hEIMA++8Y1NMbEwGYXiaV6IgFqBIxM0kIQAACECgpAQSg7WARgLbzQwDazo/uIRCDAPvvGNTTGxMBmF4mleiIBagSMTNJCEAAAhAoKQEEoO1gEYC280MA2s6P7iEQgwD77xjU0xsTAZheJpXoiAWoEjEzSQhAAAIQKCkBBKDtYBGAtvNDANrOj+4hEIMA++8Y1NMbEwGYXiaV6IgFqBIxM0kIQAACECgpAQSg7WARgLbzQwDazo/uIRCDAPvvGNTTGxMBmF4mleiIBagSMTNJCEAAAhAoKQEEoO1gEYC280MA2s6P7iEQgwD77xjU0xsTAZheJpXoiAWoEjEzSQhAAAIQKCkBBKDtYBGAtvNDANrOj+4hEIMA++8Y1NMbEwGYXiaV6IgFqBIxM0kIQAACECgpAQSg7WARgLbzQwDazo/uIRCDAPvvGNTTGxMBmF4mleiIBagSMTNJCEAAAhAoKQEEoO1gEYC280MA2s6P7iEQgwD77xjU0xsTAZheJpXoiAWoEjEzSQhAAAIQKCkBBKDtYBGAtvNDANrOj+4hEIMA++8Y1NMbEwGYXiaV6IgFqBIxM0kIQAACECgpAQSg7WARgLbzQwDazo/uIRCDAPvvGNTTGxMBmF4mleiIBagSMTNJCEAAAhAoKQEEoO1gEYC280MA2s6P7iEQgwD77xjU0xsTAZheJpXoiAWoEjEzSQhAAAIQKCkBBKDtYBGAtvNDANrOj+4hEIMA++8Y1NMbEwGYXiaV6IgFqBIxM0kIQAACECgpAQSg7WARgLbzQwDazo/uIRCDAPvvGNTTGxMBmF4mleiIBagSMTNJCEAAAhAoKQEEoO1gEYC280MA2s6P7iEQgwD77xjU0xsTAZheJpXoiAWoEjEzSQhAAAIQKCkBBKDtYBGAtvNDANrOj+4hEIMA++8Y1NMbEwGYXiaV6IgFqBIxM0kIQAACECgpAQSg7WARgLbzQwDazo/uIRCDAPvvGNTTGxMBmF4mleiIBagSMTNJCEAAAhAoKQEEoO1gEYC280MA2s6P7iEQgwD77xjU0xsTAZheJpXoiAWoEjEzSQhAAAIQKCkBBKDtYBGAtvNDANrOj+4hEIMA++8Y1NMbEwGYXiaV6IgFqBIxM0kIQAACECgpAQSg7WARgLbzQwDazo/uIRCDAPvvGNTTGxMBmF4mleiIBagSMTNJCEAAAhAoKQEEoO1gEYC280MA2s6P7iEQgwD77xjU0xsTAZheJpXoiAWoEjEzSQhAAAIQKCkBBKDtYBGAtvNDANrOj+4hEIMA++8Y1NMbEwGYXiaV6IgFqBIxM0kIQAACECgpAQSg7WARgLbzQwDazo/uIRCDAPvvGNTTGxMBmF4mleiIBagSMTNJCEAAAhAoKQEEoO1gEYC280MA2s6P7iEQgwD77xjU0xsTAZheJpXoiAWoEjEzSQhAAAIQKCkBBKDtYBGAtvNDANrOj+4hEIMA++8Y1NMbEwGYXiaV6IgFqBIxM0kIQAACECgpAQSg7WARgLbzQwDazo/uIRCDAPvvGNTTGxMBmF4mleiIBagSMTNJCEAAAhAoKQEEoO1gEYC280MA2s6P7iEQgwD77xjU0xsTAZheJpXoiAWoEjEzSQhAAAIQKCkBBKDtYBGAtvNDANrOj+4hEIMA++8Y1NMbEwGYXiaV6IgFqBIxM0kIQAACECgpAQSg7WARgLbz69+/v/Tq1Us23nhj2xOhewhAoDAC7L8LQ530QAjApOMpb3MsQOXNlplBAAIQgED5CSAAbWeMALSfX5cuXaSlpcX2RCrefbdu3UT/jwMCRRBg/10E5fTHQACmn1EpO2QBKmWsTAoCEIAABCpCAAFoO2gEYDny+/DDD2X16tW2J1PR7jt37iybb765bLbZZhUlwLSLJsD+u2jiaY6HAEwzl9J3xQJU+oiZIAQgAAEIlJgAAtB2uAhA8rNNwH73/I6j/QytzYD9t7XEwvSLAAzDlap1CLAAcYtAAAIQgAAE7BJAANrNTjtHAJKfbQL2u0cA2s/Q2gzYf1tLLEy/CMAwXKmKAOQegAAEIAABCJSWAALQdrQIQPKzTcB+9whA+xlamwEC0FpiYfpFAIbhSlUEIPcABCAAAQhAoLQEEIC2o0UAkp9tAva7RwDaz9DaDBCA1hIL0y8CMAxXqiIAuQcgAAEIQAACpSWAALQdLQKQ/GwTsN89AtB+htZmgAC0lliYfhGAYbhSFQHIPQABCEAAAhAoLQEEoO1oEYDkZ5uA/e4RgPYztDYDBKC1xML0iwAMw5WqCEDuAQhAAAIQgEBpCSAAbUeLACQ/2wTsd48AtJ+htRkgAK0lFqZfBGAYrlRFAHIPQAACEIAABEpLAAFoO1oEIPnZJmC/ewSg/QytzQABaC2xMP0iAMNwpSoCkHsAAhCAAAQgUFoCCEDb0SIAyc82AfvdIwDtZ2htBghAa4mF6RcBGIYrVRGA3AMQgAAEIACB0hJAANqOFgFIfrYJ2O8eAWg/Q2szQABaSyxMvwjAMFypigDkHoAABCAAAQiUlgAC0Ha0CEDys03AfvcIQPsZWpsBAtBaYmH6RQCG4UpVBCD3AAQgAAEIQKC0BBCAtqNFAJKfbQL2u0cA2s/Q2gwQgNYSC9MvAjAMV6oiALkHIAABCEAAAqUlgAC0HS0CkPxsE7DfPQLQfobWZoAAtJZYmH4RgGG4UhUByD0AAQhAAAIQKC0BBKDtaBGA5GebgP3uEYD2M7Q2AwSgtcTC9IsADMOVqghA7gEIQAACEIBAaQkgAG1HiwAkP9sE7HePALSfobUZIACtJRamXwRgGK5URQByD0AAAhCAAARKSwABaDtaBCD52SZgv3sEoP0Mrc0AAWgtsTD9IgDDcKUqApB7AAIQgAAEIFBaAghA29EiAMnPNgH73SMA7WdobQYIQGuJhekXARiGK1URgNwDEIAABCAAgdISQADajhYBSH62CdjvHgFoP0NrM0AAWkssTL8IwDBcqYoA5B6AAAQgAAEIlJYAAtB2tAhA8rNNwH73CED7GVqbAQLQWmJh+kUAhuFKVQQg9wAEIAABCECgtAQQgLajRQCSn20C9rtHANrP0NoMEIDWEgvTLwIwDFeqIgC5ByAAAQhAAAKlJYAAtB0tApD8bBOw3z0C0H6G1maAALSWWJh+EYBhuFIVAcg9AAEIQAACECgtAQSg7WgRgORnm4D97hGA9jO0NgMEoLXEwvSLAAzDlaoIQO4BCEAAAhCAQGkJIABtR4sAJD/bBOx3jwC0n6G1GSAArSUWpl8EYBiuVEUAcg9AAAIQgAAESksAAWg7WgQg+dkmYL97BKD9DK3NAAFoLbEw/SIAw3ClKgKQewACEIAABCBQWgIIQNvRIgDJzzYB+90jAO1naG0GCEBriYXpFwEYhitVEYDcAxCAAAQgAIHSEkAA2o4WAUh+tgnY7x4BaD9DazNAAFpLLEy/CMAwXKmKAOQegAAEIAABCJSWAALQdrQIQPKzTcB+9whA+xlamwEC0FpiYfpFAIbhSlUEIPcABCAAAQhAoLQEEIC2o0UAkp9tAva7RwDaz9DaDBCA1hIL0y8CMAxXqiIAuQcgAAEIQAACpSWAALQdLQKQ/GwTsN89AtB+htZmgAC0lliYfhGAYbhSFQHIPQABCEAAAhAoLQEEoO1oEYDkZ5uA/e4RgPYztDYDBKC1xML0iwAMw5WqCEDuAQhAAAIQgEBpCSAAbUeLACQ/2wTsd48AtJ+htRkgAK0lFqZfBGAYrlRFAHIPQAACEIAABEpLAAFoO1oEIPnZJmC/ewSg/QytzQABaC2xMP0iAMNwpSoCkHsAAhCAAAQgUFoCCEDb0SIAyc82AfvdIwDtZ2htBghAa4mF6RcBGIYrVRGA3AMQgAAEIACB0hJAANqOFgFIfrYJ2O8eAWg/Q2szQABaSyxMvwjAMFypigDkHoAABCAAAQiUlgAC0Ha0CEDys03AfvcIQPsZWpsBAtBaYmH6RQCG4UpVBCD3AAQgAAEIQKC0BBCAtqNFAJKfbQL2u0cA2s/Q2gwQgNYSC9MvAjAMV6oiALkHIAABCEAAAqUlgAC0HS0CkPxsE7DfPQLQfobWZoAAtJZYmH4RgGG4UhUByD0AAQhAAAIQKC0BBKDtaBGA5GebgP3uEYD2M7Q2AwSgtcTC9IsADMOVqghA7gEIQAACEIBAaQkgAG1HiwAkP9sE7HePALSfobUZIACtJRamXwRgGK5URQByD0AAAhCAAARKSwABaDtaBCD52SZgv3sEoP0Mrc0AAWgtsTD9IgDDcKUqApB7AAIQgAAEIFBaAghA29EiAMnPNgH73SMA7WdobQYIQGuJhekXARiGK1URgNwDEIAABCAAgdISQADajhYBSH62CdjvHgFoP0NrM0AAWkssTL8IwDBcqYoA5B6AAAQgAAEIlJYAAtB2tAhA8rNNwH73CED7GVqbAQLQWmJh+kUAhuFKVQQg9wAEIAABCECgtAQQgLajRQCSn20C9rtHANrP0NoMEIDWEgvTLwIwDFeqIgC5ByAAAQhAAAKlJYAAtB0tApD8bBOw3z0C0H6G1maAALSWWJh+EYBhuFIVAcg9AAEIQAACECgtAQSg7WgRgORnm4D97hGA9jO0NgMEoLXEwvSLAAzDlaoIQO4BCEAAAhCAQGkJIABtR4sAJD/bBOx3jwC0n6G1GSAArSUWpl8EYBiuVEUAcg9AAAIQgAAESksAAWg7WgQg+dkmYL97BKD9DK3NAAFoLbEw/SIAw3ClKgKQewACEIAABCBQWgIIQNvRIgDJzzYB+90jAO1naG0GCEBriYXpFwEYhitVEYDcAxCAAAQgAIHSEkAA2o4WAUh+tgnY7x4BaD9DazNAAFpLLEy/CMAwXKmKAOQegAAEIAABCJSWAALQdrQIQPKzTcB+9whA+xlamwEC0FpiYfpFAIbhSlUEIPcABCAAAQhAoLQEEIC2o0UAkp9tAva7RwDaz9DaDBCA1hIL0y8CMAxXqiIAuQcgAAEIQAACpSWAALQdLQKQ/GwTsN89AtB+htZmgAC0lliYfhGAYbhSFQHIPQABCEAAAhAoLQEEoO1oEYDkZ5uA/e4RgPYztDYDBKC1xML0iwAMw5WqCEDuAQhAAAIQgEBpCSAAbUeLACQ/2wTsd48AtJ+htRkgAK0lFqZfBGAYrlRFAHIPQAACEIAABEpLAAFoO1oEIPnZJmC/ewSg/QytzQABaC2xMP0iAMNwpSoCkHsAAhCAAAQgUFoCCEDb0SIAyc82AfvdIwDtZ2htBghAa4mF6RcBGIYrVRGA3AMQgAAEIACB0hJAANqOFgFIfrYJ2O8eAWg/Q2szQABaSyxMvwjAMFypigDkHoAABCAAAQiUlgAC0Ha0CEDys03AfvcIQPsZWpsBAtBaYmH6RQCG4UpVBCD3AAQgAAEIQKC0BBCAtqNFAJKfbQL2u0cA2s/Q2gwQgNYSC9MvAjAMV6oiALkHIAABCEAAAqUlsGrVKlm5cqUsX768tHMs88R69eolLS0tsmLFClmwYEGZp1rKuSFw7ceKALSfobUZIACtJRamXwRgGK5URQByD0AAAhCAAARKS2D1++/LmvffRvUYnQAAIABJREFUl9WrV5d2jmWeWJcuXaSle3dZ0bmzzJs3r8xTLeXcEID2Y0UA2s/Q2gwQgNYSC9MvAjAMV6oiALkHIAABCEAAAqUlsPr112WDN96QNe+8U9o5lnlinXr3lpYtt5TlvXohAA0GjQA0GNonWkYA2s/Q2gwQgNYSC9MvAjAMV6oiALkHIAABCEAAAqUloAJQ/t//k4+++c3SzrHME+sxcaK07LQTAtBoyAhAo8G1axsBaD9DazNAAFpLLEy/CMAwXKmKAOQegAAEIAABCJSWAALQdrQIQNv5IQBt56fdIwDtZ2htBghAa4mF6RcBGIYrVRGA3AMQgAAEIACB0hJAANqOFgFoOz8EoO38EID287M4AwSgxdT894wA9M+Uig0QYAFqABKnQAACEIAABBIlgABMNJgG20IANggq0dMQgIkG00RbPAHYBCxO9UKA/bcXjOaLIADNR2hzAixANnOjawhAAAIQgIASQADavg8QgLbzQwDazk+7RwDaz9DaDNh/W0ssTL8IwDBcqVqHAAsQtwgEIAABCEDALgEEoN3stHMEoO38EIC280MA2s/P4gzYf1tMzX/PCED/TKnYAAEWoAYgcQoEIAABCEAgUQIIwESDabAtBGCDoBI9DQGYaDBNtMUTgE3A4lQvBNh/e8FovggC0HyENifAAmQzN7qGAAQgAAEIKAEEoO37AAFoOz8EoO38tHsEoP0Mrc2A/be1xML0iwAMw5WqdQiwAHGLQAACEIAABOwSQADazU47RwDazg8BaDs/BKD9/CzOgP23xdT894wA9M+Uig0QYAFqABKnQAACEIAABBIlgABMNJgG20IANggq0dMQgIkG00RbPAHYBCxO9UKA/bcXjOaLIADNR2hzAixANnOjawhAAAIQgIASQADavg8QgLbzQwDazk+7RwDaz9DaDNh/W0ssTL8IwDBcqVqHAAsQtwgEIAABCEDALgEEoN3stPOeTzwhsummsrpzZ1m2bJntyVSw+169eklLS4usWLFCFixYUEEC9qeMALSfobUZsP+2lliYfhGAYbhSFQHIPQABCEAAAhAoLQEEoO1oe86dK9K5s7QsXy4rV660PZkKdt+lSxdp6d5dVnTuLPPmzasgAftTRgDaz9DaDBCA1hIL0y8CMAxXqiIAuQcgAAEIQAACpSWAALQdrROAKv7eektWv/227clUsPtOvXtLy5ZbyvJevRCARvNHABoNznDbCEDD4XlsHQHoESalGifAAtQ4K86EAAQgAAEIpEYAAZhaIs310yYAX3xRPjj11OYu5uzoBPgNx+gR5G4AAZgbIQWaJMD+u0lgJT0dAVjSYFOfFgtQ6gnRHwQgAAEIQKBjAghA23cHAtB2fghA2/lp9whA+xlamwH7b2uJhekXARiGK1XrEGAB4haBAAQgAAEI2CWAALSbnXaOALSdHwLQdn4IQPv5WZwB+2+LqfnvGQHonykVGyDAAtQAJE6BAAQgAAEIJEoAAZhoMA22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kk2fBtSn+bbbbjt58803ZcaMGfLrX/9aVORtuumm8vvf/16233579+XfVpmnvyHYv3//DmehgvGDDz5wX/LVL/rqcfjhh8uLL77ong5UsdjRoXLxxz/+sfvz3LlzRUVko4cuMOs73njjjbbfHtSnC/UpQw4IQAACEIAABGwQQADayKmjLhGAtvNDANrOT7tHANrP0NoMEIDWEgvTLwIwDNeGqqpU09dsVYZdc8018vWvf32d6x5++GH3RV49DjvsMLnxxhvd7/lddNFF7t/df//9suOOO3Y43oEHHihvvfWW+4iHfsxDD319WF8j1g+B3HDDDR1eO23aNPeFYT30VWF9ZbjR43Of+1yjp7rXixGADePiRAhAAAIQgEB0AgjA6BHkagABmAtf9IsRgNEjyN0AAjA3Qgo0SQAB2CSwkp6OAEwgWH3Cb8MNN+ywk9NPP10ee+wx94Vgff13zpw5csEFF7jz9WnAz372sx1ee8ABB8jbb7/tnrbT3wHUQ0Xiyy+/7J4EvP766zu8durUqfLDH/7Q/V3H3GabbRqmhQBsGBUnQgACEIAABMwRQACai2ythhGAtvNDANrOT7tHANrP0NoMEIDWEgvTLwIwDFevVX/3u9/JpZde6mrqK8HLly+XM8880/339l/3rTVo6yvA+rt/Y8eOdaccffTR8txzz9X9um/7V4BVPLb/EEm9CfIKcD1C/B0CEIAABCBglwAC0G522jkC0HZ+CEDb+SEA7edncQYIQIup+e8ZAeifqfeKTz75pPsSsB7XXXedexJv9OjR7r9PnjxZBg4cWHPM9h8B0deIzz77bHeeXvvss8+66/T6jg593fjmm292Tx4uXrzY/aevgwXIF0nqQAACEIAABIongAAsnrnPERGAPmkWXwsBWDxz3yPyBKBvotSrR4D9dz1C1fg7AjCBnFtaWtyXdjs69PVffQ1YDxVy+mXfgw46yP13/e3Ao446qualr776qvvQhx76MY9jjjnG/bN+DOTOO+90HxR55JFHOhxXf59w+vTp0rdvX5k1a5ZXUixAXnFSDAIQgAAEIFAoAQRgobi9D4YA9I600IIIwEJxBxkMARgEK0XXQ4D9N7eHEkAARrwPzj//fHnqqafcF34feuihDjv51a9+5Z7806P1ox/777+/vPvuu3LKKae4D4nUOmbOnNn21F/7V4WnTJki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H364aMZdunSxq666yhlKRFgE5syZY//85z/tySefLJrYbrvtZmeccYa1aNEirOTJpl4Cp556qg0dOtRdgwEY9sMio11vVksFBmApQv6+/sEHH9j+++9v3333XZ1JdOrUyW644QZbffXV/SXJzHUSKMcA1AeePXv2hGhgBC644AIbPHhw0ax69+5tV199tS200EKBZU46s2bNsmOPPbbe30cPP/xwO+SQQ4AFgaAJYAAGLQ/JhUTgv//9r+mFXYaEggrAkNQpnsv5559vN954o7tg0003tQEDBtgKK6xgEyZMMFUF6hctVSLpzc9DDz1EBURgsiYVt0pryy23tH/84x+29NJL21dffeV+iVZloOLII4+0gw46KLDsSacYgeeee84OOOCA3JcxAMN9VubOnWtrrrmm6c3PwIED7a9//WvRZFVZ3bp163AXk9HM9PNOuk2dOtU6duxoRx11lKv6a9WqlasGvPDCC11lddeuXe3xxx+39u3bZ5RUmMvW750//fRTvcm98cYbduCBB7oPqPVz8rjjjgtzMRnOSlVjJ598siOgD5yPOOII6969u33zzTd200032SOPPOK+pkpA/e5KhEVA5t+DDz7oklpjjTXc752q3Jw0aZLdddddbneYAhMwLN3IZn4CGIA8FRAoQUC/TKk6TEaR/pwEBmD4j863335rm2yyiakKsG/fvu5NTmG8++67tscee7hr9txzT1NVEhEGgfHjx9tmm23mtNGb14suumi+xGT6Pfvss9ahQwd78cUX+dQ8DOnqzUJb8PX9OHHixNx1GIDhCjd69GjbdtttXYKPPvqorbTSSuEmS2Z1Ejj66KOddm3btnVbD3//+9/Xuk4fcMo8UuhnoH4WEvEQ0DZSbR2VkSRjSRrL3CXCItCnTx+39V6voarQbNOmTa0EjznmmJwJqN9rllpqqbAWkOFs3nrrLdt9990dAVVpXnfdde4oofy4/vrr3e+p+nftOlp++eUzTIylh0wAAzBkdcjNO4GXXnrJVK6vN0AK/dL8/vvvuz9jAHqXp2QCd9xxh6tYUdT3y5TMB53poV+2dB0RBoF8/R577DFbccUV50tM1Sr6FFZx3333zffGNoyVkEU+gYMPPthVHe24445OMwUGYLjPiM4e0xZEmUcjR47kfKpwpaozMxntG220kamSU5V/idFXeLEqrGVOyEg6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AQhAAAIQgAAEIAABCEAAAhBoxgQwAJuxuCwNAhCAAAQgAAEIQAACEIAABCAAAQhAAAIYgDwDEIAABCAAAQhAAAIQgAAEIAABCEAAAhBoxgQwAJuxuCwNAhCAAAQgAAEIQAACEIAABCAAAQhAAAIYgDwDEIAABCAAAQhAAAIQgAAEIAABCEAAAhBoxgQwAJuxuCwNAhCAAAQgAAEIQAACEIAABCAAAQhAAAIYgDwDEIAABCAAAQhAAAIQCIDAnDlzbIEFFgggE1KAAAQgAAEIQKC5EcAAbG6Ksh4IQAACEIBARATuuusuO+2003IZn3/++bb99ts3aAXz5s2z3r172+TJk3PX9+zZ0+69994G3a+Lzj77bLv11ltz1z/zzDO29NJLu78ff/zxdv/997s/r7POOnbbbbc1eNzmeqGYv/XWW/bss8/ae++9Zx9//LFNmzbNfvrpJ2vfvr0tscQStsoqq9iGG25oG2+8sbVt27a5orC99trLRowY4da3ww472HnnnTffWldeeeXcv5177rm244471sljxowZdvnll9vCCy9sBx98cLNlxsIgAAEIQAACEPBHAAPQH3tmhgAEIAABCGSewOeff259+vTJcdhtt91s4MCBDeIyatQo23nnnWtd26JFC3v55Zetc+fODRpDxs0HH3zgrl1uueXsqaeeyt2HAfj/CGX8Pfjgg3b99dfbuHHjGsS2Xbt21r9/f9t3332dsdXcIi0DcNiwYXbmmWfaN998Y4ceeqgddthhzQ0V64EABCAAAQhAIAACGIABiEAKEIAABCAAgSwT2GSTTeyrr75yCHr06GEPP/xwg3BcffXVdtlll8137b///W/bdtttS44xffp0V9k3d+5cd22/fv1qVSNiAP6KcPz48Xbsscfmqt3ywcpwlbm30EIL2dSpU23mzJnzcV9sscVcpeWf//znkprEdEFaBmD+848BGNMTQK4QgAAEIACBuAhgAMalF9lCAAIQgAAEmh2Bk046ye655x63LhlK2lbZsWPHkuuUYTdy5Eh33aKLLmoTJ050f5b5JxOwVDz//PO2//775y676qqrbLPNNsv9HQPQ7KOPPnIVfN9++22Oi8y+XXfd1TbddFNbc801rXXr1rmvqaJT24OHDBlin376ae7fW7ZsaaeccoozWZtLYAA2FyVZBwQgAAEIQCAbBDAAs6Ezq4QABCAAAQgES+DRRx+1o48+OpeftpmWqhbTuXPrrbee/fzzz+6+4447znR+oKJLly42fPhwZybWFxdeeKHdcMMN7pJWrVrZa6+95s6xI34lIENVW6xVAZiEtmufeuqp1rVr13oxSZebb77ZLr30Unc+YBIXX3yxbbPNNs0CcUMMwIYslArAhlDiGghAAAIQgAAEmkoAA7CpBLkfAhCAAAQgAIEmEZg0aZJtsMEGpnPmFAceeKAdddRR9Y755JNP2uGHH+6u6d69uw0ePNg22mij3D1qBKKGIPXF7rvv7hpaKFTJpqo14v8JqPLvpZdeyv3DP/7xD7cVuJSxms9Q96upxezZs90/q3rwoYcesmWXXTZ61BiA0UvIAiAAAQhAAAKZIoABmCm5WSwEIAABCEAgTALatjt69GiXXEM67p588sl29913u+tlxOjvffv2tTFjxrh/O/LII+2ggw4quthZs2bZWmutlatOU+MFnb9G/Erg6aefrsXjL3/5i11zzTWNMv8SltrerW3eSWisa6+9NnrUGIDRS8gCIAABCEAAApkigAGYKblZLAQgAAEIQCBMAueee67bMqpQldgbb7zhtuUWi4033ji3NfW6664z/f28886zm266yd3Sq1cvu/POO4ve/8orr9jee++d+/rQoUNtjTXWqHV9qTMAv/zyS3cOnkJnEGrbseLrr7+2++67z/773/+6HLVdWV2JV1llFdt8883dGYX55+aVUkQNUlQ19+KLL9oXX3xh33//vanDbrdu3ZxZuvXWW7sKxjRjp512svfeey+nh871a2hn5bryyDfL9HV1FBaPwlh55ZVz/6RnYscddyy5rMbe8+6779pzzz1nr7/+ums+M2XKFJszZ447d1Lbx//4xz+650lGZX3Vjg0xAIvlpufjhBNOKLk2meJ6pvVsJ6HnWs93Q+Lvf/+7vfrqq+7SLbbYwi6//PKG3MY1EIAABCAAAQg0QwIYgM1QVJYEAQhAAAIQiI1AYUMOVfetvvrqdS5j7NixuXPkZKSpaUjbtm2dQTZgwAB3j8xDGR8dOnSoc4wrrrjCrrzySvc1GT+6tqampta15RiAd9xxh2tA8uOPPxaVYIUVVjDNr63L9YXOzrvkkkvstttucwZVfSGz6qyzznJGZFNj1KhR7uy/JPbYYw87/fTTmzRsoeFabMzGmnlKqqH3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" width="640">
</div>
</div>
</section>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">Data preparation</h3>
<p><em>By Amy Wang</em></p>
<p>The following data preparation steps helped us to prepare our data for implementing various modeling / validation techniques:</p>
<ol type="1">
<li>Turn <code>type</code> into dummy variables to make all our variables numerical.</li>
<li>Scale the predictors so that regression models treat each predictor with equal weight.</li>
<li>Split the data into test (20%) and train (80%) datasets</li>
</ol>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">######---------------Turn the type predictor into dummy variables----------------#########</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> all_df.drop(<span class="st">"quality"</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> all_df.quality</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>X_dummy <span class="op">=</span> pd.get_dummies(X)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>X_dummy.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>type_red</th>
      <th>type_white</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.4</td>
      <td>0.70</td>
      <td>0.00</td>
      <td>1.9</td>
      <td>0.076</td>
      <td>11.0</td>
      <td>34.0</td>
      <td>0.9978</td>
      <td>3.51</td>
      <td>0.56</td>
      <td>9.4</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.8</td>
      <td>0.88</td>
      <td>0.00</td>
      <td>2.6</td>
      <td>0.098</td>
      <td>25.0</td>
      <td>67.0</td>
      <td>0.9968</td>
      <td>3.20</td>
      <td>0.68</td>
      <td>9.8</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.8</td>
      <td>0.76</td>
      <td>0.04</td>
      <td>2.3</td>
      <td>0.092</td>
      <td>15.0</td>
      <td>54.0</td>
      <td>0.9970</td>
      <td>3.26</td>
      <td>0.65</td>
      <td>9.8</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11.2</td>
      <td>0.28</td>
      <td>0.56</td>
      <td>1.9</td>
      <td>0.075</td>
      <td>17.0</td>
      <td>60.0</td>
      <td>0.9980</td>
      <td>3.16</td>
      <td>0.58</td>
      <td>9.8</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.4</td>
      <td>0.70</td>
      <td>0.00</td>
      <td>1.9</td>
      <td>0.076</td>
      <td>11.0</td>
      <td>34.0</td>
      <td>0.9978</td>
      <td>3.51</td>
      <td>0.56</td>
      <td>9.4</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">######---------------Scaling the predictors----------------#########</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>X_dummy_sca <span class="op">=</span> pd.DataFrame(scaler.fit_transform(X_dummy), columns <span class="op">=</span> X_dummy.columns)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>X_dummy_sca.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>type_red</th>
      <th>type_white</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.297521</td>
      <td>0.413333</td>
      <td>0.000000</td>
      <td>0.019939</td>
      <td>0.111296</td>
      <td>0.034722</td>
      <td>0.064516</td>
      <td>0.206092</td>
      <td>0.612403</td>
      <td>0.191011</td>
      <td>0.202899</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.330579</td>
      <td>0.533333</td>
      <td>0.000000</td>
      <td>0.030675</td>
      <td>0.147841</td>
      <td>0.083333</td>
      <td>0.140553</td>
      <td>0.186813</td>
      <td>0.372093</td>
      <td>0.258427</td>
      <td>0.260870</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.330579</td>
      <td>0.453333</td>
      <td>0.024096</td>
      <td>0.026074</td>
      <td>0.137874</td>
      <td>0.048611</td>
      <td>0.110599</td>
      <td>0.190669</td>
      <td>0.418605</td>
      <td>0.241573</td>
      <td>0.260870</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.611570</td>
      <td>0.133333</td>
      <td>0.337349</td>
      <td>0.019939</td>
      <td>0.109635</td>
      <td>0.055556</td>
      <td>0.124424</td>
      <td>0.209948</td>
      <td>0.341085</td>
      <td>0.202247</td>
      <td>0.260870</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.297521</td>
      <td>0.413333</td>
      <td>0.000000</td>
      <td>0.019939</td>
      <td>0.111296</td>
      <td>0.034722</td>
      <td>0.064516</td>
      <td>0.206092</td>
      <td>0.612403</td>
      <td>0.191011</td>
      <td>0.202899</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Quantile-Quantile (Q-Q) plots for all predictors</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">0</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>fig2 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">1</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>fig3 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">2</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>fig4 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">3</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>fig5 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">4</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>fig6 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">5</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>fig7 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">6</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>fig8 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">7</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>fig9 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">8</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>fig10 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">9</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>fig11 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">10</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>fig12 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">11</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>fig13 <span class="op">=</span> sm.qqplot(X_dummy.iloc[:,<span class="dv">12</span>], line<span class="op">=</span><span class="st">'45'</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-7.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-8.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-9.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-10.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-11.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-12.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-9-output-13.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">######-----Splitting the data into test and train datasets-------#########</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_dummy_sca, y, test_size <span class="op">=</span> <span class="fl">0.2</span>, random_state <span class="op">=</span> <span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory data analysis</h2>
<p><em>By Kaitlyn Hung</em></p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlations of predictors with response variable</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>all_df.corrwith(all_df.quality).sort_values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>density                -0.305858
volatile acidity       -0.265699
chlorides              -0.200666
fixed acidity          -0.076743
total sulfur dioxide   -0.041385
residual sugar         -0.036980
pH                      0.019506
sulphates               0.038485
free sulfur dioxide     0.055463
citric acid             0.085532
alcohol                 0.444319
quality                 1.000000
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="15">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairplot of predictors and response to search for interesting trends and variable relationships</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sns.pairplot(data <span class="op">=</span> all_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x7ffbe100ddf0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining function to make exploratory plots</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_dist(var):</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># histogram to visualize distribution and barplot to visualize relationship to response</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    sns.histplot(x <span class="op">=</span> var, data <span class="op">=</span> all_df, ax <span class="op">=</span> axes[<span class="dv">0</span>])</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    sns.barplot(x <span class="op">=</span> <span class="st">"quality"</span>, y <span class="op">=</span> var, data <span class="op">=</span> all_df, ax <span class="op">=</span> axes[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear trend that lower volatile acidity values have better quality </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"volatile acidity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear relationship with response: higher alcohol content is related to improved quality </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"alcohol"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="20">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># higher citric acid content appears to relate to higher quality </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"citric acid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lower chloride content appears to relate to improved quality </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"chlorides"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No clear relationship between density and quality </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No clear relationship between pH and qualtiy </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"pH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="23">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No clear relationship between fixed acidity and quality </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"fixed acidity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No clear relationship between total SO2 and quality. </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#The distribution of total SO2 is bimodal with peaks around 25 and 125 units.</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"total sulfur dioxide"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="25">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No clear relationship between sulphates and quality </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"sulphates"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="26">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No clear relationship between residual sugar and quality</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The distribution of residual sugar appears to be skewed</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"residual sugar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No clear relationship between free SO2 and quality </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plot_dist(<span class="st">"free sulfur dioxide"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="developing-the-model-hyperparameter-tuning" class="level2">
<h2 class="anchored" data-anchor-id="developing-the-model-hyperparameter-tuning">Developing the model: Hyperparameter tuning</h2>
<p>Put code with comments. The comments should explain the code such that it can be easily understood. You may put text <em>(in a markdown cell)</em> before a large chunk of code to explain the overall purpose of the code, if it is not intuitive. <strong>Put the name of the person / persons who contributed to each code chunk / set of code chunks.</strong></p>
<p>Put each model in a section of its name and mention the name of the team-member tuning the model. Below is an example:</p>
<section id="intercept-base-model" class="level3">
<h3 class="anchored" data-anchor-id="intercept-base-model">Intercept Base Model</h3>
<p><em>By Anastasia Wei</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predicting the response as the mean of the train response </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> [np.around(np.mean(y_train))]<span class="op">*</span><span class="bu">len</span>(y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="429becfc-bdd5-4bac-bee7-dfdc2ac98a9d">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test RMSE</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>np.sqrt(mean_squared_error(y_test, pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>0.9327379053088815</code></pre>
</div>
</div>
</section>
<section id="ridge-and-lasso-regression" class="level3">
<h3 class="anchored" data-anchor-id="ridge-and-lasso-regression">Ridge and Lasso Regression</h3>
<p><em>By Anastasia Wei</em></p>
<div class="cell" data-outputid="50472ebe-aaf4-4607-f37b-163ba855dd17">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Ridge Regression</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># defining regulization parameter space</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> <span class="dv">10</span><span class="op">**</span>np.linspace(<span class="fl">1.5</span>,<span class="op">-</span><span class="dv">3</span>,<span class="dv">200</span>)<span class="op">*</span><span class="fl">0.5</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>ridgecv <span class="op">=</span> RidgeCV(alphas <span class="op">=</span> alphas, scoring <span class="op">=</span> <span class="st">'neg_mean_squared_error'</span>, store_cv_values <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ridgecv.fit(X_train, y_train)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal alpha = "</span>, ridgecv.alpha_)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># using the developed ridge regression model to predict on test &amp; train data</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>ridge <span class="op">=</span> Ridge(alpha <span class="op">=</span> ridgecv.alpha_)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>ridge.fit(X_train, y_train)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> ridge.predict(X_test)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train RMSE = '</span>, np.sqrt(mean_squared_error(y_train, np.around(ridge.predict(X_train)))))</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test RMSE = '</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal alpha =  0.01636987568069109
Train RMSE =  0.7892143827427598
Test RMSE =  0.8166535844059444</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Lasso Regression</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Searching through regularizatio parameter space </span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> <span class="dv">10</span><span class="op">**</span>np.linspace(<span class="dv">2</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">200</span>)<span class="op">*</span><span class="fl">0.5</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>rmses <span class="op">=</span> []</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> a <span class="kw">in</span> alphas:</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    lasso <span class="op">=</span> Lasso(alpha <span class="op">=</span> a)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    lasso.fit(X_train, y_train)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> lasso.predict(X_train)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    rmse <span class="op">=</span> np.sqrt(mean_squared_error(y_train, np.around(pred)))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    rmses.append(rmse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="335d2b35-58d3-4b60-8c3f-c3fe9efece7e" data-execution_count="17">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing rmse vs alpha</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(alphas, rmses, s <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'RMSE'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'alpha'</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'log'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-29-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="29ef239b-5c25-4938-a1d2-0bcadec230ca" data-execution_count="18">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Optimal alpha ='</span>, alphas[np.array(rmses).argmin()])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Optimal train RMSE = '</span>, rmses[np.array(rmses).argmin()])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal alpha = 0.0004301732208342255
Optimal train RMSE =  0.7806343783815696</code></pre>
</div>
</div>
<div class="cell" data-outputid="dbce494f-eaf0-4e9b-faff-20e27cbb7775" data-execution_count="21">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso(alpha <span class="op">=</span> <span class="fl">0.0004301732208342255</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lasso.fit(X_train, y_train).predict(X_test)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test RMSE = '</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test RMSE =  0.8138228875545909</code></pre>
</div>
</div>
</section>
<section id="mars" class="level3">
<h3 class="anchored" data-anchor-id="mars">MARS</h3>
<p><em>By Lila Wells</em></p>
<p>Beginning with the original coarse grid search (optimizing <code>max_depth</code> and <code>max_degree</code> simultaneously in a nested for loop)</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coarse grid search for hyperparameter optimization</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note: I fit 25 models here and it took approximately an hour and a half (90 mins)</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(action<span class="op">=</span><span class="st">'ignore'</span>, category <span class="op">=</span> <span class="pp">FutureWarning</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>init_search_df <span class="op">=</span> pd.DataFrame(columns <span class="op">=</span> [<span class="st">'degree'</span>, <span class="st">'max_terms'</span>, <span class="st">'rmse'</span>])</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Lists to store the values for plotting</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>degrees <span class="op">=</span> []</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>max_terms_values <span class="op">=</span> []</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>mean_scores <span class="op">=</span> []</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Initializing optimal parameters &amp; best score variables</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>opt_degree <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>opt_max_terms <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> <span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Outer loop for degree</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> degree <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>, <span class="dv">2</span>):</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print('Fitting models for degree = ', degree)</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Creating a MARS model with the current degree and max_terms</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Earth(max_terms <span class="op">=</span> <span class="dv">500</span>, max_degree <span class="op">=</span> degree)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Inner loop for max_terms</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> terms <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">400</span>, <span class="dv">1201</span>, <span class="dv">200</span>):</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('     Fitting models for degree = ', degree, 'and max_terms = ', terms)</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Setting the current max_terms</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>        model.max_terms <span class="op">=</span> terms</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 5-fold cross validation</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>        scores <span class="op">=</span> cross_val_score(model,</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>                                 X_train,</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>                                 y_train, </span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>                                 cv <span class="op">=</span> <span class="dv">5</span>, </span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>                                 scoring <span class="op">=</span> <span class="st">'neg_root_mean_squared_error'</span>)</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Computing mean score</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>        mean_score <span class="op">=</span> scores.mean()</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Saving the values for plotting</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>        degrees.append(degree)</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>        max_terms_values.append(terms)</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>        mean_scores.append(mean_score)</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Checking if mean score is better than the current best score</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mean_score <span class="op">&gt;</span> best_score:</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>            best_score <span class="op">=</span> mean_score</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>            opt_degree <span class="op">=</span> degree</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>            opt_max_terms <span class="op">=</span> terms</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the optimal hyperparameters</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Optimal max_terms in coarse grid search = '</span>, opt_max_terms)</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Optimal max_degree in coarse grid search = '</span>, opt_degree)    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal max_terms in coarse grid search =  400
Optimal max_degree in coarse grid search =  5</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Defining the initial MARS model and making predictions on test data to compute RMSE</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the MARS model</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>mars_init <span class="op">=</span> Earth(max_terms <span class="op">=</span> <span class="dv">400</span>, max_degree <span class="op">=</span> <span class="dv">5</span>).fit(X_train, y_train)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Making predictions &amp; rounding them to the nearest integer </span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>pred_mars_init <span class="op">=</span> np.around(mars_init.predict(X_test))</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the coarse grid RMSE </span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coarse Grid Tuning MARS Model Test RMSE:"</span>, np.sqrt(mean_squared_error(y_test, pred_mars_init)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coarse Grid Tuning MARS Model Test RMSE: 1.5657389506359167</code></pre>
</div>
</div>
<p>Attempting to further optimize the MARS model with a finer grid search over a narrower range of hyperparameters (4-7 for <code>max_degree</code> and 300-800 for <code>max_terms</code>).</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finer grid search</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(action<span class="op">=</span><span class="st">'ignore'</span>, category <span class="op">=</span> <span class="pp">FutureWarning</span>) <span class="co"># Got 7 and 800</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initializing optimal parameters &amp; best score variables</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>opt_degree <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>opt_max_terms <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> <span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Outer loop for degree</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> degree <span class="kw">in</span> [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>]: </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print('Fitting models for degree = ', degree)</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Creating a MARS model with the current degree and max_terms</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Earth(max_terms <span class="op">=</span> <span class="dv">500</span>, max_degree <span class="op">=</span> degree)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Inner loop for max_terms</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> terms <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">300</span>, <span class="dv">801</span>, <span class="dv">100</span>): </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('     Fitting models for degree = ', degree, 'and max_terms = ', terms)</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Setting the current max_terms</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>        model.max_terms <span class="op">=</span> terms</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 5-fold cross validation</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        scores <span class="op">=</span> cross_val_score(model,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>                                 X_train,</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>                                 y_train, </span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>                                 cv <span class="op">=</span> <span class="dv">5</span>, </span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>                                 scoring <span class="op">=</span> <span class="st">'neg_root_mean_squared_error'</span>)</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Computing mean score</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>        mean_score <span class="op">=</span> scores.mean()</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Checking if mean score is better than the current best score</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mean_score <span class="op">&gt;</span> best_score:</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>            best_score <span class="op">=</span> mean_score</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>            opt_degree <span class="op">=</span> degree</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>            opt_max_terms <span class="op">=</span> terms</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal degree in fine grid search = "</span>, degree)</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal max_terms in fine grid search = "</span>, terms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal degree in fine grid search =  7
Optimal max_terms in fine grid search =  800</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Defining the final MARS model and making predictions on test data to compute RMSE</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the MARS model</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>mars_final <span class="op">=</span> Earth(max_terms <span class="op">=</span> <span class="dv">800</span>, max_degree <span class="op">=</span> <span class="dv">7</span>).fit(X_train, y_train)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Making predictions &amp; rounding them to the nearest integer </span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>pred_mars_final <span class="op">=</span> np.around(mars_final.predict(X_test))</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the coarse grid RMSE </span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fine Grid Tuning MARS Model Test RMSE:"</span>, np.sqrt(mean_squared_error(y_test, pred_mars_final)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fine Grid Tuning MARS Model Test RMSE: 0.790326125479466</code></pre>
</div>
</div>
<p>The next step here was to predict the model’s train data residuals, and build a model to predict those residuals (in an effort to improve the MARS model).</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making predictions with the optimized MARS model </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>prediction_mars <span class="op">=</span> np.around(mars_final.predict(X_train)) <span class="co"># Rounding them to the nearest integer </span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the predictions to a dataframe </span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>prediction_mars <span class="op">=</span> pd.Series(prediction_mars, name<span class="op">=</span><span class="st">'quality'</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>prediction_mars <span class="op">=</span> prediction_mars.to_frame().rename(columns<span class="op">=</span>{<span class="st">'quality'</span>: <span class="st">'quality'</span>})</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate residuals</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>residuals <span class="op">=</span> y_train <span class="op">-</span> prediction_mars</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting residuals </span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([prediction_mars, residuals], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>df.columns <span class="op">=</span> [<span class="st">'quality'</span>, <span class="st">'residuals'</span>]</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Jittering the points</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>jitter_amount <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'jittered_residuals'</span>] <span class="op">=</span> df[<span class="st">'residuals'</span>] <span class="op">+</span> np.random.uniform(low<span class="op">=-</span>jitter_amount, high<span class="op">=</span>jitter_amount, size<span class="op">=</span><span class="bu">len</span>(df))</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the points</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>residual_mars_plt <span class="op">=</span> df.plot(x<span class="op">=</span><span class="st">'quality'</span>, y<span class="op">=</span><span class="st">'jittered_residuals'</span>, kind<span class="op">=</span><span class="st">'scatter'</span>)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>residual_mars_plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)  <span class="co"># Add line y = 0</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>residual_mars_plt.set_xlabel(<span class="st">'Predicted Quality Values'</span>)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>residual_mars_plt.set_ylabel(<span class="st">'Residuals'</span>)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>residual_mars_plt.set_title(<span class="st">'Residual Plot'</span>)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>residual_mars_plt.set_xlim([<span class="dv">0</span>, <span class="dv">10</span>])</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>residual_mars_plt.set_ylim([<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>])</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>residual_mars_plt.set_yticks([<span class="op">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-36-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now creating a model to predict residuals of the MARS model.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a MARS model to predict residuals</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>residual_model <span class="op">=</span> Earth()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>residual_model.fit(prediction_mars, residuals)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on test set</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>residuals_pred <span class="op">=</span> residual_model.predict(pred_mars_final) <span class="co"># These predictions are the MARS test predictions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Adding the residual predictions to the test</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making predictions with the residuals model</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rounding predictions to the nearest integer </span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>residuals_pred <span class="op">=</span> np.around(residual_model.predict(pred_mars_final))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>residuals_pred_series <span class="op">=</span> pd.Series(residuals_pred, name<span class="op">=</span><span class="st">'quality'</span>) <span class="co"># Making residuals into a series</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>pred_mars_final <span class="op">=</span> pd.Series(pred_mars_final, name<span class="op">=</span><span class="st">'quality'</span>) <span class="co"># Turning the test predictions into a Series</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predicted residuals to y_pred to get final predictions</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>y_pred_final <span class="op">=</span> pd.concat([pred_mars_final, residuals_pred_series], axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the final MARS model RMSE </span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test RMSE of Fine Grid MARS Model &amp; Residuals Model:"</span>, np.sqrt(mean_squared_error(y_test, y_pred_final)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test RMSE of Fine Grid MARS Model &amp; Residuals Model: 0.7775701798650618</code></pre>
</div>
</div>
</section>
<section id="decision-tree" class="level3">
<h3 class="anchored" data-anchor-id="decision-tree">Decision Tree</h3>
<p><em>By Kaitlyn Hung</em></p>
<p>Getting a sense of the base RMSE for a tree model and deciding hyperparameter value ranges to consider for tuning.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Developing model</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>tree_model <span class="op">=</span> DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">45</span>) </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>tree_model.fit(X_train, y_train)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> tree_model.predict(X_test)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RMSE: "</span>, np.sqrt(mean_squared_error(y_test, y_pred)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE:  0.8507914867029135</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>tree_model.get_depth()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>27</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>tree_model.get_n_leaves()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>1469</code></pre>
</div>
</div>
<p>Used the depth and number of leaves as the max hyperparameter values for a coarse grid search</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>coarse_grid <span class="op">=</span> {    </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: np.arange(<span class="dv">2</span>,<span class="dv">27</span>, <span class="dv">5</span>),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_leaf_nodes'</span>: np.arange(<span class="dv">100</span>, <span class="dv">1500</span>, <span class="dv">250</span>),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min_samples_leaf'</span>: np.arange(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">2</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">45</span>), coarse_grid, scoring<span class="op">=</span><span class="st">"neg_mean_squared_error"</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train, y_train)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best MSE Through Grid Search : </span><span class="sc">%.3f</span><span class="st">'</span><span class="op">%</span>grid_search.best_score_)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(grid_search.best_params_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 5 folds for each of 150 candidates, totalling 750 fits
Best MSE Through Grid Search : -0.531
{'max_depth': 7, 'max_leaf_nodes': 100, 'min_samples_leaf': 9}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting results</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(grid_search.cv_results_)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">5</span>))</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_max_depth, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Depth'</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold MSE'</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_max_leaf_nodes, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Leaves'</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold MSE'</span>)<span class="op">;</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_min_samples_leaf, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'min samples'</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold MSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-43-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Using the optimal values and visualizations to adjust the ranges of values considered for a fine grid search.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fine_grid <span class="op">=</span> {    </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: <span class="bu">range</span>(<span class="dv">3</span>,<span class="dv">12</span>),</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_leaf_nodes'</span>: np.arange(<span class="dv">2</span>, <span class="dv">127</span>, <span class="dv">25</span>),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min_samples_leaf'</span>: [<span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>]</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">45</span>), fine_grid, scoring<span class="op">=</span><span class="st">"neg_mean_squared_error"</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train, y_train)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best MSE Through Grid Search : </span><span class="sc">%.3f</span><span class="st">'</span><span class="op">%</span>grid_search.best_score_)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(grid_search.best_params_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 5 folds for each of 135 candidates, totalling 675 fits
Best MSE Through Grid Search : -0.522
{'max_depth': 6, 'max_leaf_nodes': 52, 'min_samples_leaf': 8}</code></pre>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="34">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting results</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(grid_search.cv_results_)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">5</span>))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_max_depth, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Depth'</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold MSE'</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_max_leaf_nodes, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Leaves'</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold MSE'</span>)<span class="op">;</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_min_samples_leaf, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'min samples'</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold MSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-45-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Tree model with optimal hyperparameter values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>tree_model <span class="op">=</span> DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">45</span>, max_leaf_nodes <span class="op">=</span> <span class="dv">52</span>, max_depth <span class="op">=</span> <span class="dv">6</span>, min_samples_leaf <span class="op">=</span> <span class="dv">8</span>) .fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to round predictions to nearest integer</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> round_half_up(n, decimals<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    multiplier <span class="op">=</span> <span class="dv">10</span> <span class="op">**</span> decimals</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> math.floor(n<span class="op">*</span>multiplier <span class="op">+</span> <span class="fl">0.5</span>) <span class="op">/</span> multiplier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making predictions then rounding to nearest integer</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>raw_test_pred <span class="op">=</span> tree_model.predict(X_test)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>test_pred <span class="op">=</span> np.array([round_half_up(xi) <span class="cf">for</span> xi <span class="kw">in</span> raw_test_pred])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test RMSE for decision tree model </span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Decision Tree Test RMSE:"</span>, np.sqrt(mean_squared_error(y_test, test_pred)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Decision Tree Test RMSE: 0.8507914867029135</code></pre>
</div>
</div>
</section>
<section id="bagging-decision-tree" class="level3">
<h3 class="anchored" data-anchor-id="bagging-decision-tree">Bagging Decision Tree</h3>
<p><em>By Lila Wells</em></p>
<p>First, identifying the optimal number of trees to use by visualizing the number of trees vs.&nbsp;R-squared</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding model accuracy vs number of trees</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>oob_rsquared <span class="op">=</span> {}<span class="op">;</span> test_rsquared <span class="op">=</span> {}<span class="op">;</span> oob_rmse <span class="op">=</span> {}<span class="op">;</span> test_rmse <span class="op">=</span> {}</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterating over tree values </span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>, <span class="dv">1201</span>, <span class="dv">50</span>):</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> BaggingRegressor(base_estimator <span class="op">=</span> DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>), </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                             n_estimators <span class="op">=</span> i, </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                             random_state <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                             n_jobs<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>                             oob_score <span class="op">=</span> <span class="va">True</span>).fit(X_train, y_train)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    oob_rsquared[i] <span class="op">=</span> model.oob_score_  <span class="co"># Returns the out-of_bag R-squared of the model</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    test_rsquared[i] <span class="op">=</span> model.score(X_test, y_test) <span class="co"># Returns the test R-squared of the model</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    oob_rmse[i] <span class="op">=</span> np.sqrt(mean_squared_error(model.oob_prediction_, y_train))</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    test_rmse[i] <span class="op">=</span> np.sqrt(mean_squared_error(model.predict(X_test), y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting results</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">5</span>))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(oob_rsquared.keys(),oob_rsquared.values(),label <span class="op">=</span> <span class="st">'Out of bag R-squared'</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(oob_rsquared.keys(),oob_rsquared.values(),<span class="st">'o'</span>,color <span class="op">=</span> <span class="st">'blue'</span>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(test_rsquared.keys(),test_rsquared.values(), label <span class="op">=</span> <span class="st">'Test data R-squared'</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Number of Trees vs. R-Squared'</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Number of trees'</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Rsquared'</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(oob_rmse.keys(),oob_rmse.values(),label <span class="op">=</span> <span class="st">'Out of bag RMSE'</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(oob_rmse.keys(),oob_rmse.values(),<span class="st">'o'</span>,color <span class="op">=</span> <span class="st">'blue'</span>)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(test_rmse.keys(),test_rmse.values(), label <span class="op">=</span> <span class="st">'Test data RMSE'</span>)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Number of Trees vs. RMSE'</span>)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Number of trees'</span>)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'RMSE'</span>)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>&lt;matplotlib.legend.Legend at 0x12e8658e0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-51-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>From this, it looks like any number of trees past 500 seems to stabilize the test RMSE.</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(action<span class="op">=</span><span class="st">'ignore'</span>, category <span class="op">=</span> <span class="pp">FutureWarning</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimizing hyperparameters</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> X_train.shape[<span class="dv">0</span>]</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>n_features <span class="op">=</span> X_train.shape[<span class="dv">1</span>]</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'estimator'</span>: [DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>),</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                        DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>, max_depth <span class="op">=</span> <span class="dv">6</span>),</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                        DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>, max_depth <span class="op">=</span> <span class="dv">10</span>)],</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">'n_estimators'</span>: <span class="bu">range</span>(<span class="dv">500</span>, <span class="dv">1001</span>, <span class="dv">100</span>),</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_samples'</span>: [<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.0</span>],</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_features'</span>: [<span class="fl">0.5</span>, <span class="fl">1.0</span>],</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">'bootstrap'</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">'bootstrap_features'</span>: [<span class="va">True</span>, <span class="va">False</span>]}</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 2-fold cross validation to minimize runtime</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits <span class="op">=</span> <span class="dv">2</span>, shuffle <span class="op">=</span> <span class="va">True</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>bagging_grid <span class="op">=</span> GridSearchCV(BaggingRegressor(random_state <span class="op">=</span> <span class="dv">1</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>                            param_grid <span class="op">=</span> params,</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>                            cv <span class="op">=</span> cv, </span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>                            scoring <span class="op">=</span> <span class="st">"neg_root_mean_squared_error"</span>,</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>                            n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>                            verbose <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>bagging_grid.fit(X_train, y_train.values.ravel())</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best Score Through Grid Search : </span><span class="sc">%.3f</span><span class="st">'</span><span class="op">%</span>bagging_grid.best_score_)</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best Parameters : '</span>, bagging_grid.best_params_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 2 folds for each of 144 candidates, totalling 288 fits
Best R^2 Score Through Grid Search : -0.639
Best Parameters :  {'bootstrap': False, 'bootstrap_features': True, 'estimator': DecisionTreeRegressor(random_state=1), 'max_features': 1.0, 'max_samples': 0.75, 'n_estimators': 1000}</code></pre>
</div>
</div>
<p>Visualizing the results of the hyperparameter search</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting results</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(bagging_grid.cv_results_)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">5</span>))</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_n_estimators, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'N_Estimators'</span>)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>) </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_max_samples <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Max_Samples'</span>)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_max_features, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'Max_Features'</span>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-53-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Defining the initial base model.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the initial base model </span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>bagging_init <span class="op">=</span> BaggingRegressor(random_state <span class="op">=</span> <span class="dv">1</span>, </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                                 n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                                 estimator <span class="op">=</span> DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>),</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                                 n_estimators <span class="op">=</span> <span class="dv">900</span>, </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                                 max_samples <span class="op">=</span> <span class="fl">0.75</span>, </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                                 max_features <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                                 bootstrap_features <span class="op">=</span> <span class="va">True</span>, </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                                 bootstrap <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>bagging_init.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/lilawells/opt/anaconda3/lib/python3.9/site-packages/sklearn/ensemble/_bagging.py:508: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>BaggingRegressor(bootstrap=False, bootstrap_features=True,
                 estimator=DecisionTreeRegressor(random_state=1),
                 max_samples=0.75, n_estimators=900, n_jobs=-1, random_state=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">BaggingRegressor</label><div class="sk-toggleable__content"><pre>BaggingRegressor(bootstrap=False, bootstrap_features=True,
                 estimator=DecisionTreeRegressor(random_state=1),
                 max_samples=0.75, n_estimators=900, n_jobs=-1, random_state=1)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: DecisionTreeRegressor</label><div class="sk-toggleable__content"><pre>DecisionTreeRegressor(random_state=1)</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeRegressor</label><div class="sk-toggleable__content"><pre>DecisionTreeRegressor(random_state=1)</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<p>Then, making predictions on test data to identify the test RMSE of this bagging model (optimized via a coarse grid search of hyperparameters).</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making predictions</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>pred_init <span class="op">=</span> np.around(bagging_init.predict(X_test)) <span class="co"># Rounding predictions to the nearest integer </span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the test RMSE of the coarse grid tuning model</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coarse Grid Tuning Bagging Model Test RMSE:"</span>, np.sqrt(mean_squared_error(y_test, pred_init)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coarse Grid Tuning Bagging Model Test RMSE: 0.6673714223613529</code></pre>
</div>
</div>
<p>Now, implementing a finer grid search of hyperparameters in an attempt to lower the bagging model’s RMSE.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Finer grid search</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(action <span class="op">=</span> <span class="st">'ignore'</span>, category <span class="op">=</span> <span class="pp">FutureWarning</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimizing hyperparameters</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> X_train.shape[<span class="dv">0</span>]</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>n_features <span class="op">=</span> X_train.shape[<span class="dv">1</span>]</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'estimator'</span>: [DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>)],</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">'n_estimators'</span>: <span class="bu">range</span>(<span class="dv">800</span>, <span class="dv">1101</span>, <span class="dv">60</span>), <span class="co"># Narrowing this search space based on coarse grid results </span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_samples'</span>: [<span class="fl">0.6</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>], <span class="co"># Narrowing this search space based on coarse grid results</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_features'</span>: [<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.85</span>, <span class="fl">1.0</span>], <span class="co"># Lowering this search space based on coarse grid resutlss</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">'bootstrap'</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">'bootstrap_features'</span>: [<span class="va">True</span>, <span class="va">False</span>]}</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 2-fold cross validation to minimize runtime</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits <span class="op">=</span> <span class="dv">2</span>, shuffle <span class="op">=</span> <span class="va">True</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Using GridSearchCV here </span></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>bagging_grid <span class="op">=</span> GridSearchCV(BaggingRegressor(random_state <span class="op">=</span> <span class="dv">1</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>                            param_grid <span class="op">=</span> params,</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>                            cv <span class="op">=</span> cv, </span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>                            scoring <span class="op">=</span> <span class="st">"neg_mean_squared_error"</span>,</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>                            n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, </span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>                            verbose <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the bagging model </span></span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>bagging_grid.fit(X_train, y_train.values.ravel())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 2 folds for each of 288 candidates, totalling 576 fits
Best Score Through Grid Search : -0.407
Best Parameters :  {'bootstrap': False, 'bootstrap_features': False, 'estimator': DecisionTreeRegressor(random_state=1), 'max_features': 0.75, 'max_samples': 0.75, 'n_estimators': 1040}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the best score and parameters</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best Score Through Grid Search : </span><span class="sc">%.3f</span><span class="st">'</span><span class="op">%</span>bagging_grid.best_score_)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best Parameters : '</span>, bagging_grid.best_params_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Score Through Grid Search : -0.407
Best Parameters :  {'bootstrap': False, 'bootstrap_features': False, 'estimator': DecisionTreeRegressor(random_state=1), 'max_features': 0.75, 'max_samples': 0.75, 'n_estimators': 1040}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting results</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(bagging_grid.cv_results_)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">5</span>))</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_n_estimators, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'N_Estimators'</span>)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>) </span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_max_samples <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Max_Samples'</span>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_max_features, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'Max_Features'</span>)</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-58-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the optimized base model </span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>bagging_opt <span class="op">=</span> BaggingRegressor(random_state <span class="op">=</span> <span class="dv">1</span>, </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                                n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                                estimator <span class="op">=</span> DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                                n_estimators <span class="op">=</span> <span class="dv">1040</span>, </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                                max_samples <span class="op">=</span> <span class="fl">0.75</span>, </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>                                max_features <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>                                bootstrap_features <span class="op">=</span> <span class="va">False</span>, </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>                                bootstrap <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>bagging_opt.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>BaggingRegressor(bootstrap=False,
                 estimator=DecisionTreeRegressor(random_state=1),
                 max_features=0.75, max_samples=0.75, n_estimators=1040,
                 n_jobs=-1, random_state=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">BaggingRegressor</label><div class="sk-toggleable__content"><pre>BaggingRegressor(bootstrap=False,
                 estimator=DecisionTreeRegressor(random_state=1),
                 max_features=0.75, max_samples=0.75, n_estimators=1040,
                 n_jobs=-1, random_state=1)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox"><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: DecisionTreeRegressor</label><div class="sk-toggleable__content"><pre>DecisionTreeRegressor(random_state=1)</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox"><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeRegressor</label><div class="sk-toggleable__content"><pre>DecisionTreeRegressor(random_state=1)</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making predictions</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rounded_pred_opt <span class="op">=</span> np.around(bagging_opt.predict(X_test)) <span class="co"># Rounding predictions to the nearest integer </span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the test RMSE of the coarse grid tuning model</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fine Grid Tuning Bagging Model Test RMSE:"</span>, np.sqrt(mean_squared_error(y_test, rounded_pred_opt)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fine Grid Tuning Bagging Model Test RMSE: 0.665640235470275</code></pre>
</div>
</div>
</section>
<section id="random-forest" class="level3">
<h3 class="anchored" data-anchor-id="random-forest">Random Forest</h3>
<p><em>By Amy Wang</em></p>
<p>Initial tuning of <code>max_features</code>, followed by manual experimentation with <code>n_estimators</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'max_features'</span>: <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">14</span>, <span class="dv">1</span>)}</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>rfr_grid <span class="op">=</span> GridSearchCV(RandomForestRegressor(random_state <span class="op">=</span> <span class="dv">1</span>), </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                                                params, </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                                                n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>                                                scoring <span class="op">=</span> <span class="st">"neg_root_mean_squared_error"</span>, </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>                                                verbose <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>rfr_grid.fit(X_train, y_train.quality)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>rfr_grid.best_params_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 5 folds for each of 13 candidates, totalling 65 fits</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>{'max_features': 3}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>cv_results_rf <span class="op">=</span> pd.DataFrame(rfr_grid.cv_results_)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>plt.plot(cv_results_rf.param_max_features, <span class="op">-</span>cv_results_rf.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Features'</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'K-fold RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0, 0.5, 'K-fold RMSE')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-62-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>rfr_model_coarse <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span> <span class="dv">900</span>, max_features <span class="op">=</span> <span class="dv">3</span>, random_state <span class="op">=</span> <span class="dv">1</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> mean_squared_error(y_train, rfr_model_coarse.predict(X_train).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> mean_squared_error(y_test, rfr_model_coarse.predict(X_test).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training RMSE: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(train_rmse))</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test RMSE: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(test_rmse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/_x/qn4xkmz55j1g75w_xy65m99m0000gn/T/ipykernel_45401/2845292778.py:1: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  rfr_model_coarse = RandomForestRegressor(n_estimators= 900, max_features = 3, random_state = 1, n_jobs = -1).fit(X_train, y_train)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Training RMSE: 0.19170803919425694
Test RMSE: 0.6725382459813659</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>rfr_model_coarse2 <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span> <span class="dv">4000</span>, max_features <span class="op">=</span> <span class="dv">3</span>, random_state <span class="op">=</span> <span class="dv">1</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> mean_squared_error(y_train, rfr_model_coarse2.predict(X_train).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> mean_squared_error(y_test, rfr_model_coarse2.predict(X_test).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training RMSE: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(train_rmse))</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test RMSE: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(test_rmse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/_x/qn4xkmz55j1g75w_xy65m99m0000gn/T/ipykernel_45401/3366225274.py:1: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  rfr_model_coarse2 = RandomForestRegressor(n_estimators= 4000, max_features = 3, random_state = 1, n_jobs = -1).fit(X_train, y_train)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Training RMSE: 0.18816227403499663
Test RMSE: 0.6592536572635639</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>rfr_model_coarse3 <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span> <span class="dv">6000</span>, max_features <span class="op">=</span> <span class="dv">3</span>, random_state <span class="op">=</span> <span class="dv">1</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> mean_squared_error(y_train, rfr_model_coarse3.predict(X_train).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> mean_squared_error(y_test, rfr_model_coarse3.predict(X_test).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training RMSE: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(train_rmse))</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test RMSE: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(test_rmse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/_x/qn4xkmz55j1g75w_xy65m99m0000gn/T/ipykernel_45401/2130680553.py:1: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  rfr_model_coarse3 = RandomForestRegressor(n_estimators= 6000, max_features = 3, random_state = 1, n_jobs = -1).fit(X_train, y_train)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Training RMSE: 0.18918213122865765
Test RMSE: 0.6604194471348085</code></pre>
</div>
</div>
<p>The best model has the parameters: {n_estimators = 4000, max_features = 3}. Holding these parameters constant, I tune max_depth and max_samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'n_estimators'</span>: [<span class="dv">4000</span>],</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_features'</span>: <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">14</span>, <span class="dv">2</span>),</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_depth'</span>: [<span class="dv">3</span>],</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_samples'</span>: <span class="bu">range</span>(<span class="dv">1</span>, X_train.shape[<span class="dv">0</span>], <span class="dv">500</span>)}</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>rfr_grid_broad <span class="op">=</span> RandomizedSearchCV(RandomForestRegressor(random_state <span class="op">=</span> <span class="dv">1</span>), </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>                                                params, </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>                                                n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, </span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>                                                scoring <span class="op">=</span> <span class="st">"neg_root_mean_squared_error"</span>, </span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>                                                verbose <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>rfr_grid_broad.fit(X_train, y_train.quality)</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>rfr_grid_broad.best_params_</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="co"># {'n_estimators': 4000, 'max_samples': 501, 'max_features': 9, 'max_depth': 3}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> mean_squared_error(y_train, rfr_grid_broad.predict(X_train).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> mean_squared_error(y_test, rfr_grid_broad.predict(X_test).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training RMSE: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(train_rmse))</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test RMSE: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(test_rmse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training RMSE: 0.7802645555206809
Test RMSE: 0.7975925314055079</code></pre>
</div>
</div>
<p>Since the RMSE got significantly worse with this strategy, I retune all four features simultaneously.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'n_estimators'</span>: <span class="bu">range</span>(<span class="dv">100</span>, <span class="dv">5000</span>, <span class="dv">100</span>),</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_features'</span>: <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">14</span>, <span class="dv">2</span>),</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_depth'</span>: <span class="bu">range</span>(<span class="dv">2</span>,<span class="dv">30</span>, <span class="dv">2</span>),</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">'max_samples'</span>: <span class="bu">range</span>(<span class="dv">1</span>, X_train.shape[<span class="dv">0</span>], <span class="dv">500</span>)}</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>rfr_grid_fine <span class="op">=</span> RandomizedSearchCV(RandomForestRegressor(random_state <span class="op">=</span> <span class="dv">1</span>), </span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>                                                params, </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>                                                n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>                                                scoring <span class="op">=</span> <span class="st">"neg_root_mean_squared_error"</span>, </span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>                                                verbose <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>rfr_grid_fine.fit(X_train, y_train.quality)</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>rfr_grid_fine.best_params_</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Best parameters: {'n_estimators': 1700, 'max_samples': 4001, 'max_features': 7, 'max_depth': 20}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>cv_results_rf <span class="op">=</span> pd.DataFrame(rfr_grid_fine.cv_results_)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">14</span>,<span class="dv">5</span>))</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results_rf.param_max_features, <span class="op">-</span>cv_results_rf.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Features'</span>)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results_rf.param_max_depth, <span class="op">-</span>cv_results_rf.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Depth'</span>)</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results_rf.param_max_samples, <span class="op">-</span>cv_results_rf.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'Samples'</span>)</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].plot(cv_results_rf.param_n_estimators, <span class="op">-</span>cv_results_rf.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].set_xlabel(<span class="st">'Estimators'</span>)</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0, 0.5, 'K-fold RMSE')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-69-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually adjusting based on trends in plots</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># {'n_estimators': 1700, 'max_samples': 4001, 'max_features': 7, 'max_depth': 20} - Test RMSE 0.6821910402406465</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># {'n_estimators': 3700, 'max_samples': 5000, 'max_features': 7, 'max_depth': 20} - Test RMSE 0.6713934992009014</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># {'n_estimators': 5000, 'max_samples': 5000, 'max_features': 7, 'max_depth': 35} - Test RMSE 0.6702467972551374</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>rfr_model <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span> <span class="dv">4000</span>, max_features <span class="op">=</span> <span class="dv">7</span>, max_samples <span class="op">=</span> <span class="dv">5000</span>, max_depth <span class="op">=</span> <span class="dv">50</span>, random_state <span class="op">=</span> <span class="dv">1</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> mean_squared_error(y_train, rfr_model.predict(X_train).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> mean_squared_error(y_test, rfr_model.predict(X_test).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training RMSE: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(train_rmse))</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test RMSE: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(test_rmse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/_x/qn4xkmz55j1g75w_xy65m99m0000gn/T/ipykernel_45401/377503294.py:7: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  rfr_model = RandomForestRegressor(n_estimators= 4000, max_features = 7, max_samples = 5000, max_depth = 50, random_state = 1, n_jobs = -1).fit(X_train, y_train)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Training RMSE: 0.20386868290435214
Test RMSE: 0.6690981300917733</code></pre>
</div>
</div>
</section>
<section id="adaboost" class="level3">
<h3 class="anchored" data-anchor-id="adaboost">AdaBoost</h3>
<p><em>By Kaitlyn Hung</em></p>
<p>Coarse grid search optimizing n_estiamtors, learning_rate, and max_depth of base_estimator:</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> AdaBoostRegressor(random_state<span class="op">=</span><span class="dv">1</span>, base_estimator <span class="op">=</span> DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>))</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'n_estimators'</span>] <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>,<span class="dv">200</span>]</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'learning_rate'</span>] <span class="op">=</span> [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>,<span class="fl">0.1</span>, <span class="fl">1.0</span>]</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'base_estimator__max_depth'</span>] <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>]</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>model, param_grid<span class="op">=</span>grid, n_jobs<span class="op">=-</span><span class="dv">1</span>, cv<span class="op">=</span>cv, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>).fit(X_train, y_train)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best: </span><span class="sc">%f</span><span class="st"> using </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (grid_search.best_score_, grid_search.best_params_))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best: -0.380224 using {'base_estimator__max_depth': 15, 'learning_rate': 1.0, 'n_estimators': 200}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting results</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(grid_search.cv_results_)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">5</span>))</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_n_estimators, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'n estimators'</span>)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_learning_rate, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'learning rate'</span>)</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_base_estimator__max_depth, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'max_depth'</span>)</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-72-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Performing a finer grid search using the visualizations and optimal values</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fine search </span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> AdaBoostRegressor(random_state<span class="op">=</span><span class="dv">1</span>, base_estimator <span class="op">=</span> DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>))</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'n_estimators'</span>] <span class="op">=</span> [<span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>]</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'learning_rate'</span>] <span class="op">=</span> [<span class="fl">.5</span>, <span class="fl">.75</span>, <span class="fl">1.0</span>]</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'base_estimator__max_depth'</span>] <span class="op">=</span> [<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>]</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>model, param_grid<span class="op">=</span>grid, n_jobs<span class="op">=-</span><span class="dv">1</span>, cv<span class="op">=</span>cv, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>).fit(X_train, y_train)</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best: </span><span class="sc">%f</span><span class="st"> using </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (grid_search.best_score_, grid_search.best_params_))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best: -0.377182 using {'base_estimator__max_depth': 14, 'learning_rate': 1.0, 'n_estimators': 1000}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting results</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(grid_search.cv_results_)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">5</span>))</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_n_estimators, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'n estimators'</span>)</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_learning_rate, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'learning rate'</span>)</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_base_estimator__max_depth, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'max_depth'</span>)</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-74-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Performing another finer grid search as some of the optimal values are at the edge of the range I considered.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Finer search </span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> AdaBoostRegressor(random_state<span class="op">=</span><span class="dv">1</span>, base_estimator <span class="op">=</span> DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>))</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'n_estimators'</span>] <span class="op">=</span> [<span class="dv">800</span>, <span class="dv">1000</span>, <span class="dv">1200</span>, <span class="dv">1500</span>]</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'learning_rate'</span>] <span class="op">=</span> [<span class="fl">.75</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>]</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'base_estimator__max_depth'</span>] <span class="op">=</span> [<span class="dv">13</span>, <span class="dv">14</span>,<span class="dv">15</span>, <span class="dv">16</span>]</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>model, param_grid<span class="op">=</span>grid, n_jobs<span class="op">=-</span><span class="dv">1</span>, cv<span class="op">=</span>cv, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>).fit(X_train, y_train)</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best: </span><span class="sc">%f</span><span class="st"> using </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (grid_search.best_score_, grid_search.best_params_))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best: -0.372938 using {'base_estimator__max_depth': 13, 'learning_rate': 1.5, 'n_estimators': 800}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting results</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(grid_search.cv_results_)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">5</span>))</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_n_estimators, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'n estimators'</span>)</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_learning_rate, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'learning rate'</span>)</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_base_estimator__max_depth, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'max_depth'</span>)</span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-76-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Optimizing just learning_rate and max_depth (not n_estimators)</p>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finer search 2</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> AdaBoostRegressor(random_state<span class="op">=</span><span class="dv">1</span>, base_estimator <span class="op">=</span> DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>), n_estimators <span class="op">=</span> <span class="dv">1500</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'learning_rate'</span>] <span class="op">=</span> [<span class="fl">1.25</span>, <span class="fl">1.5</span>, <span class="dv">2</span>]</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'base_estimator__max_depth'</span>] <span class="op">=</span> [<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>]</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>model, param_grid<span class="op">=</span>grid, n_jobs<span class="op">=-</span><span class="dv">1</span>, cv<span class="op">=</span>cv, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>, verbose <span class="op">=</span> <span class="va">True</span>).fit(X_train, y_train)</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best: </span><span class="sc">%f</span><span class="st"> using </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (grid_search.best_score_, grid_search.best_params_))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 5 folds for each of 9 candidates, totalling 45 fits</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best: -0.373120 using {'base_estimator__max_depth': 13, 'learning_rate': 1.5}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting results</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(grid_search.cv_results_)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">5</span>))</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_learning_rate, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'learning rate'</span>)</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_base_estimator__max_depth, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'max_depth'</span>)</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-78-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Optimizing n_estimators using other optimal hyperparameter values</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># optimizing n estimators</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> AdaBoostRegressor(random_state<span class="op">=</span><span class="dv">1</span>, base_estimator <span class="op">=</span> DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>, max_depth <span class="op">=</span> <span class="dv">13</span>), learning_rate <span class="op">=</span> <span class="fl">1.5</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'n_estimators'</span>] <span class="op">=</span> [<span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">2000</span>, <span class="dv">3000</span>, <span class="dv">4000</span>]</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>model, param_grid<span class="op">=</span>grid, n_jobs<span class="op">=-</span><span class="dv">1</span>, cv<span class="op">=</span>cv, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>, verbose <span class="op">=</span> <span class="va">True</span>).fit(X_train, y_train)</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best: </span><span class="sc">%f</span><span class="st"> using </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (grid_search.best_score_, grid_search.best_params_))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 5 folds for each of 5 candidates, totalling 25 fits</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best: -0.372992 using {'n_estimators': 2000}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting results</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(grid_search.cv_results_)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">5</span>))</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>axes.plot(cv_results.param_n_estimators, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>axes.set_xlabel(<span class="st">'n_estimators'</span>)</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>axes.set_ylabel(<span class="st">'K-fold MSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-80-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Testing optimal model RMSE:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tuned hyperparameters</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>ada_model2000 <span class="op">=</span> AdaBoostRegressor(base_estimator<span class="op">=</span>DecisionTreeRegressor(max_depth<span class="op">=</span><span class="dv">13</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>                                  n_estimators<span class="op">=</span><span class="dv">2000</span>,learning_rate<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>                                  random_state<span class="op">=</span><span class="dv">1</span>).fit(X_train,y_train)</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="co"># model from the second to last tuning (not optimal hyperparameters) </span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>ada_model1500 <span class="op">=</span> AdaBoostRegressor(base_estimator<span class="op">=</span>DecisionTreeRegressor(max_depth<span class="op">=</span><span class="dv">13</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>                                  n_estimators<span class="op">=</span><span class="dv">1500</span>,learning_rate<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>                                  random_state<span class="op">=</span><span class="dv">1</span>).fit(X_train,y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predicting and rounding to int</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>raw_test_pred2000 <span class="op">=</span> ada_model2000.predict(X_test)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>test_pred2000 <span class="op">=</span> np.array([round_half_up(xi) <span class="cf">for</span> xi <span class="kw">in</span> raw_test_pred2000])</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>raw_test_pred1500<span class="op">=</span> ada_model1500.predict(X_test)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>test_pred1500 <span class="op">=</span> np.array([round_half_up(xi) <span class="cf">for</span> xi <span class="kw">in</span> raw_test_pred1500])</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="co"># RMSE </span></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"AdaBoost model Test RMSE (n=1500): "</span>, np.sqrt(mean_squared_error(y_test, test_pred1500)))</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"AdaBoost model Test RMSE (n=2000): "</span>, np.sqrt(mean_squared_error(y_test, test_pred2000)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AdaBoost model Test RMSE (n=1500):  0.6586699885725429
AdaBoost model Test RMSE (n=2000):  0.6667948594698258</code></pre>
</div>
</div>
</section>
<section id="gradient-boosting" class="level3">
<h3 class="anchored" data-anchor-id="gradient-boosting">Gradient Boosting</h3>
<p><em>By Anastasia Wei</em></p>
<div class="cell" data-outputid="7110eac6-5087-4f73-e53e-305264573ec0" data-execution_count="3">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the range of n_estimators</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_models():</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    n_trees <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">2000</span>, <span class="dv">2500</span>]</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> n_trees:</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>        models[<span class="bu">str</span>(n)] <span class="op">=</span> GradientBoostingRegressor(n_estimators<span class="op">=</span>n,random_state<span class="op">=</span><span class="dv">1</span>,loss<span class="op">=</span><span class="st">'huber'</span>)</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> models</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model using cross-validation</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_model(model, X, y):</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    cv <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> np.sqrt(<span class="op">-</span>cross_val_score(model, X, y, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>, cv<span class="op">=</span>cv, n_jobs<span class="op">=-</span><span class="dv">1</span>))</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> scores</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a><span class="co"># get the models to evaluate</span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> get_models()</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>results, names <span class="op">=</span> <span class="bu">list</span>(), <span class="bu">list</span>()</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, model <span class="kw">in</span> models.items():</span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> evaluate_model(model, X_train, y_train)</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>    results.append(scores)</span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>    names.append(name)</span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'&gt;</span><span class="sc">%s</span><span class="st"> </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (name, np.mean(scores), np.std(scores)))</span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plot model performance for comparison</span></span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>plt.boxplot(results, labels<span class="op">=</span> names, showmeans<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Cross validation error'</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of trees'</span>,fontsize<span class="op">=</span><span class="dv">15</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;5 0.793 (0.021)
&gt;10 0.753 (0.020)
&gt;50 0.694 (0.014)
&gt;100 0.680 (0.013)
&gt;500 0.662 (0.010)
&gt;1000 0.660 (0.009)
&gt;1500 0.660 (0.008)
&gt;2000 0.662 (0.007)
&gt;2500 0.662 (0.009)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-83-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="5520817b-42a9-450f-d8d6-5b271249b0bf" data-execution_count="6">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 fold cv coarse grid search based on previous search</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GradientBoostingRegressor(random_state <span class="op">=</span> <span class="dv">1</span>, loss<span class="op">=</span><span class="st">'huber'</span>)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'n_estimators'</span>] <span class="op">=</span> [<span class="dv">1200</span>, <span class="dv">1400</span>, <span class="dv">1600</span>, <span class="dv">1800</span>]</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'learning_rate'</span>] <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>]</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'max_depth'</span>] <span class="op">=</span> [<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>]</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'subsample'</span>] <span class="op">=</span> [<span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="dv">1</span>]</span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits <span class="op">=</span> <span class="dv">4</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> RandomizedSearchCV(estimator <span class="op">=</span> model, </span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>                                 param_distributions <span class="op">=</span> grid, </span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>                                 n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, cv <span class="op">=</span> cv, </span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>                                 n_iter <span class="op">=</span> <span class="dv">50</span>,</span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a>                                 scoring <span class="op">=</span> <span class="st">'neg_mean_squared_error'</span>,</span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a>                                 verbose <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a>grid_result <span class="op">=</span> grid_search.fit(X_train, y_train)</span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best: </span><span class="sc">%f</span><span class="st"> using </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (np.sqrt(<span class="op">-</span>grid_result.best_score_), grid_result.best_params_))</span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Time taken = "</span>,(time.time()<span class="op">-</span>start_time)<span class="op">/</span><span class="dv">60</span>,<span class="st">" minutes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 4 folds for each of 50 candidates, totalling 200 fits
Best: 0.623735 using {'subsample': 0.8, 'n_estimators': 1200, 'max_depth': 8, 'learning_rate': 0.1}
Time taken =  24.304628153642017  minutes</code></pre>
</div>
</div>
<div class="cell" data-outputid="bf4d8e2f-acdf-47f6-feef-864e17cc407c" data-execution_count="8">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize cv results</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(grid_result.cv_results_)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">4</span>))</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_n_estimators, np.sqrt(<span class="op">-</span>cv_results.mean_test_score), <span class="st">'o'</span>)</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'param_n_estimators'</span>)</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_learning_rate, np.sqrt(<span class="op">-</span>cv_results.mean_test_score), <span class="st">'o'</span>)</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Learning Rate'</span>)</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_subsample, np.sqrt(<span class="op">-</span>cv_results.mean_test_score), <span class="st">'o'</span>)</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'Subsample'</span>)</span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].plot(cv_results.param_max_depth, np.sqrt(<span class="op">-</span>cv_results.mean_test_score), <span class="st">'o'</span>)</span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].set_xlabel(<span class="st">'max_depth'</span>)</span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-85-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="0b830f74-0803-470f-d39f-2652296dbd22" data-execution_count="11">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># computing train and test rmse based on initial optimization</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GradientBoostingRegressor(n_estimators <span class="op">=</span> <span class="dv">1200</span>, loss <span class="op">=</span> <span class="st">'huber'</span>, max_depth <span class="op">=</span> <span class="dv">8</span>, </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>                                  learning_rate <span class="op">=</span> <span class="fl">0.1</span>, subsample <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>                                  random_state <span class="op">=</span> <span class="dv">45</span>).fit(X_train,y_train)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test RMSE is'</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The test RMSE is 0.6782329983125268</code></pre>
</div>
</div>
<div class="cell" data-outputid="05684e99-ca41-4c42-e136-958fb2e65891" data-execution_count="12">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># computing train and test rmse based on initial optimization</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GradientBoostingRegressor(n_estimators <span class="op">=</span> <span class="dv">1400</span>, loss <span class="op">=</span> <span class="st">'huber'</span>, max_depth <span class="op">=</span> <span class="dv">8</span>, </span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>                                  learning_rate <span class="op">=</span> <span class="fl">0.1</span>, subsample <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>                                  random_state <span class="op">=</span> <span class="dv">45</span>).fit(X_train,y_train)</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test RMSE is'</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The test RMSE is 0.6776656765919086</code></pre>
</div>
</div>
<div class="cell" data-outputid="b604a9b4-d2ba-4fdb-ef5e-fd14ca9b22a5" data-execution_count="13">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finer grid search based on previous optimization</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GradientBoostingRegressor(random_state <span class="op">=</span> <span class="dv">1</span>, loss<span class="op">=</span><span class="st">'huber'</span>)</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'n_estimators'</span>] <span class="op">=</span> [<span class="dv">1300</span>, <span class="dv">1350</span>, <span class="dv">1400</span>, <span class="dv">1450</span>, <span class="dv">1500</span>]</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'learning_rate'</span>] <span class="op">=</span> [<span class="fl">0.8</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>]</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'max_depth'</span>] <span class="op">=</span> [<span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>]</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">'subsample'</span>] <span class="op">=</span> [<span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="dv">1</span>]</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits <span class="op">=</span> <span class="dv">4</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> RandomizedSearchCV(estimator <span class="op">=</span> model, </span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>                                 param_distributions <span class="op">=</span> grid, </span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>                                 n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, cv <span class="op">=</span> cv, </span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>                                 n_iter <span class="op">=</span> <span class="dv">50</span>,</span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>                                 scoring <span class="op">=</span> <span class="st">'neg_mean_squared_error'</span>,</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>                                 verbose <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>grid_result <span class="op">=</span> grid_search.fit(X_train, y_train)</span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best: </span><span class="sc">%f</span><span class="st"> using </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (np.sqrt(<span class="op">-</span>grid_result.best_score_), grid_result.best_params_))</span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Time taken = "</span>,(time.time()<span class="op">-</span>start_time)<span class="op">/</span><span class="dv">60</span>,<span class="st">" minutes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 4 folds for each of 50 candidates, totalling 200 fits
Best: 0.620413 using {'subsample': 0.8, 'n_estimators': 1300, 'max_depth': 9, 'learning_rate': 0.1}
Time taken =  18.446675260861713  minutes</code></pre>
</div>
</div>
<div class="cell" data-outputid="a569a092-810a-4dfa-ca49-f36edb479666" data-execution_count="14">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize finer grid search results</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(grid_result.cv_results_)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">4</span>))</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_n_estimators, np.sqrt(<span class="op">-</span>cv_results.mean_test_score), <span class="st">'o'</span>)</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'param_n_estimators'</span>)</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_learning_rate, np.sqrt(<span class="op">-</span>cv_results.mean_test_score), <span class="st">'o'</span>)</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Learning Rate'</span>)</span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_subsample, np.sqrt(<span class="op">-</span>cv_results.mean_test_score), <span class="st">'o'</span>)</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'Subsample'</span>)</span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].plot(cv_results.param_max_depth, np.sqrt(<span class="op">-</span>cv_results.mean_test_score), <span class="st">'o'</span>)</span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].set_xlabel(<span class="st">'max_depth'</span>)</span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-89-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="76c0b739-753f-4724-fc37-7abf16e29496" data-execution_count="15">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model with optimized parameter</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GradientBoostingRegressor(n_estimators <span class="op">=</span> <span class="dv">1300</span>, loss <span class="op">=</span> <span class="st">'huber'</span>, max_depth <span class="op">=</span> <span class="dv">9</span>, </span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>                                  learning_rate <span class="op">=</span> <span class="fl">0.1</span>, subsample <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>                                  random_state <span class="op">=</span> <span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rounded rmse</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test RMSE is'</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The test RMSE is 0.6713934992009014</code></pre>
</div>
</div>
<p>Manual Tunning &amp; Testing</p>
<div class="cell" data-outputid="ea6673ad-babf-4fba-a4fc-f9f5cb8d956a" data-execution_count="22">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GradientBoostingRegressor(n_estimators <span class="op">=</span> <span class="dv">1300</span>, loss <span class="op">=</span> <span class="st">'huber'</span>, max_depth <span class="op">=</span> <span class="dv">9</span>, </span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>                                  learning_rate <span class="op">=</span> <span class="fl">0.08</span>, subsample <span class="op">=</span> <span class="fl">0.85</span>, </span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>                                  random_state <span class="op">=</span> <span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rounded rmse</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test RMSE is'</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The test RMSE is 0.6586699885725429</code></pre>
</div>
</div>
<div class="cell" data-outputid="189583fb-3add-4b5d-e878-e84cee287469" data-execution_count="23">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># feature importance</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>features_df <span class="op">=</span> pd.DataFrame(<span class="bu">zip</span>(X_train.columns, <span class="bu">list</span>(model.feature_importances_)),</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>                           columns <span class="op">=</span>[<span class="st">'Predictor'</span>, <span class="st">'Importance'</span>])</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>features_df.sort_values(by <span class="op">=</span> <span class="st">'Importance'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">


  <div id="df-fbefa2ac-a3a3-4e9f-8ab2-107c9bb79330">
    <div class="colab-df-container">
      <div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Predictor</th>
      <th>Importance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>alcohol</td>
      <td>0.250846</td>
    </tr>
    <tr>
      <th>1</th>
      <td>volatile acidity</td>
      <td>0.124307</td>
    </tr>
    <tr>
      <th>5</th>
      <td>free sulfur dioxide</td>
      <td>0.080374</td>
    </tr>
    <tr>
      <th>9</th>
      <td>sulphates</td>
      <td>0.078176</td>
    </tr>
    <tr>
      <th>6</th>
      <td>total sulfur dioxide</td>
      <td>0.077565</td>
    </tr>
    <tr>
      <th>3</th>
      <td>residual sugar</td>
      <td>0.072411</td>
    </tr>
    <tr>
      <th>8</th>
      <td>pH</td>
      <td>0.069419</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chlorides</td>
      <td>0.067845</td>
    </tr>
    <tr>
      <th>7</th>
      <td>density</td>
      <td>0.066263</td>
    </tr>
    <tr>
      <th>2</th>
      <td>citric acid</td>
      <td>0.058864</td>
    </tr>
    <tr>
      <th>0</th>
      <td>fixed acidity</td>
      <td>0.053085</td>
    </tr>
    <tr>
      <th>12</th>
      <td>type_white</td>
      <td>0.000499</td>
    </tr>
    <tr>
      <th>11</th>
      <td>type_red</td>
      <td>0.000347</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fbefa2ac-a3a3-4e9f-8ab2-107c9bb79330')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fbefa2ac-a3a3-4e9f-8ab2-107c9bb79330 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fbefa2ac-a3a3-4e9f-8ab2-107c9bb79330');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Other attemps</p>
<div class="cell" data-outputid="c313435c-9340-4519-b2e8-4796d88057ad" data-execution_count="24">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GradientBoostingRegressor(n_estimators <span class="op">=</span> <span class="dv">1300</span>, loss <span class="op">=</span> <span class="st">'huber'</span>, max_depth <span class="op">=</span> <span class="dv">7</span>, </span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>                                  learning_rate <span class="op">=</span> <span class="fl">0.08</span>, subsample <span class="op">=</span> <span class="fl">0.85</span>, </span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>                                  random_state <span class="op">=</span> <span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rounded rmse</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test RMSE is'</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The test RMSE is 0.6713934992009014</code></pre>
</div>
</div>
<div class="cell" data-outputid="433010eb-27bd-4fa6-ac41-eb4b2715a493" data-execution_count="25">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GradientBoostingRegressor(n_estimators <span class="op">=</span> <span class="dv">1400</span>, loss <span class="op">=</span> <span class="st">'huber'</span>, max_depth <span class="op">=</span> <span class="dv">9</span>, </span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>                                  learning_rate <span class="op">=</span> <span class="fl">0.07</span>, subsample <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>                                  random_state <span class="op">=</span> <span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rounded rmse</span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test RMSE is'</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The test RMSE is 0.6719661163618754</code></pre>
</div>
</div>
</section>
<section id="xgboost" class="level3">
<h3 class="anchored" data-anchor-id="xgboost">XGBoost</h3>
<p><em>By Amy Wang</em></p>
<p>Initial broad sweep of the parameter space, for 7 parameters: <code>max_depth</code>, <code>learning_rate</code>, <code>reg_lambda</code>, <code>n_estimators</code>, <code>gamma</code>, <code>subsample</code>, <code>colsample_bytree</code>. I fit the model with the optimal parameters found by <code>RandomizedSearchCV</code> and plot how well the model predicts both train and test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Initial Broad Sweep of the Parameter Space</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'max_depth'</span>: [<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>],</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">'learning_rate'</span>: [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>],</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">'reg_lambda'</span>:[<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>],</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">'n_estimators'</span>:[<span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">3000</span>, <span class="dv">4000</span>],</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">'gamma'</span>: [<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'subsample'</span>: [<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>],</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"colsample_bytree"</span>: [<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.0</span>]}</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>xgboost <span class="op">=</span> RandomizedSearchCV(estimator <span class="op">=</span> XGBRegressor(random_state<span class="op">=</span><span class="dv">1</span>),                                                       </span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>                             param_distributions <span class="op">=</span> param_grid,                             </span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>                             verbose <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>                             n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>                             n_iter <span class="op">=</span> <span class="dv">20</span>,</span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>                             cv <span class="op">=</span> <span class="dv">5</span>).fit(X_train, y_train)</span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a>xgboost.best_params_</span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true" tabindex="-1"></a><span class="co"># {'subsample': 1.0,</span></span>
<span id="cb179-20"><a href="#cb179-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  'reg_lambda': 0,</span></span>
<span id="cb179-21"><a href="#cb179-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  'n_estimators': 2000,</span></span>
<span id="cb179-22"><a href="#cb179-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  'max_depth': 8,</span></span>
<span id="cb179-23"><a href="#cb179-23" aria-hidden="true" tabindex="-1"></a><span class="co">#  'learning_rate': 0.01,</span></span>
<span id="cb179-24"><a href="#cb179-24" aria-hidden="true" tabindex="-1"></a><span class="co">#  'gamma': 0,</span></span>
<span id="cb179-25"><a href="#cb179-25" aria-hidden="true" tabindex="-1"></a><span class="co">#  'colsample_bytree': 1.0}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 5 folds for each of 20 candidates, totalling 100 fits</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>{'subsample': 1.0,
 'reg_lambda': 0,
 'n_estimators': 2000,
 'max_depth': 8,
 'learning_rate': 0.01,
 'gamma': 0,
 'colsample_bytree': 1.0}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>init_xgboost <span class="op">=</span> XGBRegressor(n_estimators <span class="op">=</span> <span class="dv">2000</span>, learning_rate <span class="op">=</span> <span class="fl">0.01</span>, subsample <span class="op">=</span> <span class="fl">1.0</span>, reg_lambda <span class="op">=</span> <span class="dv">0</span>, max_depth <span class="op">=</span> <span class="dv">8</span>, gamma <span class="op">=</span> <span class="dv">0</span>, colsample_bytree <span class="op">=</span> <span class="fl">1.0</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>init_xgboost.fit(X_train, y_train)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>pred_series <span class="op">=</span> pd.Series(init_xgboost.predict(X_test))</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>pred_series_rounded <span class="op">=</span> pred_series.<span class="bu">round</span>()</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>mean_squared_error(y_test, pred_series_rounded, squared <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.6799321233091523</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> init_xgboost.predict(X_train).<span class="bu">round</span>(), y <span class="op">=</span> y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;AxesSubplot:ylabel='quality'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-97-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> init_xgboost.predict(X_test).<span class="bu">round</span>(), y <span class="op">=</span> y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;AxesSubplot:ylabel='quality'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-98-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>I visualize the 5-fold cross-validated RMSE for each of the parameters to understand if it’s possible to manually optimize the model any further.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the parameter space to understand how to narrow subsequent searches</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(xgboost.cv_results_)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">20</span>,<span class="dv">5</span>))</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_subsample, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Subsample'</span>)</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_gamma, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Gamma'</span>)</span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_learning_rate, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'Learning Rate'</span>)</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0, 0.5, 'K-fold RMSE')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-99-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">20</span>,<span class="dv">5</span>))</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_max_depth, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Depth'</span>)</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_n_estimators, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Estimators'</span>)</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_reg_lambda, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'Lambda'</span>)</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].plot(cv_results.param_colsample_bytree, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].set_xlabel(<span class="st">'colsample_bytree'</span>)</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0, 0.5, 'K-fold RMSE')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-100-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual tuning based on the plots. RMSE does not improve.</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>init_xgboost <span class="op">=</span> XGBRegressor(n_estimators <span class="op">=</span> <span class="dv">4000</span>, learning_rate <span class="op">=</span> <span class="fl">0.01</span>, subsample <span class="op">=</span> <span class="fl">1.0</span>, reg_lambda <span class="op">=</span> <span class="dv">100</span>, max_depth <span class="op">=</span> <span class="dv">8</span>, gamma <span class="op">=</span> <span class="dv">0</span>, colsample_bytree <span class="op">=</span> <span class="fl">1.0</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>init_xgboost.fit(X_train, y_train)</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>pred_series <span class="op">=</span> pd.Series(init_xgboost.predict(X_test))</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>pred_series_rounded <span class="op">=</span> pred_series.<span class="bu">round</span>()</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>mean_squared_error(y_test, pred_series_rounded, squared <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.6855654600401044</code></pre>
</div>
</div>
<p>Second <code>RandomizedSearchCV</code> grid search with a constant learning rate of 0.01.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid search with learning_rate = 0.01</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'max_depth'</span>: [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>],</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">'learning_rate'</span>: [<span class="fl">0.01</span>],</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">'reg_lambda'</span>:[<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">70</span>, <span class="dv">100</span>],</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">'n_estimators'</span>:[<span class="dv">3000</span>, <span class="dv">4000</span>, <span class="dv">5000</span>],</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'gamma'</span>: [<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>],</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">'subsample'</span>: [<span class="fl">0.5</span>, <span class="fl">1.0</span>],</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"colsample_bytree"</span>: [<span class="fl">0.6</span>, <span class="fl">0.75</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>]}</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>xgboost2 <span class="op">=</span> RandomizedSearchCV(estimator <span class="op">=</span> XGBRegressor(random_state<span class="op">=</span><span class="dv">1</span>),                                                       </span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>                             param_distributions <span class="op">=</span> param_grid,                             </span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>                             verbose <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>                             n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>                             n_iter <span class="op">=</span> <span class="dv">50</span>,</span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a>                             cv <span class="op">=</span> <span class="dv">5</span>).fit(X_train, y_train)</span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>xgboost2.best_params_</span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a><span class="co"># {'subsample': 0.5,</span></span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  'reg_lambda': 0,</span></span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  'n_estimators': 5000,</span></span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  'max_depth': 9,</span></span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a><span class="co">#  'learning_rate': 0.01,</span></span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a><span class="co">#  'gamma': 0,</span></span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a><span class="co">#  'colsample_bytree': 0.75}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 5 folds for each of 50 candidates, totalling 250 fits</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>{'subsample': 0.5,
 'reg_lambda': 0,
 'n_estimators': 5000,
 'max_depth': 9,
 'learning_rate': 0.01,
 'gamma': 0,
 'colsample_bytree': 0.75}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.DataFrame(xgboost2.cv_results_)</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">20</span>,<span class="dv">5</span>))</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_subsample, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Subsample'</span>)</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_gamma, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Gamma'</span>)</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_colsample_bytree, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'colsample_bytree'</span>)</span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0, 0.5, 'K-fold RMSE')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-103-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">20</span>,<span class="dv">5</span>))</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(cv_results.param_max_depth, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Depth'</span>)</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(cv_results.param_n_estimators, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Estimators'</span>)</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(cv_results.param_reg_lambda, <span class="op">-</span>cv_results.mean_test_score, <span class="st">'o'</span>)</span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'Lambda'</span>)</span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'K-fold RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0, 0.5, 'K-fold RMSE')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-104-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit based on the best combination of parameters from above</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="co"># {'subsample': 0.5,</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  'reg_lambda': 0,</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  'n_estimators': 5000,</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  'max_depth': 9,</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  'learning_rate': 0.01,</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  'gamma': 0,</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  'colsample_bytree': 0.75}</span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>optimized_xgboost2 <span class="op">=</span> XGBRegressor(n_estimators <span class="op">=</span> <span class="dv">5000</span>, learning_rate <span class="op">=</span> <span class="fl">0.01</span>, subsample <span class="op">=</span> <span class="fl">0.5</span>, reg_lambda <span class="op">=</span> <span class="dv">0</span>, max_depth <span class="op">=</span> <span class="dv">9</span>, gamma <span class="op">=</span> <span class="dv">0</span>, colsample_bytree <span class="op">=</span> <span class="fl">0.75</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>optimized_xgboost2.fit(X_train, y_train)</span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a>mean_squared_error(y_test, optimized_xgboost2.predict(X_test).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.6598368096617643</code></pre>
</div>
</div>
<p>Plotting the Actual vs.&nbsp;Predicted Values of Quality</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>regplot <span class="op">=</span> sns.regplot(x <span class="op">=</span> optimized_xgboost2.predict(X_train).<span class="bu">round</span>(), y <span class="op">=</span> y_train)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>regplot.<span class="bu">set</span>(xlabel <span class="op">=</span><span class="st">"Predicted Values"</span>, ylabel <span class="op">=</span> <span class="st">"Actual Values"</span>, title <span class="op">=</span><span class="st">'Actual vs. Predicted Values of Quality (Training)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[Text(0.5, 0, 'Predicted Values'),
 Text(0, 0.5, 'Actual Values'),
 Text(0.5, 1.0, 'Actual vs. Predicted Values of Quality (Training)')]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-106-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>regplot <span class="op">=</span> sns.regplot(x <span class="op">=</span> optimized_xgboost2.predict(X_test).<span class="bu">round</span>(), y <span class="op">=</span> y_test)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>regplot.<span class="bu">set</span>(xlabel <span class="op">=</span><span class="st">"Predicted Values"</span>, ylabel <span class="op">=</span> <span class="st">"Actual Values"</span>, title <span class="op">=</span><span class="st">'Actual vs. Predicted Values of Quality (Test)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[Text(0.5, 0, 'Predicted Values'),
 Text(0, 0.5, 'Actual Values'),
 Text(0.5, 1.0, 'Actual vs. Predicted Values of Quality (Test)')]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-107-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>features_dict <span class="op">=</span> optimized_xgboost2.get_booster().get_score(importance_type<span class="op">=</span><span class="st">'gain'</span>)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(<span class="bu">zip</span>(features_dict.keys(), features_dict.values())), columns <span class="op">=</span>[<span class="st">'Feature_name'</span>, <span class="st">'Importance'</span>])</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>features.sort_values(<span class="st">"Importance"</span>, ascending <span class="op">=</span> <span class="va">False</span>).reset_index().drop(columns <span class="op">=</span> <span class="st">"index"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Feature_name</th>
      <th>Importance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>type_red</td>
      <td>0.765248</td>
    </tr>
    <tr>
      <th>1</th>
      <td>type_white</td>
      <td>0.414878</td>
    </tr>
    <tr>
      <th>2</th>
      <td>alcohol</td>
      <td>0.392954</td>
    </tr>
    <tr>
      <th>3</th>
      <td>sulphates</td>
      <td>0.171820</td>
    </tr>
    <tr>
      <th>4</th>
      <td>density</td>
      <td>0.168505</td>
    </tr>
    <tr>
      <th>5</th>
      <td>free sulfur dioxide</td>
      <td>0.166862</td>
    </tr>
    <tr>
      <th>6</th>
      <td>pH</td>
      <td>0.154604</td>
    </tr>
    <tr>
      <th>7</th>
      <td>total sulfur dioxide</td>
      <td>0.152681</td>
    </tr>
    <tr>
      <th>8</th>
      <td>chlorides</td>
      <td>0.129691</td>
    </tr>
    <tr>
      <th>9</th>
      <td>residual sugar</td>
      <td>0.127429</td>
    </tr>
    <tr>
      <th>10</th>
      <td>citric acid</td>
      <td>0.108015</td>
    </tr>
    <tr>
      <th>11</th>
      <td>volatile acidity</td>
      <td>0.107656</td>
    </tr>
    <tr>
      <th>12</th>
      <td>fixed acidity</td>
      <td>0.055337</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><strong>Attempting Bayesian Optimization, to compare to RandomizedSearchCV</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian Optimization of XGBoost Hyperparameters</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="co">## To see if Bayesian Optimization will do better than Random Grid Search CV</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>pbounds <span class="op">=</span> {</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: (<span class="fl">0.001</span>, <span class="fl">1.0</span>),</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: (<span class="dv">100</span>, <span class="dv">4000</span>),</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: (<span class="dv">3</span>,<span class="dv">10</span>),</span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'subsample'</span>: (<span class="fl">0.3</span>, <span class="fl">1.0</span>),</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'gamma'</span>: (<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'reg_lambda'</span>: (<span class="dv">0</span>, <span class="dv">100</span>)}</span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> xgboost_hyper_param(learning_rate,</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>                        n_estimators,</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>                        max_depth,</span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>                        subsample,</span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>                        gamma,</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>                        reg_lambda):</span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a>    max_depth <span class="op">=</span> <span class="bu">int</span>(max_depth)</span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a>    n_estimators <span class="op">=</span> <span class="bu">int</span>(n_estimators)</span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a>    clf <span class="op">=</span> XGBRegressor(</span>
<span id="cb208-23"><a href="#cb208-23" aria-hidden="true" tabindex="-1"></a>        max_depth <span class="op">=</span> max_depth,</span>
<span id="cb208-24"><a href="#cb208-24" aria-hidden="true" tabindex="-1"></a>        learning_rate <span class="op">=</span> learning_rate,</span>
<span id="cb208-25"><a href="#cb208-25" aria-hidden="true" tabindex="-1"></a>        n_estimators <span class="op">=</span> n_estimators,</span>
<span id="cb208-26"><a href="#cb208-26" aria-hidden="true" tabindex="-1"></a>        gamma <span class="op">=</span> gamma)</span>
<span id="cb208-27"><a href="#cb208-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(cross_val_score(clf, X_train, y_train, cv <span class="op">=</span> <span class="dv">5</span>, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>))</span>
<span id="cb208-28"><a href="#cb208-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-29"><a href="#cb208-29" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> BayesianOptimization(</span>
<span id="cb208-30"><a href="#cb208-30" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> xgboost_hyper_param,</span>
<span id="cb208-31"><a href="#cb208-31" aria-hidden="true" tabindex="-1"></a>    pbounds <span class="op">=</span> pbounds,</span>
<span id="cb208-32"><a href="#cb208-32" aria-hidden="true" tabindex="-1"></a>    random_state <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb208-33"><a href="#cb208-33" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>optimizer.maximize(init_points <span class="op">=</span> <span class="dv">5</span>, n_iter <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best result: </span><span class="sc">{}</span><span class="st">; f(x) = </span><span class="sc">{}</span><span class="st">."</span>.<span class="bu">format</span>(optimizer.<span class="bu">max</span>[<span class="st">"params"</span>], optimizer.<span class="bu">max</span>[<span class="st">"target"</span>]))</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Best result: {'colsample': 0.926371203066647, 'gamma': 4.004543074048512, 'learning_rate': 0.105068050089807, 'max_depth': 6.815443879731223, 'n_estimators': 1315.404330702919, 'subsample': 0.4879450393211324}; f(x) = -0.466861276075143.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>|   iter    |  target   | colsample |   gamma   | learni... | max_depth | n_esti... | subsample |
-------------------------------------------------------------------------------------------------
| 1         | -0.4945   | 0.7085    | 7.203     | 0.01011   | 5.116     | 525.6     | 0.3646    |
| 2         | -0.4759   | 0.5931    | 3.456     | 0.4028    | 6.772     | 1.316e+03 | 0.7797    |
| 3         | -0.4964   | 0.6022    | 8.781     | 0.03711   | 7.693     | 1.31e+03  | 0.6911    |
| 4         | -0.5484   | 0.5702    | 1.981     | 0.8027    | 9.778     | 1.009e+03 | 0.7846    |
| 5         | -0.5041   | 0.9382    | 8.946     | 0.09419   | 3.273     | 592.5     | 0.9147    |
| 6         | -0.4669   | 0.9264    | 4.005     | 0.1051    | 6.815     | 1.315e+03 | 0.4879    |
| 7         | -0.499    | 0.8711    | 5.935     | 0.5099    | 3.894     | 1.314e+03 | 0.3997    |
| 8         | -0.4822   | 0.8882    | 6.403     | 0.4975    | 8.614     | 1.316e+03 | 0.6406    |
| 9         | -0.5233   | 0.7391    | 3.505     | 0.8952    | 7.737     | 1.312e+03 | 0.3287    |
| 10        | -0.4892   | 0.6288    | 3.743     | 0.6291    | 6.274     | 1.319e+03 | 0.5374    |
| 11        | -0.5191   | 0.9329    | 5.617     | 0.8387    | 7.073     | 1.316e+03 | 0.6822    |
| 12        | -0.4856   | 0.5393    | 3.801     | 0.5747    | 5.933     | 1.315e+03 | 0.3307    |
| 13        | -0.5015   | 0.5776    | 2.517     | 0.631     | 6.298     | 1.317e+03 | 0.9844    |
| 14        | -0.4886   | 0.5334    | 4.53      | 0.486     | 8.605     | 1.315e+03 | 0.6784    |
| 15        | -0.5222   | 0.5267    | 4.66      | 0.9183    | 9.579     | 1.317e+03 | 0.8874    |
=================================================================================================
Best result: {'colsample': 0.926371203066647, 'gamma': 4.004543074048512, 'learning_rate': 0.105068050089807, 'max_depth': 6.815443879731223, 'n_estimators': 1315.404330702919, 'subsample': 0.4879450393211324}; f(x) = -0.466861276075143.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementing the Bayesian Optimizer model</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>xgb_model_bayesOpt <span class="op">=</span> XGBRegressor(colsample <span class="op">=</span> <span class="fl">0.926371203066647</span>,</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>                                  subsample <span class="op">=</span> <span class="fl">0.4879450393211324</span>,</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>                                  n_estimators <span class="op">=</span> <span class="dv">1315</span>,</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>                                  max_depth <span class="op">=</span> <span class="dv">7</span>, </span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>                                  learning_rate <span class="op">=</span> <span class="fl">0.105068050089807</span>, </span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>                                  gamma <span class="op">=</span> <span class="fl">4.004543074048512</span>).fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[13:23:33] WARNING: /Users/runner/work/xgboost/xgboost/python-package/build/temp.macosx-10.9-x86_64-cpython-38/xgboost/src/learner.cc:767: 
Parameters: { "colsample" } are not used.
</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>mean_squared_error(y_test, xgb_model_bayesOpt.predict(X_test).<span class="bu">round</span>(), squared <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.739022223044643</code></pre>
</div>
</div>
</section>
<section id="catboost-and-lightgbm" class="level3">
<h3 class="anchored" data-anchor-id="catboost-and-lightgbm">CatBoost, and LightGBM</h3>
<p><em>By Anastasia Wei</em></p>
<div class="cell" data-outputid="f83c87af-4121-4156-fd4a-a7b6fc3ccf81" data-execution_count="26">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># untuned catboost model with default parameters</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>model_cat <span class="op">=</span> CatBoostRegressor(verbose <span class="op">=</span> <span class="va">False</span>).fit(X_train, y_train)</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train RMSE ='</span>, np.sqrt(mean_squared_error(np.around(model_cat.predict(X_train)),y_train)))</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test RMSE ='</span>, np.sqrt(mean_squared_error(np.around(model_cat.predict(X_test)),y_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Train RMSE = 0.4760979229626765
Test RMSE = 0.7130648907789097</code></pre>
</div>
</div>
<div class="cell" data-outputid="f95b2a50-480c-4c29-c061-ae4a0d5a214f" data-execution_count="27">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># untuned LGBM model with default parameters</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>model_lgbm <span class="op">=</span> LGBMRegressor().fit(X_train, y_train)</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train RMSE ='</span>, np.sqrt(mean_squared_error(np.around(model_lgbm.predict(X_train)),y_train)))</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test RMSE ='</span>, np.sqrt(mean_squared_error(np.around(model_lgbm.predict(X_test)),y_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Train RMSE = 0.5210592961182009
Test RMSE = 0.7258946734362203</code></pre>
</div>
</div>
</section>
</section>
<section id="model-ensemble" class="level2">
<h2 class="anchored" data-anchor-id="model-ensemble">Model Ensemble</h2>
<p><em>By Anastasia Wei</em></p>
<p>Put code with comments. The comments should explain the code such that it can be easily understood. You may put text <em>(in a markdown cell)</em> before a large chunk of code to explain the overall purpose of the code, if it is not intuitive. <strong>Put the name of the person / persons who contributed to each code chunk / set of code chunks.</strong></p>
<p>Loading and predicting using each of the individual models from previous model section</p>
<div class="cell" data-outputid="fdb2d48d-1e49-415b-9881-4e540446ce99" data-execution_count="28">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>model_lasso <span class="op">=</span> Lasso(alpha <span class="op">=</span> <span class="fl">0.00036584035717135963</span>).fit(X_train, y_train)</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>lasso_pred_train <span class="op">=</span> model_lasso.predict(X_train)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>lasso_pred_test <span class="op">=</span> model_lasso.predict(X_test)</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"lasso train RMSE ="</span>, np.sqrt(mean_squared_error(y_train, np.around(lasso_pred_train))))</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"lasso test RMSE ="</span>, np.sqrt(mean_squared_error(y_test, np.around(lasso_pred_test))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lasso train RMSE = 0.7818658578951756
lasso test RMSE = 0.808131748588634</code></pre>
</div>
</div>
<div class="cell" data-outputid="11952381-5ba3-4ffc-f2cc-7abe3ebd9469" data-execution_count="29">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>model_ridge <span class="op">=</span> Ridge(alpha <span class="op">=</span> <span class="fl">0.01636987568069109</span>).fit(X_train, y_train)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>ridge_pred_train <span class="op">=</span> model_ridge.predict(X_train)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>ridge_pred_test <span class="op">=</span> model_ridge.predict(X_test)</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ridge train RMSE ="</span>, np.sqrt(mean_squared_error(y_train, np.around(ridge_pred_train))))</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ridge test RMSE ="</span>, np.sqrt(mean_squared_error(y_test, np.around(ridge_pred_test))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ridge train RMSE = 0.7892143827427598
ridge test RMSE = 0.8166535844059444</code></pre>
</div>
</div>
<div class="cell" data-outputid="727c3118-74ab-40c2-9af6-ecd459e557c7" data-execution_count="30">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>model_gb <span class="op">=</span> GradientBoostingRegressor(n_estimators <span class="op">=</span> <span class="dv">1300</span>, loss <span class="op">=</span> <span class="st">'huber'</span>, max_depth <span class="op">=</span> <span class="dv">9</span>, </span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>                                     learning_rate <span class="op">=</span> <span class="fl">0.08</span>, subsample <span class="op">=</span> <span class="fl">0.85</span>, </span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>                                     random_state <span class="op">=</span> <span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>gb_pred_train <span class="op">=</span> model_gb.predict(X_train)</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>gb_pred_test <span class="op">=</span> model_gb.predict(X_test)</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Gradient boost train RMSE ="</span>, np.sqrt(mean_squared_error(np.around(gb_pred_train), y_train)))</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Gradient boost test RMSE ="</span>, np.sqrt(mean_squared_error(np.around(gb_pred_test), y_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Gradient boost train RMSE = 0.02402615469220623
Gradient boost test RMSE = 0.6586699885725429</code></pre>
</div>
</div>
<div class="cell" data-outputid="38a22064-c7d2-4303-8562-a4dbc40bf6d6" data-execution_count="31">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>model_xgb <span class="op">=</span> XGBRegressor(n_estimators <span class="op">=</span> <span class="dv">4050</span>, max_depth <span class="op">=</span> <span class="dv">7</span>, </span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>                         learning_rate <span class="op">=</span> <span class="fl">0.01</span>, subsample <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>                         reg_lambda <span class="op">=</span> <span class="dv">10</span>, gamma <span class="op">=</span> <span class="dv">0</span>, colsample_bytree <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>                         random_state <span class="op">=</span> <span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>xgb_pred_train <span class="op">=</span> model_xgb.predict(X_train)</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>xgb_pred_test <span class="op">=</span> model_xgb.predict(X_test)</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"xgb train RMSE ="</span>, np.sqrt(mean_squared_error(np.around(xgb_pred_train), y_train)))</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"xgb test RMSE ="</span>, np.sqrt(mean_squared_error(np.around(xgb_pred_test), y_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>xgb train RMSE = 0.16587909616044325
xgb test RMSE = 0.6753916242846414</code></pre>
</div>
</div>
<div class="cell" data-outputid="7e5d6959-102e-4250-cc93-f2c50f9a128e" data-execution_count="32">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>model_ada <span class="op">=</span> AdaBoostRegressor(estimator <span class="op">=</span> DecisionTreeRegressor(max_depth<span class="op">=</span><span class="dv">13</span>),</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>                              n_estimators <span class="op">=</span> <span class="dv">1500</span>, </span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>                              learning_rate <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>                              random_state <span class="op">=</span> <span class="dv">45</span>).fit(X_train,y_train)   </span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>ada_pred_train <span class="op">=</span> model_ada.predict(X_train)</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>ada_pred_test <span class="op">=</span> model_ada.predict(X_test)</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Adaboost train RMSE ="</span>, np.sqrt(mean_squared_error(np.around(ada_pred_train), y_train)))</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Adaboost test RMSE ="</span>, np.sqrt(mean_squared_error(np.around(ada_pred_test), y_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adaboost train RMSE = 0.0
Adaboost test RMSE = 0.6604194471348085</code></pre>
</div>
</div>
<div class="cell" data-outputid="8063cf77-35f2-4d33-fa4a-ebedf0600d0e" data-execution_count="33">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>model_rf <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span> <span class="dv">3000</span>, </span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>                                 max_features <span class="op">=</span> <span class="dv">7</span>, </span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>                                 max_samples <span class="op">=</span> <span class="dv">5000</span>, </span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>                                 max_depth <span class="op">=</span> <span class="dv">50</span>, </span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>                                 random_state <span class="op">=</span> <span class="dv">1</span>, </span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>                                 n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>rf_pred_train <span class="op">=</span> model_rf.predict(X_train)</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>rf_pred_test <span class="op">=</span> model_rf.predict(X_test)</span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Random forest train RMSE ="</span>, np.sqrt(mean_squared_error(np.around(rf_pred_train), y_train)))</span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Random forest test RMSE ="</span>, np.sqrt(mean_squared_error(np.around(rf_pred_test), y_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random forest train RMSE = 0.2029226514289605
Random forest test RMSE = 0.6690981300917733</code></pre>
</div>
</div>
<div class="cell" data-outputid="e51baef3-c307-45d8-d4f8-85d2c5f85f0a" data-execution_count="34">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>model_dt <span class="op">=</span> DecisionTreeRegressor(max_leaf_nodes <span class="op">=</span> <span class="dv">52</span>,</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>                                 max_depth <span class="op">=</span> <span class="dv">6</span>, </span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>                                 min_samples_leaf <span class="op">=</span> <span class="dv">8</span>, </span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>                                 random_state <span class="op">=</span> <span class="dv">45</span>).fit(X_train, y_train)</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>dt_pred_train <span class="op">=</span> model_dt.predict(X_train)</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>dt_pred_test <span class="op">=</span> model_dt.predict(X_test)</span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Decision tree train RMSE ="</span>, np.sqrt(mean_squared_error(np.around(dt_pred_train), y_train)))</span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Decision tree test RMSE ="</span>, np.sqrt(mean_squared_error(np.around(dt_pred_test), y_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Decision tree train RMSE = 0.7266339665201115
Decision tree test RMSE = 0.8043152845265822</code></pre>
</div>
</div>
<div class="cell" data-outputid="33638586-c09f-4314-c92e-2f39fbbb8f14" data-execution_count="35">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>model_cat <span class="op">=</span> CatBoostRegressor(verbose <span class="op">=</span> <span class="va">False</span>).fit(X_train, y_train)</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>cat_pred_train <span class="op">=</span> model_cat.predict(X_train)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>cat_pred_test <span class="op">=</span> model_cat.predict(X_test)</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Catboost train RMSE ="</span>, np.sqrt(mean_squared_error(np.around(cat_pred_train), y_train)))</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Catboost test RMSE ="</span>, np.sqrt(mean_squared_error(np.around(cat_pred_test), y_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Catboost train RMSE = 0.4760979229626765
Catboost test RMSE = 0.7130648907789097</code></pre>
</div>
</div>
<div class="cell" data-outputid="9ea6982f-8e6e-4b63-f182-ea9a07ca1161" data-execution_count="36">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>model_lgbm <span class="op">=</span> LGBMRegressor().fit(X_train, y_train)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>lgbm_pred_train <span class="op">=</span> model_lgbm.predict(X_train)</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>lgbm_pred_test <span class="op">=</span> model_lgbm.predict(X_test)</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"lgbm train RMSE ="</span>, np.sqrt(mean_squared_error(np.around(lgbm_pred_train), y_train)))</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"lgbm test RMSE ="</span>, np.sqrt(mean_squared_error(np.around(lgbm_pred_test), y_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lgbm train RMSE = 0.5210592961182009
lgbm test RMSE = 0.7258946734362203</code></pre>
</div>
</div>
<div class="cell" data-outputid="4b83f2a8-2df8-482f-a113-805f7affcfc8" data-execution_count="37">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>model_bag <span class="op">=</span> BaggingRegressor(random_state <span class="op">=</span> <span class="dv">1</span>, </span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>                             n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>                             estimator <span class="op">=</span> DecisionTreeRegressor(random_state <span class="op">=</span> <span class="dv">1</span>),</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>                             n_estimators <span class="op">=</span> <span class="dv">1100</span>, </span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>                             max_samples <span class="op">=</span> <span class="fl">0.75</span>, </span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>                             max_features <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>                             bootstrap_features <span class="op">=</span> <span class="va">True</span>, </span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>                             bootstrap <span class="op">=</span> <span class="va">False</span>).fit(X_train, y_train)</span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>bag_pred_train <span class="op">=</span> model_bag.predict(X_train)</span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>bag_pred_test <span class="op">=</span> model_bag.predict(X_test)</span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"bagging train RMSE ="</span>, np.sqrt(mean_squared_error(y_train, np.around(bag_pred_train))))</span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"bagging test RMSE ="</span>, np.sqrt(mean_squared_error(y_test, np.around(bag_pred_test))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>bagging train RMSE = 0.08773111263353295
bagging test RMSE = 0.6673714223613529</code></pre>
</div>
</div>
<div class="cell" data-outputid="c39033ae-ec56-4e05-bfaf-56ee4586e183" data-execution_count="43">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MARS model </span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>mars_model <span class="op">=</span> Earth(max_terms <span class="op">=</span> <span class="dv">800</span>, max_degree <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>mars_model.fit(X_train, y_train)</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>pred_opt <span class="op">=</span> mars_model.predict(X_test)</span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>rounded_pred_opt <span class="op">=</span> [<span class="bu">round</span>(p) <span class="cf">for</span> p <span class="kw">in</span> pred_opt]</span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>rounded_pred_opt <span class="op">=</span> pd.Series(rounded_pred_opt, name<span class="op">=</span><span class="st">'quality'</span>)</span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>rounded_pred_opt <span class="op">=</span> rounded_pred_opt.to_frame().rename(columns<span class="op">=</span>{<span class="st">'quality'</span>: <span class="st">'quality'</span>})</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>residuals <span class="op">=</span> y_test.quality <span class="op">-</span> rounded_pred_opt.quality.values</span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a>residual_model <span class="op">=</span> Earth()</span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a>residual_model.fit(rounded_pred_opt, residuals)</span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a>residuals_pred_unrounded <span class="op">=</span> residual_model.predict(rounded_pred_opt)</span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a>residuals_pred <span class="op">=</span> [<span class="bu">round</span>(p) <span class="cf">for</span> p <span class="kw">in</span> residuals_pred_unrounded]</span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true" tabindex="-1"></a>residuals_pred_series <span class="op">=</span> pd.Series(residuals_pred, name<span class="op">=</span><span class="st">'quality'</span>)</span>
<span id="cb239-14"><a href="#cb239-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-15"><a href="#cb239-15" aria-hidden="true" tabindex="-1"></a>pred_opt_train <span class="op">=</span> mars_model.predict(X_train)</span>
<span id="cb239-16"><a href="#cb239-16" aria-hidden="true" tabindex="-1"></a>rounded_opt_train <span class="op">=</span> pd.DataFrame(np.around(pred_opt_train), columns <span class="op">=</span> [<span class="st">'quality'</span>])</span>
<span id="cb239-17"><a href="#cb239-17" aria-hidden="true" tabindex="-1"></a>residuals_train <span class="op">=</span> y_train.quality <span class="op">-</span> rounded_opt_train.quality.values</span>
<span id="cb239-18"><a href="#cb239-18" aria-hidden="true" tabindex="-1"></a>residual_model.fit(rounded_opt_train, residuals_train)</span>
<span id="cb239-19"><a href="#cb239-19" aria-hidden="true" tabindex="-1"></a>residuals_pred_train <span class="op">=</span> np.around(residual_model.predict(rounded_opt_train))</span>
<span id="cb239-20"><a href="#cb239-20" aria-hidden="true" tabindex="-1"></a>residuals_pred_series_train <span class="op">=</span> pd.Series(residuals_pred_train, name<span class="op">=</span><span class="st">'quality'</span>)</span>
<span id="cb239-21"><a href="#cb239-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-22"><a href="#cb239-22" aria-hidden="true" tabindex="-1"></a>mars_pred_train <span class="op">=</span> pd.concat([rounded_opt_train, residuals_pred_series_train], axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb239-23"><a href="#cb239-23" aria-hidden="true" tabindex="-1"></a>mars_pred_test <span class="op">=</span> pd.concat([rounded_pred_opt, residuals_pred_series], axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb239-24"><a href="#cb239-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MARS train RMSE ="</span>, np.sqrt(mean_squared_error(y_train, mars_pred_train)))</span>
<span id="cb239-25"><a href="#cb239-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MARS test RMSE ="</span>, np.sqrt(mean_squared_error(y_test, mars_pred_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MARS train RMSE = 0.7600269381410235
MARS test RMSE = 0.7745966692414834</code></pre>
</div>
</div>
<p>Casting the train and test predicted responses into data frame for ensemble model training.</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> pd.DataFrame(np.array([gb_pred_train, xgb_pred_train, ada_pred_train, </span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>                                  rf_pred_train, mars_pred_train, dt_pred_train, </span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>                                  cat_pred_train, lgbm_pred_train, bag_pred_train,</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>                                  ridge_pred_train, lasso_pred_train]).transpose(),</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>                        columns <span class="op">=</span> [<span class="st">'gb'</span>, <span class="st">'xgb'</span>, <span class="st">'ada'</span>, <span class="st">'rf'</span>, <span class="st">'mars'</span>, <span class="st">'dt'</span>, </span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'cat'</span>, <span class="st">'lgbm'</span>, <span class="st">'bag'</span>, <span class="st">'ridge'</span>, <span class="st">'lasso'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>test_df <span class="op">=</span> pd.DataFrame(np.array([gb_pred_test, xgb_pred_test, ada_pred_test, </span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>                                 rf_pred_test, mars_pred_test, dt_pred_test, </span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>                                 cat_pred_test, lgbm_pred_test, bag_pred_test,</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>                                 ridge_pred_test, lasso_pred_test]).transpose(),</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>                        columns <span class="op">=</span> [<span class="st">'gb'</span>, <span class="st">'xgb'</span>, <span class="st">'ada'</span>, <span class="st">'rf'</span>, <span class="st">'mars'</span>, <span class="st">'dt'</span>, </span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'cat'</span>, <span class="st">'lgbm'</span>, <span class="st">'bag'</span>,<span class="st">'ridge'</span>, <span class="st">'lasso'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="voting-ensemble" class="level3">
<h3 class="anchored" data-anchor-id="voting-ensemble">Voting ensemble</h3>
<div class="cell" data-outputid="1a2ee08e-5a0e-424f-a239-2b88925fcda9" data-execution_count="71">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># average predited response as voting ensemble</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="co"># only using the modesl with rmse &lt; 0.7</span></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> train_df[[<span class="st">'xgb'</span>,<span class="st">'ada'</span>,<span class="st">'rf'</span>,<span class="st">'gb'</span>,<span class="st">'bag'</span>]].<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> test_df[[<span class="st">'xgb'</span>,<span class="st">'ada'</span>,<span class="st">'rf'</span>,<span class="st">'gb'</span>,<span class="st">'bag'</span>]].<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Train RMSE = "</span>, np.sqrt(mean_squared_error(np.around(pred_train), y_train)))</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test RMSE = "</span>, np.sqrt(mean_squared_error(np.around(pred_test), y_test)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Train RMSE =  0.043865556316766474
Test RMSE =  0.6510346794496848</code></pre>
</div>
</div>
<div class="cell" data-outputid="b961598d-d059-45dc-fe0e-4be95c670aca" data-execution_count="72">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making actual vs predicted plots</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>jitter_amount <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>jittered_pred <span class="op">=</span> pred_test <span class="op">+</span> np.random.uniform(low<span class="op">=-</span>jitter_amount, high<span class="op">=</span>jitter_amount, size<span class="op">=</span><span class="bu">len</span>(pred_test))</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">3</span>,<span class="dv">9</span>,<span class="dv">1000</span>)</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(jittered_pred, y_test, alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Predicted Response'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Actual Response'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Actual vs Predicted Response'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>plt.plot(x, x, c <span class="op">=</span> <span class="st">'k'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-129-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="stacking-ensembles" class="level3">
<h3 class="anchored" data-anchor-id="stacking-ensembles">Stacking ensemble(s)</h3>
<div class="cell" data-outputid="3141dff6-3084-4082-e17a-41ca4027b69b" data-execution_count="73">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear regression model</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>linreg <span class="op">=</span> LinearRegression().fit(train_df, y_train)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> linreg.predict(test_df)</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'RMSE for the linreg stacking ensemble ='</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE for the linreg stacking ensemble = 0.6713934992009014</code></pre>
</div>
</div>
<div class="cell" data-outputid="3b7eab53-4120-41ca-91f2-5456fc767eeb" data-execution_count="74">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lasso model</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> <span class="dv">10</span><span class="op">**</span>np.linspace(<span class="dv">0</span>, <span class="op">-</span><span class="dv">3</span>, <span class="dv">300</span>)<span class="op">*</span><span class="fl">0.5</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>lassocv <span class="op">=</span> LassoCV(alphas <span class="op">=</span> alphas, cv <span class="op">=</span> <span class="dv">5</span>, max_iter <span class="op">=</span> <span class="dv">100000</span>)</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>lassocv.fit(train_df, y_train)</span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'opt alpha = '</span>, lassocv.alpha_)</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso(alpha <span class="op">=</span> lassocv.alpha_)</span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>lasso.fit(train_df, y_train)</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lasso.predict(test_df)</span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'RMSE for the lasso stacking ensemble ='</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>opt alpha =  0.0005
RMSE for the lasso stacking ensemble = 0.6598368096617643</code></pre>
</div>
</div>
<div class="cell" data-outputid="e7fb020a-af6a-4603-fd88-455c01a30ae1" data-execution_count="75">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mars model</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>mars_model <span class="op">=</span> Earth(max_degree<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>mars_model.fit(train_df, y_train)</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> mars_model.predict(test_df)</span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'RMSE for the mars stacking ensemble'</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE for the mars stacking ensemble 0.6592536572635639</code></pre>
</div>
</div>
<div class="cell" data-outputid="2ab61c4b-3c6a-4bfb-e6ba-73777bca3dac" data-execution_count="76">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random forest model</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'n_estimators'</span>: [<span class="dv">100</span>],</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">'max_depth'</span>: [<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>],</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">'max_leaf_nodes'</span>:[<span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>],</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">'max_features'</span>: [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>],</span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">'max_samples'</span>: [<span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">3000</span>]}</span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits <span class="op">=</span> <span class="dv">4</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>optimal_params <span class="op">=</span> RandomizedSearchCV(estimator <span class="op">=</span> RandomForestRegressor(random_state<span class="op">=</span><span class="dv">1</span>),                                                       </span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a>                                    param_distributions <span class="op">=</span> param_grid, n_iter <span class="op">=</span> <span class="dv">100</span>,</span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a>                                    scoring <span class="op">=</span> <span class="st">'neg_mean_squared_error'</span>,</span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a>                                    n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose <span class="op">=</span> <span class="dv">1</span>, cv <span class="op">=</span> cv)</span>
<span id="cb252-14"><a href="#cb252-14" aria-hidden="true" tabindex="-1"></a>optimal_params.fit(train_df, y_train)</span>
<span id="cb252-15"><a href="#cb252-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal parameter values ="</span>, optimal_params.best_params_)</span>
<span id="cb252-16"><a href="#cb252-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal cross validation mse = "</span>, <span class="op">-</span>optimal_params.best_score_)</span>
<span id="cb252-17"><a href="#cb252-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Time taken = "</span>, <span class="bu">round</span>((time.time()<span class="op">-</span>start_time)<span class="op">/</span><span class="dv">60</span>), <span class="st">" minutes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 4 folds for each of 100 candidates, totalling 400 fits
Optimal parameter values = {'n_estimators': 100, 'max_samples': 3000, 'max_leaf_nodes': 1000, 'max_features': 8, 'max_depth': 12}
Optimal cross validation mse =  0.0003126043406170428
Time taken =  0  minutes</code></pre>
</div>
</div>
<div class="cell" data-outputid="7a2576c5-34ab-4a3e-ad73-659ddc42bdcc" data-execution_count="77">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestRegressor(n_estimators <span class="op">=</span> <span class="dv">100</span>, max_samples <span class="op">=</span> <span class="dv">3000</span>, </span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>                                 max_leaf_nodes <span class="op">=</span> <span class="dv">1000</span>, max_features <span class="op">=</span> <span class="dv">8</span>,</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>                                 verbose <span class="op">=</span> <span class="va">False</span>, max_depth <span class="op">=</span> <span class="dv">12</span>,</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>                                 n_jobs<span class="op">=</span> <span class="op">-</span><span class="dv">1</span>).fit(train_df, y_train)</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test RMSE'</span>, np.sqrt(mean_squared_error(y_test, np.around(rf_model.predict(test_df)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test RMSE 0.6492599337233598</code></pre>
</div>
</div>
<div class="cell" data-outputid="dc556bc7-3ec7-494e-b071-3f44be434120" data-execution_count="78">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># xgboost model</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'max_depth'</span>: [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">'learning_rate'</span>: [<span class="fl">0.008</span>, <span class="fl">0.01</span>, <span class="fl">0.025</span>, <span class="fl">0.05</span>],</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">'reg_lambda'</span>:[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>],</span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">'n_estimators'</span>:[<span class="dv">500</span>, <span class="dv">600</span>, <span class="dv">800</span>, <span class="dv">1000</span>],</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">'gamma'</span>: [<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">'subsample'</span>: [<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.0</span>],</span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">'colsample_bytree'</span>: [<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.0</span>]}</span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits <span class="op">=</span> <span class="dv">4</span>, shuffle <span class="op">=</span> <span class="va">True</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a>optimal_params <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span> XGBRegressor(random_state<span class="op">=</span><span class="dv">1</span>),                                                       </span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true" tabindex="-1"></a>                                    param_distributions <span class="op">=</span> param_grid, n_iter <span class="op">=</span> <span class="dv">100</span>,</span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true" tabindex="-1"></a>                                    scoring <span class="op">=</span> <span class="st">'neg_mean_squared_error'</span>,</span>
<span id="cb256-15"><a href="#cb256-15" aria-hidden="true" tabindex="-1"></a>                                    n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose <span class="op">=</span> <span class="dv">1</span>, cv <span class="op">=</span> cv)</span>
<span id="cb256-16"><a href="#cb256-16" aria-hidden="true" tabindex="-1"></a>optimal_params.fit(train_df,y_train)</span>
<span id="cb256-17"><a href="#cb256-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal parameter values ="</span>, optimal_params.best_params_)</span>
<span id="cb256-18"><a href="#cb256-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal cross validation mse = "</span>, <span class="op">-</span>optimal_params.best_score_)</span>
<span id="cb256-19"><a href="#cb256-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Time taken = "</span>, <span class="bu">round</span>((time.time()<span class="op">-</span>start_time)<span class="op">/</span><span class="dv">60</span>), <span class="st">" minutes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 4 folds for each of 100 candidates, totalling 400 fits
Optimal parameter values = {'subsample': 0.75, 'reg_lambda': 0, 'n_estimators': 1000, 'max_depth': 6, 'learning_rate': 0.008, 'gamma': 0, 'colsample_bytree': 1.0}
Optimal cross validation mse =  3.4230875375944506e-06
Time taken =  1  minutes</code></pre>
</div>
</div>
<div class="cell" data-outputid="9bd43419-caf7-45ec-d27b-5e1cd8694f6d" data-execution_count="79">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>xgb_model <span class="op">=</span> XGBRegressor(subsample <span class="op">=</span> <span class="fl">0.75</span>, reg_lambda <span class="op">=</span> <span class="dv">0</span>, n_estimators <span class="op">=</span> <span class="dv">1000</span>, </span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>                         max_depth <span class="op">=</span> <span class="dv">6</span>, learning_rate <span class="op">=</span> <span class="fl">0.008</span>, gamma <span class="op">=</span> <span class="dv">0</span>,</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>                         colsample_bytree <span class="op">=</span> <span class="dv">1</span>, random_state <span class="op">=</span> <span class="dv">1</span>).fit(train_df, y_train)</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test RMSE'</span>, np.sqrt(mean_squared_error(y_test, np.around(xgb_model.predict(test_df)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test RMSE 0.6753916242846414</code></pre>
</div>
</div>
</section>
<section id="ensemble-of-ensembled-models" class="level3">
<h3 class="anchored" data-anchor-id="ensemble-of-ensembled-models">Ensemble of ensembled models</h3>
<div class="cell" data-outputid="988dbe53-24a4-4697-fb85-0c5f37cdab02" data-execution_count="93">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use a voting ensemble to ensemble the metalmodels</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> (linreg.predict(test_df).flatten() <span class="op">+</span> lasso.predict(test_df) </span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> rf_model.predict(test_df)<span class="op">+</span> mars_model.predict(test_df)</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>         <span class="op">+</span> xgb_model.predict(test_df))<span class="op">/</span><span class="dv">5</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'rmse for the voting ensemble model:'</span>, np.sqrt(mean_squared_error(y_test, np.around(pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rmse for the voting ensemble model: 0.6610015710443334</code></pre>
</div>
</div>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tuning thee rounding threshold</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>rmses <span class="op">=</span> []</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> p:</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>  base <span class="op">=</span> np.floor(pred)</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>  diff <span class="op">=</span> pred <span class="op">-</span> base</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cast to a list</span></span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>  new_pred <span class="op">=</span> base <span class="op">+</span> np.array([<span class="bu">int</span>(x <span class="op">==</span> <span class="va">True</span>) <span class="cf">for</span> x <span class="kw">in</span> (diff <span class="op">&gt;</span> i)])</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>  rmse <span class="op">=</span> np.sqrt(mean_squared_error(y_test, np.around(new_pred)))</span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>  rmses.append(rmse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="49ba82db-df4a-4378-84e1-51651b320059" data-execution_count="95">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>plt.scatter(p, rmses)</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>plt.axvline(p[np.array(rmses).argmin()], ls <span class="op">=</span> <span class="st">'--'</span>, c <span class="op">=</span> <span class="st">'r'</span>)</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Threshold'</span>)</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Test RMSE'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-139-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="7d937c93-97c2-42b8-c0d4-f190d0518fad" data-execution_count="99">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making new predictions based on the optimal threshold</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>opt_thresh <span class="op">=</span> p[np.array(rmses).argmin()]</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'opt_thresh'</span>, opt_thresh)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>new_pred <span class="op">=</span> base <span class="op">+</span> np.array([<span class="bu">int</span>(x <span class="op">==</span> <span class="va">True</span>) <span class="cf">for</span> x <span class="kw">in</span> (diff <span class="op">&gt;</span> opt_thresh)])</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'rmse for the voting ensemble model:'</span>, np.sqrt(mean_squared_error(y_test, np.around(new_pred))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>opt_thresh 0.686868686868687
rmse for the voting ensemble model: 0.6421119001448987</code></pre>
</div>
</div>
<div class="cell" data-outputid="98828aa1-346a-44e9-da96-640290f8b64d" data-execution_count="100">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>jitter_amount <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>jittered_pred <span class="op">=</span> new_pred <span class="op">+</span> np.random.uniform(low<span class="op">=-</span>jitter_amount, high<span class="op">=</span>jitter_amount, size<span class="op">=</span><span class="bu">len</span>(new_pred))</span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">3</span>,<span class="dv">9</span>,<span class="dv">1000</span>)</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>plt.scatter(jittered_pred, y_test, alpha <span class="op">=</span> <span class="fl">0.4</span>)</span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Predicted Response'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Actual Response'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Actual vs Predicted Response'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>plt.plot(x, x, c <span class="op">=</span> <span class="st">'k'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Project_Code_Saturn_files/figure-html/cell-141-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>